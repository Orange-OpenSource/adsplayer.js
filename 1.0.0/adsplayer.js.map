{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","adsplayer.js","index.js","src/AdsPlayer.js","src/AdsPlayerController.js","src/Debug.js","src/ErrorHandler.js","src/EventBus.js","src/FileLoader.js","src/mast/MastParser.js","src/mast/TriggerManager.js","src/mast/model/Mast.js","src/media/ImagePlayer.js","src/media/VideoPlayer.js","src/utils/xmldom.js","src/vast/CreativePlayer.js","src/vast/TrackingEventsManager.js","src/vast/VastParser.js","src/vast/VastPlayerManager.js","src/vast/model/Vast.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","global","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","AdsPlayer","undefined","_AdsPlayer","_AdsPlayer2","context","window","adsplayer","this","self","./src/AdsPlayer","2","_classCallCheck","instance","Constructor","TypeError","_onError","_error","data","_onWarning","_warning","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","_AdsPlayerController","_AdsPlayerController2","_EventBus","_EventBus2","NAME","VERSION","GIT_TAG","BUILD_DATE","adsPlayerContainer","_adsPlayerContainer","_eventBus","getInstance","_adsPlayerController","onErrorListener","bind","onWarningListener","player","callback","init","addEventListener","stream","adsUrl","load","then","stop","reset","destroy","removeEventListener","indexOf","play","pause","type","listener","useCapture","./AdsPlayerController","./EventBus","3","_Debug","_Debug2","_FileLoader","_FileLoader2","_ErrorHandler","_ErrorHandler2","_MastParser","_MastParser2","_TriggerManager","_TriggerManager2","_VastParser","_VastParser2","_VastPlayerManager","_VastPlayerManager2","AdsPlayerController","_mainPlayer","_mainVideo","_mast","_fileLoaders","_triggerManagers","_vastPlayerManager","_mastParser","_vastParser","_errorHandler","_debug","_onVideoPlayingListener","_onVideoPlaying","_onVideoTimeupdateListener","_onVideoTimeupdate","_onVideoEndedListener","_onVideoEnded","_onTriggerEndListener","_onTriggerEnd","url","_this","fileLoader","vast","Promise","resolve","log","result","parse","response","baseUrl","error","sendWarning","LOAD_VAST_FAILED","push","trigger","uri","loadVastPromises","sources","_loadVast","reject","all","vasts","ad","mastContent","mastBaseUrl","triggerManager","triggers","_checkTriggersStart","_activateTrigger","_checkTriggersEnd","paused","dispatchEvent","ended","_resumeVideo","_pauseVideo","id","start","_this2","activated","_loadTriggerVasts","_playTrigger","checkStartConditions","getTrigger","checkEndConditions","splice","warn","getVideoModel","getElement","setLevel","_this3","_parseMastFile","_start","sendError","name","message","abort","./Debug","./ErrorHandler","./FileLoader","./mast/MastParser","./mast/TriggerManager","./vast/VastParser","./vast/VastPlayerManager","4","Date","HHMMSSmmm","h","getHours","toString","m","getMinutes","getSeconds","ms","getMilliseconds","HH","MM","SS","mmm","MMSSmmm","MemoryLogger","logArray","showLevel","info","debug","getLogs","NONE","ERROR","WARN","INFO","DEBUG","ALL","_instance","Debug","_level","_showTimestamp","_showElapsedTime","_startTime","_logger","console","level","logLevel","args","logTime","showTimestamp","_getStringLevel","showElapsedTime","Array","apply","forEach","item","getLevel","_prepareLog","_log","arguments","5","ErrorHandler","JSON","stringify","DOWNLOAD_ERR_FILES","DOWNLOAD_ERR_NOT_XML","NO_VALID_MEDIA_FOUND","LOAD_MEDIA_FAILED","UNSUPPORTED_MEDIA_FILE","UNAVAILABLE_LINK","6","EventBus","_registrations","captype","listeners","_getListeners","idx","evt","slice","defaultPrevented","7","FileLoader","_request","base","substring","lastIndexOf","DOMParser","parser","xmlDoc","parseFromString","getElementsByTagName","readyState","_parseBaseUrl","needFailureReport","onload","report","onabort","aborted","status","responseXML","_parseXml","responseText","responseURL","XMLHttpRequest","onloadend","onerror","open","timeout","send","_load","8","_Mast","_Mast2","_xmldom","_xmldom2","MastParser","conditionNode","condition","Condition","conditionNodes","getAttribute","operator","conditions","_getCondition","sourceNode","source","Source","sourceNodes","altReference","format","_getSource","triggerNode","Trigger","startConditionNodes","getSubElements","endConditionNodes","description","startConditions","endConditions","mastNode","mast","triggerNodes","_getTrigger","xmlDom","mast_","Mast","_getTriggers","../utils/xmldom","./model/Mast","9","TriggerManager","_trigger","str","timeParts","SECONDS_IN_HOUR","SECONDS_IN_MIN","split","parseInt","parseFloat","value1","value2","res","OPERATOR","EQ","NEQ","GTR","GEQ","LT","LEQ","MOD","video","currentTime","TYPE","EVENT","ON_ITEM_START","PROPERTY","POSITION","_compareValues","_parseTime","DURATION","duration","ON_ITEM_END","_evaluateCondition","_evaluateConditions","10","alreadyProcessed","FORMAT","VAST","UIF","11","ImagePlayer","_uri","_image","_duration","_currentTime","_listeners","_timerInterval","_timerTime","_events","time","getTime","_notifyEvent","_stopTimer","setInterval","_updateCurrentTime","clearInterval","mediaFiles","mediaFile","document","getElementById","createElement","autoplay","src","_addEventListener","_removeEventListener","_startTimer","../Debug","12","VideoPlayer","_video","mimeType","HTMLMediaElement","canPlay","canPlayType","isMediaSupported","sort","b","bitrate","muted","volume","13","xmldom","node","elements","child","firstElementChild","firstChild","namespaceURI","getElementsByTagNameNS","getElements","subName","element","getChildNode","childNodes","nodeName","getNodeTextValue","cdataSection","textSection","nodeValue","getChildNodeTextValue","14","_TrackingEventsManager","_TrackingEventsManager2","_VideoPlayer","_VideoPlayer2","_ImagePlayer","_ImagePlayer2","CreativePlayer","_adPlayerContainer","_mediaPlayer","_trackingEventsManager","_onMediaPlayListener","_onMediaPlay","_onMediaPauseListener","_onMediaPause","_onMediaErrorListener","_onMediaError","_onMediaTimeupdateListener","_onMediaTimeupdate","_onMediaEndedListener","_onMediaEnded","videoClicks","clickThrough","creative","isVideo","isImage","setDuration","trackingEvents","getType","appendChild","style","cursor","_onAdClick","_onMainVideoVolumeChange","_play","removeChild","setVolume","adPlayerContainer","mainVideo","_pause","_stop","../EventBus","../media/ImagePlayer","../media/VideoPlayer","./TrackingEventsManager","15","TrackingEventsManager","_trackingEvents","_adMediaPlayer","_mute","_unmute","_eventListeners","xhr","setRequestHeader","eventType","trackingEvent","_listener","completed","event","_postEvent","oneShot","_eventListener","getCurrentTime","getDuration","getVolume","fullScreen","mozFullScreen","webkitIsFullScreen","adMediaPlayer","_addPlayerEventListeners","_removePlayerEventListeners","16","_Vast","_Vast2","VastParser","trackingNode","TrackingEvent","videoClicksNode","VideoClicks","clickTracking","customClick","mediaFileNode","MediaFile","delivery","width","height","scalable","maintainAspectRatio","apiFramework","linearNode","linear","Linear","trackingNodes","mediaFileNodes","adParameters","_getTrackingEvent","_getVideoClicks","_getMediaFile","creativeNode","Creative","adId","sequence","_getLinear","adNode","inLine","InLine","inLineNode","impressionNodes","creativeNodes","adSystem","adTitle","survey","impression","Impression","impressions","creatives","_getCreative","vastNode","vast_","Ad","_getInLine","Vast","version","_getAd","./model/Vast","17","_CreativePlayer","_CreativePlayer2","VastPlayerManager","_vasts","_vastIndex","_creativeIndex","_creativePlayer","_onCreativeEndListener","_onCreativeEnd","http","_stopCreative","_playNextCreative","index","_sendImpressions","_playCreative","_playVast","_playNextVast","_resumeCreative","_pauseCreative","../ErrorHandler","./CreativePlayer","18","wrapper","extensions","Extensions","other","CompanionAds","nonLinearAds","LINEAR","NON_LINEAR_ADS","COMPANION_ADS","Companion","staticResource","iFrameResource","hTMLResource","altText","NonLinear","expandedWidth","expandedHeight","CREATIVEVIEW","START","MIDPOINT","FIRSTQUARTILE","THIRDQUARTILE","COMPLETE","MUTE","UNMUTE","PAUSE","REWIND","RESUME","FULLSCREEN","EXPAND","COLLAPSE","ACCEPTINVITATION","CLOSE","DELIVERY","STREAMING","PROGRESSIVE","StaticResource","uRI","creativeType"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA,QAAAA,GAAAC,EAAAC,EAAAC,GAAA,QAAAC,GAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,GAAAE,GAAA,kBAAAC,UAAAA,OAAA,KAAAF,GAAAC,EAAA,MAAAA,GAAAF,GAAA,EAAA,IAAAI,EAAA,MAAAA,GAAAJ,GAAA,EAAA,IAAAK,GAAA,GAAAC,OAAA,uBAAAN,EAAA,IAAA,MAAAK,GAAAE,KAAA,mBAAAF,EAAA,GAAAG,GAAAX,EAAAG,IAAAS,WAAAb,GAAAI,GAAA,GAAAU,KAAAF,EAAAC,QAAA,SAAAd,GAAA,GAAAE,GAAAD,EAAAI,GAAA,GAAAL,EAAA,OAAAI,GAAAF,EAAAA,EAAAF,IAAAa,EAAAA,EAAAC,QAAAd,EAAAC,EAAAC,EAAAC,GAAA,MAAAD,GAAAG,GAAAS,QAAA,IAAA,GAAAL,GAAA,kBAAAD,UAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,GAAA,OAAAD,KAAAa,GAAA,SAAAT,EAAAU,EAAAJ,ICCA,SAAWK,GACX,YAWA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GATvFG,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,IAEXZ,EAAQa,UAAYC,MCNpB,IAAAC,GAAArB,EAAA,mBDUIsB,EAAcV,EAAuBS,GCPrCE,EAA6B,mBAAXC,SAA0BA,QAAWb,EAEvDc,EAAYF,EAAQE,SACnBA,KACDA,EAAYF,EAAQE,cAGxBA,EAAUN,UAAVG,EAAAA,WDcAhB,EAAAA,WCZemB,EDafnB,ECZSa,UDYWG,EAAAA,aAEjBf,KAAKmB,KAAuB,mBAAXf,QAAyBA,OAAyB,mBAATgB,MAAuBA,KAAyB,mBAAXH,QAAyBA,aAExHI,kBAAkB,IAAIC,GAAG,SAAS7B,EAAQU,EAAOJ,GACpD,YAiDA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCEpChH,QAASC,GAAU1C,GACfkC,KAAKS,OAAS3C,EAAE4C,KAGpB,QAASC,GAAY7C,GACjBkC,KAAKY,SAAW9C,EAAE4C,KFlBtBpB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MEFhiBmB,EAAAnD,EAAA,yBFuCIoD,EAAwBxC,EAAuBuC,GEtCnDE,EAAArD,EAAA,cF0CIsD,EAAa1C,EAAuByC,GExClCE,EAAO,YACPC,EAAU,QACVC,EAAU,UACVC,EAAa,qBAabvC,EF8CU,WEzCZ,QAAAA,GAAawC,GAAoB7B,EAAAJ,KAAAP,GAE7BO,KAAKkC,oBAAsBD,EAC3BjC,KAAKS,OAAS,KACdT,KAAKY,SAAW,KAChBZ,KAAKmC,UAAYP,EAAAA,WAASQ,cAC1BpC,KAAKqC,qBAAuB,KAE5BrC,KAAKsC,gBAAkB9B,EAAS+B,KAAKvC,MACrCA,KAAKwC,kBAAoB7B,EAAW4B,KAAKvC,MF0S7C,MA5OAa,GAAapB,IACT4B,IAAK,UACL7B,MAAO,WElDP,MAAOqC,MFiEPR,IAAK,OACL7B,MAAO,SEtDLiD,EAAQC,GACV1C,KAAKqC,qBAAuB,GAAAX,GAAAA,WAC5B1B,KAAKqC,qBAAqBM,KAAKF,EAAQzC,KAAKkC,qBAC5ClC,KAAKmC,UAAUS,iBAAiB,QAAS5C,KAAKsC,iBAC9CtC,KAAKmC,UAAUS,iBAAiB,UAAW5C,KAAKwC,mBAEhDE,OFmEArB,IAAK,OACL7B,MAAO,SEzDLqD,EAAQH,GACNG,EAAOC,OACP9C,KAAKqC,qBAAqBU,KAAKF,EAAOC,QAAQE,KAAK,WAC/CN,MADJ1C,SAES,WACL0C,MAGJA,OFsEJrB,IAAK,OACL7B,MAAO,WE3DPQ,KAAKqC,qBAAqBY,UFwE1B5B,IAAK,QACL7B,MAAO,WE9DPQ,KAAKqC,qBAAqBa,WF2E1B7B,IAAK,UACL7B,MAAO,WEjEPQ,KAAKqC,qBAAqBc,UAC1BnD,KAAKmC,UAAUiB,oBAAoB,QAASpD,KAAKsC,iBACjDtC,KAAKmC,UAAUiB,oBAAoB,UAAWpD,KAAKwC,sBFgFnDnB,IAAK,aACL7B,MAAO,WEpEP,MAAOsC,MFgFPT,IAAK,iBACL7B,MAAO,WEvEP,MAAIuC,GAAQsB,QAAQ,WACTvB,EAAU,IAAMC,EAEhBD,KFqFXT,IAAK,eACL7B,MAAO,WE1EP,MAAIwC,GAAWqB,QAAQ,WACZrB,EAEA,2BFuFXX,IAAK,OACL7B,MAAO,WE7EPQ,KAAKqC,qBAAqBiB,UFyF1BjC,IAAK,QACL7B,MAAO,WEhFPQ,KAAKqC,qBAAqBkB,WFqG1BlC,IAAK,mBACL7B,MAAO,SEpFOgE,EAAMC,EAAUC,GAC9B1D,KAAKmC,UAAUS,iBAAiBY,EAAMC,EAAUC,MFkGhDrC,IAAK,sBACL7B,MAAO,SEvFUgE,EAAMC,GACvBzD,KAAKmC,UAAUiB,oBAAoBI,EAAMC,MFkGzCpC,IAAK,WACL7B,MAAO,WEzFP,MAAOQ,MAAKS,UFqGZY,IAAK,aACL7B,MAAO,WE5FP,MAAOQ,MAAKY,aFiGTnB,IA0HXb,GAAAA,WE/Fea,IFiGZkE,wBAAwB,EAAEC,aAAa,IAAIC,GAAG,SAASvF,EAAQU,EAAOJ,GACzE,YAyEA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAzEhHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MG9chiBwD,EAAAxF,EAAA,WHmfIyF,EAAU7E,EAAuB4E,GGlfrCE,EAAA1F,EAAA,gBHsfI2F,EAAe/E,EAAuB8E,GGrf1CE,EAAA5F,EAAA,kBHyfI6F,EAAiBjF,EAAuBgF,GGxf5CvC,EAAArD,EAAA,cH4fIsD,EAAa1C,EAAuByC,GG3fxCyC,EAAA9F,EAAA,qBH+fI+F,EAAenF,EAAuBkF,GG9f1CE,EAAAhG,EAAA,yBHkgBIiG,EAAmBrF,EAAuBoF,GGjgB9CE,EAAAlG,EAAA,qBHqgBImG,EAAevF,EAAuBsF,GGpgB1CE,EAAApG,EAAA,4BHwgBIqG,EAAsBzF,EAAuBwF,GGrgB3CE,EH2gBoB,WGhTtB,QAAAA,KAAexE,EAAAJ,KAAA4E,GAEX5E,KAAK6E,YAAc,KACnB7E,KAAK8E,WAAa,KAClB9E,KAAKkC,oBAAsB,KAC3BlC,KAAK+E,MAAQ,KACb/E,KAAKgF,gBACLhF,KAAKiF,oBACLjF,KAAKkF,mBAAqB,KAC1BlF,KAAKmF,YAAc,GAAAd,GAAAA,WACnBrE,KAAKoF,YAAc,GAAAX,GAAAA,WACnBzE,KAAKqF,cAAgBlB,EAAAA,WAAa/B,cAClCpC,KAAKsF,OAASvB,EAAAA,WAAM3B,cACpBpC,KAAKmC,UAAYP,EAAAA,WAASQ,cAE1BpC,KAAKuF,wBAA0BvF,KAAKwF,gBAAgBjD,KAAKvC,MACzDA,KAAKyF,2BAA6BzF,KAAK0F,mBAAmBnD,KAAKvC,MAC/DA,KAAK2F,sBAAwB3F,KAAK4F,cAAcrD,KAAKvC,MACrDA,KAAK6F,sBAAwB7F,KAAK8F,cAAcvD,KAAKvC,MH0sBzD,MA3aAa,GAAa+D,IACTvD,IAAK,YAML7B,MAAO,SG7gBAuG,GAAK,GAAAC,GAAAhG,KACRiG,EAAa,GAAAhC,GAAAA,WACbiC,EAAO,IAEX,OAAO,IAAIC,SAAQ,SAACC,GAChBJ,EAAKV,OAAOe,IAAI,uBAAyBN,GACzCE,EAAWlD,KAAKgD,GAAK/C,KAAK,SAAAsD,GAClBN,EAAKV,OAAOe,IAAI,mBAChBH,EAAOF,EAAKZ,YAAYmB,MAAMD,EAAOE,UACrCN,EAAKO,QAAUH,EAAOG,QACtBL,EAAQF,KAJhBD,SAKa,SAAAS,GACDA,GACAV,EAAKX,cAAcsB,YAAYxC,EAAAA,WAAayC,iBAAkB,2BAA4BF,GAE9FN,EAAQ,QAGhBJ,EAAKhB,aAAa6B,KAAKZ,QHkhB3B5E,IAAK,oBACL7B,MAAO,SG/gBQsH,GACf,GACIvI,GACAwI,EAFAC,IAIJ,KAAKzI,EAAI,EAAGA,EAAIuI,EAAQG,QAAQnI,OAAQP,IACpCwI,EAAMD,EAAQG,QAAQ1I,GAAGwI,IAErBA,EAAI1D,QAAQ,kBACZ0D,EAAM/G,KAAK+E,MAAM0B,QAAUM,GAE/BC,EAAiBH,KAAK7G,KAAKkH,UAAUH,GAGzC,OAAO,IAAIZ,SAAQ,SAACC,EAASe,GACzBhB,QAAQiB,IAAIJ,GAAkBhE,KAAK,SAAAqE,GAG/B,IAAK,GAAI9I,GAAI,EAAGA,EAAI8I,EAAMvI,OAAQP,IAC1B8I,EAAM9I,IAAM8I,EAAM9I,GAAG+I,IACrBR,EAAQO,MAAMR,KAAKQ,EAAM9I,GAGjC6H,OARJD,SASS,WACLgB,WHohBR9F,IAAK,iBACL7B,MAAO,SGhhBK+H,EAAaC,GACzB,GAAIC,GACAlJ,CAKJ,IAFAyB,KAAK+E,MAAQ/E,KAAKmF,YAAYoB,MAAMgB,GAE/BvH,KAAK+E,MAQV,IAHA/E,KAAK+E,MAAM0B,QAAUe,EAGhBjJ,EAAI,EAAGA,EAAIyB,KAAK+E,MAAM2C,SAAS5I,OAAQP,IACxCkJ,EAAiB,GAAAlD,GAAAA,WACjBkD,EAAe9E,KAAK3C,KAAK+E,MAAM2C,SAASnJ,IACxCyB,KAAKiF,iBAAiB4B,KAAKY,MHmhB/BpG,IAAK,kBACL7B,MAAO,WG/gBHQ,KAAKkF,qBACLlF,KAAKsF,OAAOe,IAAI,oBAChBrG,KAAK8E,WAAWvB,YHohBpBlC,IAAK,qBACL7B,MAAO,WGhhBP,GAAIsH,GAAU9G,KAAK2H,qBACH,QAAZb,GACA9G,KAAK4H,iBAAiBd,MHqhB1BzF,IAAK,gBACL7B,MAAO,WGhhBP,GAAIsH,GAAU9G,KAAK2H,qBACH,QAAZb,GACA9G,KAAK4H,iBAAiBd,GAG1B9G,KAAK6H,uBHqhBLxG,IAAK,cACL7B,MAAO,WGlhBFQ,KAAK8E,WAAWgD,SACjB9H,KAAKsF,OAAOe,IAAI,oBAChBrG,KAAK8E,WAAWvB,YHuhBpBlC,IAAK,eACL7B,MAAO,WGnhBHQ,KAAK8E,WAAWgD,SAChB9H,KAAKsF,OAAOe,IAAI,qBAChBrG,KAAK8E,WAAWxB,WHwhBpBjC,IAAK,gBACL7B,MAAO,WGphBPQ,KAAKsF,OAAOe,IAAI,uBAGZrG,KAAKkF,qBACLlF,KAAKkF,mBAAmBhC,QACxBlD,KAAKkF,mBAAqB,KAI9B,IAAI4B,GAAU9G,KAAK2H,qBACH,QAAZb,EACA9G,KAAK4H,iBAAiBd,IAGtB9G,KAAKmC,UAAU4F,eAAevE,KAAM,MAAO9C,KAAM,OAE5CV,KAAK8E,WAAWkD,OAEjBhI,KAAKiI,mBH0hBb5G,IAAK,eACL7B,MAAO,SGthBIsH,GACkB,IAAzBA,EAAQO,MAAMvI,SAKlBkB,KAAKkI,cAGLlI,KAAKmC,UAAU4F,eAAevE,KAAM,QAAS9C,KAAM,OAGnDV,KAAKsF,OAAOe,IAAI,yBAA2BS,EAAQqB,IACnDnI,KAAKkF,mBAAqB,GAAAP,GAAAA,WAC1B3E,KAAKkF,mBAAmBvC,KAAKmE,EAAQO,MAAOrH,KAAKkC,oBAAqBlC,KAAK8E,YAC3E9E,KAAKkF,mBAAmBkD,YHyhBxB/G,IAAK,mBACL7B,MAAO,SGvhBQsH,GAAS,GAAAuB,GAAArI,IAGpBA,MAAKkF,qBAITlF,KAAKsF,OAAOe,IAAI,oBAAsBS,EAAQqB,IAE9CrB,EAAQwB,WAAY,EAES,IAAzBxB,EAAQO,MAAMvI,OAEdkB,KAAKuI,kBAAkBzB,GAAS9D,KAAK,WACjCqF,EAAKG,aAAa1B,KAGtB9G,KAAKwI,aAAa1B,OH4hBtBzF,IAAK,sBACL7B,MAAO,WGxhBP,IAAK,GAAIjB,GAAI,EAAGA,EAAIyB,KAAKiF,iBAAiBnG,OAAQP,IAC9C,GAAIyB,KAAKiF,iBAAiB1G,GAAGkK,qBAAqBzI,KAAK8E,YACnD,MAAO9E,MAAKiF,iBAAiB1G,GAAGmK,YAGxC,OAAO,SH4hBPrH,IAAK,oBACL7B,MAAO,WGzhBP,IAAK,GAAIjB,GAAI,EAAGA,EAAIyB,KAAKiF,iBAAiBnG,OAAQP,IAC1CyB,KAAKiF,iBAAiB1G,GAAGoK,mBAAmB3I,KAAK8E,cAEjD9E,KAAKiF,iBAAiB2D,OAAO,EAAG,GAChCrK,QH+hBR8C,IAAK,SACL7B,MAAO,WG1hBP,GAAKQ,KAAK+E,MAAV,CAImC,IAA/B/E,KAAK+E,MAAM2C,SAAS5I,QACpBkB,KAAKsF,OAAOuD,KAAK,qBAIrB,IAAI/B,GAAU9G,KAAK2H,qBACH,QAAZb,GACA9G,KAAK4H,iBAAiBd,QHokB9BjG,EAAa+D,IACTvD,IAAK,OACL7B,MAAO,SGliBLiD,EAAQR,GACVjC,KAAK6E,YAAcpC,EACnBzC,KAAK8E,WAAarC,EAAOqG,gBAAgBC,aACzC/I,KAAKkC,oBAAsBD,EAG3BjC,KAAK8E,WAAWlC,iBAAiB,UAAW5C,KAAKuF,yBACjDvF,KAAK8E,WAAWlC,iBAAiB,aAAc5C,KAAKyF,4BACpDzF,KAAK8E,WAAWlC,iBAAiB,UAAW5C,KAAKyF,4BACjDzF,KAAK8E,WAAWlC,iBAAiB,QAAS5C,KAAK2F,uBAG/C3F,KAAKmC,UAAUS,iBAAiB,aAAc5C,KAAK6F,uBAEnD7F,KAAKsF,OAAO0D,SAAS,MH8iBrB3H,IAAK,OACL7B,MAAO,SGpiBLuG,GAAK,GAAAkD,GAAAjJ,KACHiG,EAAa,GAAAhC,GAAAA,UASjB,OANAjE,MAAK+E,MAAQ,KACb/E,KAAKiF,oBAGLjF,KAAKsF,OAAOe,IAAI,uBAAyBN,GAElC,GAAII,SAAQ,SAACC,EAASe,GACzBlB,EAAWlD,KAAKgD,GAAK/C,KAAK,SAAAsD,GACtB2C,EAAK3D,OAAOe,IAAI,mBAChB4C,EAAKC,eAAe5C,EAAOE,SAAUF,EAAOG,SAE5CwC,EAAK3D,OAAOe,IAAI,SAChB4C,EAAKE,SACL/C,MANJH,SAOS,SAAAS,GACDA,GACAuC,EAAK5D,cAAc+D,UAAU1C,EAAM2C,KAAM3C,EAAM4C,QAAS5C,EAAMhG,MAC9DyG,EAAOT,IAEPN,MAGR6C,EAAKjE,aAAa6B,KAAKZ,QHkjB3B5E,IAAK,OACL7B,MAAO,WGviBPQ,KAAKsF,OAAOe,IAAI,OAGhB,KAAK,GAAI9H,GAAI,EAAGA,EAAIyB,KAAKgF,aAAalG,OAAQP,IAC1CyB,KAAKgF,aAAazG,GAAGgL,OAEzBvJ,MAAKgF,gBAGDhF,KAAKkF,qBACLlF,KAAKkF,mBAAmBjC,OACxBjD,KAAKkF,mBAAmBhC,QACxBlD,KAAKkF,mBAAqB,KAG1BlF,KAAKmC,UAAU4F,eAAevE,KAAM,MAAO9C,KAAM,WH6iBrDW,IAAK,QACL7B,MAAO,WGxiBPQ,KAAKsF,OAAOe,IAAI,SAEhBrG,KAAKiD,OAGLjD,KAAKiF,oBAGLjF,KAAK+E,MAAQ,QH6iBb1D,IAAK,UACL7B,MAAO,WGziBPQ,KAAKsF,OAAOe,IAAI,WAEhBrG,KAAKkD,QAGLlD,KAAK8E,WAAW1B,oBAAoB,UAAWpD,KAAKuF,yBACpDvF,KAAK8E,WAAW1B,oBAAoB,aAAcpD,KAAKyF,4BACvDzF,KAAK8E,WAAW1B,oBAAoB,UAAWpD,KAAKyF,4BACpDzF,KAAK8E,WAAW1B,oBAAoB,QAASpD,KAAK2F,uBAGlD3F,KAAKmC,UAAUiB,oBAAoB,aAAcpD,KAAK6F,0BHsjBtDxE,IAAK,OACL7B,MAAO,WG5iBPQ,KAAKsF,OAAOe,IAAI,QAEZrG,KAAKkF,oBACLlF,KAAKkF,mBAAmB5B,UH0jB5BjC,IAAK,QACL7B,MAAO,WG/iBPQ,KAAKsF,OAAOe,IAAI,SAEZrG,KAAKkF,oBACLlF,KAAKkF,mBAAmB3B,YHsjBzBqB,IAGXhG,GAAAA,WGpjBegG,IHsjBZ4E,UAAU,EAAEC,iBAAiB,EAAE7F,aAAa,EAAE8F,eAAe,EAAEC,oBAAoB,EAAEC,wBAAwB,EAAEC,oBAAoB,GAAGC,2BAA2B,KAAKC,GAAG,SAASzL,EAAQU,EAAOJ,GACpM,YAQA,SAASwB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCANhHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,KIh9BhiB0J,MAAKxI,UAAUyI,UAAY,WAEvB,GAAIC,GAAIlK,KAAKmK,WAAWC,WACpBC,EAAIrK,KAAKsK,aAAaF,WACtBlM,EAAI8B,KAAKuK,aAAaH,WACtBI,EAAKxK,KAAKyK,kBAAkBL,WAC5BM,EAAKR,EAAE,GAAKA,EAAI,IAAMA,EAAE,GACxBS,EAAKN,EAAE,GAAKA,EAAI,IAAMA,EAAE,GACxBO,EAAK1M,EAAE,GAAKA,EAAI,IAAMA,EAAE,GACxB2M,EAAML,EAAG,GAAKA,EAAK,KAAOA,EAAG,GAAKA,EAAK,IAAMA,EAAG,GAEpD,OAAOE,GAAK,IAAMC,EAAK,IAAMC,EAAK,IAAMC,GAG5Cb,KAAKxI,UAAUsJ,QAAU,WAErB,GAAIT,GAAIrK,KAAKsK,aAAaF,WACtBlM,EAAI8B,KAAKuK,aAAaH,WACtBI,EAAKxK,KAAKyK,kBAAkBL,WAC5BO,EAAKN,EAAE,GAAKA,EAAI,IAAMA,EAAE,GACxBO,EAAK1M,EAAE,GAAKA,EAAI,IAAMA,EAAE,GACxB2M,EAAML,EAAG,GAAKA,EAAK,KAAOA,EAAG,GAAKA,EAAK,IAAMA,EAAG,GAEpD,OAAOG,GAAK,IAAMC,EAAK,IAAMC,EAKjC,IAAIE,GAAe,WAEf/K,KAAKgL,YAELhL,KAAKiL,WAAY,EAGrBF,GAAavJ,UAAUkF,MACnBqE,EAAavJ,UAAUqH,KACvBkC,EAAavJ,UAAU0J,KACvBH,EAAavJ,UAAU2J,MAAQ,SAAS7B,GACpCtJ,KAAKgL,SAASnE,KAAKyC,IAG3ByB,EAAavJ,UAAU4J,QAAU,WAC7B,MAAOpL,MAAKgL,SAIhB,IAAMK,GAAO,EACPC,EAAQ,EACRC,EAAO,EACPC,EAAO,EACPC,EAAQ,EACRC,EAAM,EAGRC,EAAY,KAEVC,EJ++BM,WI75BR,QAAAA,KAEI,MAFUxL,GAAAJ,KAAA4L,GAEQ,OAAdD,EACOA,GAGX3L,KAAK6L,OAAS,EACd7L,KAAK8L,gBAAiB,EACtB9L,KAAK+L,kBAAmB,EACxB/L,KAAKgM,WAAa,GAAIhC,MACtBhK,KAAKiM,QAAUC,QAEfP,EAAY3L,MJojChB,MAlKAa,GAAa+K,IACTvK,IAAK,kBAML7B,MAAO,SIl/BK2M,GACZ,OAAQA,GACJ,IAAKd,GACD,MAAO,EACX,KAAKC,GACD,MAAO,OACX,KAAKC,GACD,MAAO,MACX,KAAKC,GACD,MAAO,MACX,KAAKC,GACL,IAAKC,GACD,MAAO,OACX,SACI,MAAO,OJs/BfrK,IAAK,cACL7B,MAAO,SIn/BC4M,EAAUC,GAClB,GAAI/C,GAAU,GACVgD,EAAU,IAqBd,OAnBItM,MAAKuM,gBACLD,EAAU,GAAItC,MACdV,GAAW,IAAMgD,EAAQrC,YAAc,KAGvCjK,KAAKiM,SAAWjM,KAAKiM,QAAQhB,YAC7B3B,GAAW,IAAMtJ,KAAKwM,gBAAgBJ,GAAY,KAGlDpM,KAAKyM,kBACLnD,GAAW,IAAM,GAAIU,MAAKsC,EAAUtM,KAAKgM,YAAYlB,UAAY,KAGrExB,GAAW,eAEXoD,MAAMC,MAAM,KAAMN,GAAMO,QAAQ,SAASC,GACrCvD,GAAWuD,EAAO,MAGfvD,KJs/BPjI,IAAK,OACL7B,MAAO,SIp/BL4M,EAAUC,GACZ,GAAID,GAAYpM,KAAK8M,WAAY,CAE7B,GAAIxD,GAAUtJ,KAAK+M,YAAYX,EAAUC,EAEzC,QAAQD,GACJ,IAAKd,GACDtL,KAAKiM,QAAQvF,MAAM4C,EACnB,MACJ,KAAKiC,GACDvL,KAAKiM,QAAQpD,KAAKS,EAClB,MACJ,KAAKkC,GACDxL,KAAKiM,QAAQf,KAAK5B,EAClB,MACJ,KAAKmC,GACDzL,KAAKiM,QAAQd,MAAM7B,UJ8/B/BjI,IAAK,cACL7B,MAAO,WIj/BP,MAJkB,QAAdmM,IACAA,EAAY,GAAIC,IAGbD,MJ2gCX9K,EAAa+K,IACTvK,IAAK,WACL7B,MAAO,WIz/BP,MAAOQ,MAAK6L,UJ6/BZxK,IAAK,WACL7B,MAAO,SI3/BDA,GACNQ,KAAK6L,OAASrM,KJ8/Bd6B,IAAK,YACL7B,MAAO,WI3/BP,MAAOQ,MAAKiM,WJ+/BZ5K,IAAK,YACL7B,MAAO,SI7/BAgE,GACP,OAAQA,GACJ,IAAK,SACDxD,KAAKiM,QAAU,GAAIlB,EACnB,MAEJ,KAAK,UACD/K,KAAKiM,QAAUC,OACf,MAEJ,SACIlM,KAAKiM,QAAU,SJigCvB5K,IAAK,QACL7B,MAAO,WI7/BPQ,KAAKgN,KAAK1B,EAAO2B,cJigCjB5L,IAAK,OACL7B,MAAO,WI9/BPQ,KAAKgN,KAAKzB,EAAM0B,cJkgChB5L,IAAK,OACL7B,MAAO,WI//BPQ,KAAKgN,KAAKxB,EAAMyB,cJsgChB5L,IAAK,MACL7B,MAAO,WIlgCPQ,KAAKgN,KAAKvB,EAAOwB,eJugCdrB,IAGXhN,GAAAA,WItgCegN,OJwgCTsB,GAAG,SAAS5O,EAAQU,EAAOJ,GACjC,YA+CA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCA/ChHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MKttChiBwD,EAAAxF,EAAA,WLyvCIyF,EAAU7E,EAAuB4E,GKxvCrCnC,EAAArD,EAAA,cL4vCIsD,EAAa1C,EAAuByC,GK1vCpCgK,EAAY,KAGVwB,EL+vCa,WKlvCf,QAAAA,KAEI,MAFU/M,GAAAJ,KAAAmN,GAEQ,OAAdxB,EACOA,GAGX3L,KAAKmC,UAAYP,EAAAA,WAASQ,cAC1BpC,KAAKsF,OAASvB,EAAAA,WAAM3B,cAEpBuJ,EAAY3L,MLszChB,MA5EAa,GAAasM,EAAc,OACvB9L,IAAK,cAML7B,MAAO,WK7vCP,MAJkB,QAAdmM,IACAA,EAAY,GAAIwB,IAGbxB,ML6xCX9K,EAAasM,IACT9L,IAAK,cACL7B,MAAO,SKxwCEd,EAAM4K,EAAS5I,GACxBV,KAAKmC,UAAU4F,eACXvE,KAAM,UACN9C,MACIhC,KAAMA,EACN4K,QAASA,EACT5I,KAAMA,KAGdV,KAAKsF,OAAOuD,KAAK,gBAAkBnK,EAAO,cAAgB4K,EAAU,WAAa8D,KAAKC,UAAU3M,EAAM,KAAM,ULoxC5GW,IAAK,YACL7B,MAAO,SK3wCAd,EAAM4K,EAAS5I,GACtBV,KAAKmC,UAAU4F,eACXvE,KAAM,QACN9C,MACIhC,KAAMA,EACN4K,QAASA,EACT5I,KAAMA,KAGdV,KAAKsF,OAAOoB,MAAM,iBAAmBhI,EAAO,cAAgB4K,EAAU,WAAa8D,KAAKC,UAAU3M,EAAM,KAAM,WL+wC3GyM,IK1wCXA,GAAaG,mBAAqB,qBAClCH,EAAaI,qBAAuB,uBAEpCJ,EAAavG,iBAAmB,mBAGhCuG,EAAaK,qBAAuB,uBACpCL,EAAaM,kBAAoB,oBACjCN,EAAaO,uBAAyB,yBACtCP,EAAaQ,iBAAmB,mBLkxChC/O,EAAAA,WKhxCeuO,ILkxCZ3D,UAAU,EAAE5F,aAAa,IAAIgK,GAAG,SAAStP,EAAQU,EAAOJ,GAC3D,YA2CA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCA3ChHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MM52ChiBwD,EAAAxF,EAAA,WN+4CIyF,EAAU7E,EAAuB4E,GM74CjC6H,EAAY,KAEVkC,ENm5CS,WMr3CX,QAAAA,KAEI,MAFUzN,GAAAJ,KAAA6N,GAEQ,OAAdlC,EACOA,GAGX3L,KAAK8N,kBACL9N,KAAKsF,OAASvB,EAAAA,WAAM3B,cAEpBuJ,EAAY3L,MNw9ChB,MA3GAa,GAAagN,IACTxM,IAAK,gBAOL7B,MAAO,SMt5CIgE,EAAME,GACEhE,SAAfgE,IACAA,GAAa,EAEjB,IAAIqK,IAAWrK,EAAa,IAAM,KAAOF,CAMzC,OAJMuK,KAAW/N,MAAK8N,iBAClB9N,KAAK8N,eAAeC,OAGjB/N,KAAK8N,eAAeC,QN85C3B1M,IAAK,cACL7B,MAAO,WMp5CP,MAJkB,QAAdmM,IACAA,EAAY,GAAIkC,IAGblC,MNm7CX9K,EAAagN,IACTxM,IAAK,mBACL7B,MAAO,SM/5COgE,EAAMC,EAAUC,GAC9B,GAAIsK,GAAYhO,KAAKiO,cAAczK,EAAME,GACrCwK,EAAMF,EAAU3K,QAAQI,EAExByK,SACAF,EAAUnH,KAAKpD,MN46CnBpC,IAAK,sBACL7B,MAAO,SMl6CUgE,EAAMC,EAAUC,GACjC,GAAIsK,GAAYhO,KAAKiO,cAAczK,EAAME,GACrCwK,EAAMF,EAAU3K,QAAQI,EAExByK,SACAF,EAAUpF,OAAOsF,EAAK,MN66C1B7M,IAAK,gBACL7B,MAAO,SMr6CI2O,GACX,GAAIH,GAAYhO,KAAKiO,cAAcE,EAAI3K,MAAM,GAAO4K,QAChD7P,EAAI,CAER,KAAKA,EAAI,EAAGA,EAAIyP,EAAUlP,OAAQP,GAAK,EACnCyP,EAAUzP,GAAGM,KAAKmB,KAAMmO,EAE5B,QAAQA,EAAIE,qBNy6CTR,IAGXjP,GAAAA,WMx6CeiP,IN06CZrE,UAAU,IAAI8E,GAAG,SAAShQ,EAAQU,EAAOJ,GAC5C,YA2CA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCA3ChHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MO/gDhiB4D,EAAA5F,EAAA,kBPkjDI6F,EAAiBjF,EAAuBgF,GOhjDtCqK,EPsjDW,WO/6Cb,QAAAA,KAAcnO,EAAAJ,KAAAuO,GACVvO,KAAKwO,SAAW,KPolDpB,MArKA3N,GAAa0N,IACTlN,IAAK,gBAML7B,MAAO,SOzjDIuG,GACX,GAAI0I,GAAO,IASX,OAPI1I,GAAI1C,QAAQ,YACR0C,EAAI1C,QAAQ,YACZ0C,EAAMA,EAAI2I,UAAU,EAAG3I,EAAI1C,QAAQ,OAEvCoL,EAAO1I,EAAI2I,UAAU,EAAG3I,EAAI4I,YAAY,KAAO,IAG5CF,KP4jDPpN,IAAK,YACL7B,MAAO,SO1jDAkB,GAEP,IAAKZ,OAAO8O,UACR,MAAO,KAGX,KACI,GAAIC,GAAS,GAAI/O,QAAO8O,UAEpBE,EAASD,EAAOE,gBAAgBrO,EAAM,WAC1C,IAAIoO,EAAOE,qBAAqB,eAAelQ,OAAS,EACpD,KAAM,IAAIL,OAAM,oBAEpB,OAAOqQ,GACT,MAAOhR,GACL,MAAO,UP8jDXuD,IAAK,SACL7B,MAAO,WO1jDe,OAAlBQ,KAAKwO,UAAqBxO,KAAKwO,SAASS,WAAa,GAAKjP,KAAKwO,SAASS,WAAa,GACrFjP,KAAKwO,SAASjF,WP+jDlBlI,IAAK,QACL7B,MAAO,SO5jDJuG,EAAKK,EAASe,GACjB,GAAIV,GAAUzG,KAAKkP,cAAcnJ,GAC7BoJ,GAAoB,EACpBC,EAAS,KACTC,EAAS,KACTC,EAAU,KACVrP,EAAOD,IAEXsP,GAAU,WACNtP,KAAKuP,SAAU,GAGnBH,EAAS,WACL,KAAIpP,KAAKwP,OAAS,KAAOxP,KAAKwP,OAAS,MAInB,MAAhBxP,KAAKwP,QAAsC,IAApBxP,KAAKiP,WAAkB,CAG9C,GAAIH,GAAS9O,KAAKyP,aAAexP,EAAKyP,UAAU1P,KAAK2P,aAGrD,IAAe,OAAXb,EAEA,YADAK,GAAoB,EAKpBnP,MAAK4P,cACLnJ,EAAUxG,EAAKiP,cAAclP,KAAK4P,cAGtCT,GAAoB,EAGpB/I,GACII,SAAUsI,EACVrI,QAASA,MAMrB4I,EAAS,WACAF,IAGLA,GAAoB,EAEhBnP,KAAKuP,QAELpI,IACOnH,KAAKwP,OAAS,KAAOxP,KAAKwP,OAAS,IAE1CrI,GACIkC,KAAMlF,EAAAA,WAAamJ,mBACnBhE,QAAS,0BACT5I,MACIqF,IAAKA,EACLyJ,OAAQxP,KAAKwP,UAGO,OAArBxP,KAAKyP,aAEZtI,GACIkC,KAAMlF,EAAAA,WAAaoJ,qBACnBjE,QAAS,kDACT5I,MACIqF,IAAKA,MAMrB,KACI/F,KAAKwO,SAAW,GAAIqB,gBACpB7P,KAAKwO,SAASY,OAASA,EACvBpP,KAAKwO,SAASsB,UAAYT,EAC1BrP,KAAKwO,SAASuB,QAAUV,EACxBrP,KAAKwO,SAASc,QAAUA,EACxBtP,KAAKwO,SAASwB,KAAK,MAAOjK,GAAK,GAC/B/F,KAAKwO,SAASyB,QAAU,IACxBjQ,KAAKwO,SAAS0B,OAChB,MAAOpS,GACLkC,KAAKwO,SAASuB,eP0kDtBlP,EAAa0N,IACTlN,IAAK,OACL7B,MAAO,SOjkDLuG,GAAK,GAAAC,GAAAhG,IACP,OAAO,IAAImG,SAAQ,SAACC,EAASe,GACzBnB,EAAKmK,MAAMpK,EAAKK,EAASe,QPukD7B9F,IAAK,QACL7B,MAAO,WOnkDe,OAAlBQ,KAAKwO,UACLxO,KAAKwO,SAASS,WAAa,GAC3BjP,KAAKwO,SAASS,WAAa,GAC3BjP,KAAKwO,SAASjF,YPukDfgF,IAGX3P,GAAAA,WOrkDe2P,IPukDZ9E,iBAAiB,IAAI2G,GAAG,SAAS9R,EAAQU,EAAOJ,GACnD,YAgDA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAhDhHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MQzuDhiB+P,EAAA/R,EAAA,gBR6wDIgS,EAASpR,EAAuBmR,GQ5wDpCE,EAAAjS,EAAA,mBRgxDIkS,EAAWtR,EAAuBqR,GQ9wDhCE,ERoxDW,WQ5sDb,QAAAA,KAAcrQ,EAAAJ,KAAAyQ,GRszDd,MAzGA5P,GAAa4P,IACTpP,IAAK,gBAML7B,MAAO,SQvxDIkR,GACX,GAAIC,GAAY,GAAIL,GAAAA,WAAKM,UACrBC,EAAA,MAEJF,GAAUnN,KAAOkN,EAAcI,aAAa,QAC5CH,EAAUtH,KAAOqH,EAAcI,aAAa,QAC5CH,EAAUnR,MAAQkR,EAAcI,aAAa,SAC7CH,EAAUI,SAAWL,EAAcI,aAAa,YAChDD,EAAiBH,EAAc1B,qBAAqB,YACpD,KAAK,GAAIzQ,GAAI,EAAGA,EAAIsS,EAAe/R,OAAQP,IACvCoS,EAAUK,WAAWnK,KAAK7G,KAAKiR,cAAcJ,EAAetS,IAGhE,OAAOoS,MR0xDPtP,IAAK,aACL7B,MAAO,SQxxDC0R,GACR,GAAIC,GAAS,GAAIb,GAAAA,WAAKc,OAClBC,EAAA,MAEJF,GAAOpK,IAAMmK,EAAWJ,aAAa,OACrCK,EAAOG,aAAeJ,EAAWJ,aAAa,gBAC9CK,EAAOI,OAASL,EAAWJ,aAAa,UACxCO,EAAcH,EAAWlC,qBAAqB,SAC9C,KAAK,GAAIzQ,GAAI,EAAGA,EAAI8S,EAAYvS,OAAQP,IACpC4S,EAAOlK,QAAQJ,KAAK7G,KAAKwR,WAAWH,EAAY9S,IAGpD,OAAO4S,MR2xDP9P,IAAK,cACL7B,MAAO,SQzxDEiS,GACT,GAAI3K,GAAU,GAAIwJ,GAAAA,WAAKoB,QACnBC,EAAsBnB,EAAAA,WAAOoB,eAAeH,EAAa,kBAAmB,aAC5EI,EAAoBrB,EAAAA,WAAOoB,eAAeH,EAAa,gBAAiB,aACxEJ,EAAcb,EAAAA,WAAOoB,eAAeH,EAAa,UAAW,UAC5DlT,EAAA,MAKJ,KAHAuI,EAAQqB,GAAKsJ,EAAYX,aAAa,MACtChK,EAAQgL,YAAcL,EAAYX,aAAa,eAE1CvS,EAAI,EAAGA,EAAIoT,EAAoB7S,OAAQP,IACxCuI,EAAQiL,gBAAgBlL,KAAK7G,KAAKiR,cAAcU,EAAoBpT,IAGxE,KAAKA,EAAI,EAAGA,EAAIsT,EAAkB/S,OAAQP,IACtCuI,EAAQkL,cAAcnL,KAAK7G,KAAKiR,cAAcY,EAAkBtT,IAGpE,KAAKA,EAAI,EAAGA,EAAI8S,EAAYvS,OAAQP,IAChCuI,EAAQG,QAAQJ,KAAK7G,KAAKwR,WAAWH,EAAY9S,IAGrD,OAAOuI,MR4xDPzF,IAAK,eACL7B,MAAO,SQ1xDGyS,EAAUC,GAGpB,IAAK,GAFDC,GAAe3B,EAAAA,WAAOoB,eAAeK,EAAU,WAAY,WAEtD1T,EAAI,EAAGA,EAAI4T,EAAarT,OAAQP,IACrC2T,EAAKxK,SAASb,KAAK7G,KAAKoS,YAAYD,EAAa5T,SR6yDzDsC,EAAa4P,IACTpP,IAAK,QACL7B,MAAO,SQjyDJ6S,GACH,GAAIC,GAAQ,GAAIhC,GAAAA,WAAKiC,KACjBN,EAAWzB,EAAAA,WAAOzH,WAAWsJ,EAAQ,OAEzC,OAAiB,QAAbJ,EACOK,GAGXtS,KAAKwS,aAAaP,EAAUK,GAErBA,ORqyDJ7B,IAGX7R,GAAAA,WQnyDe6R,IRqyDZgC,kBAAkB,GAAGC,eAAe,KAAKC,GAAG,SAASrU,EAAQU,EAAOJ,GACvE,YA2CA,SAASwB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAzChHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MS54DhiB+P,EAAA/R,EAAA,gBAEMsU,ETi7De,WS/zDjB,QAAAA,KAAcxS,EAAAJ,KAAA4S,GACV5S,KAAK6S,SAAW,KTy/DpB,MA1LAhS,GAAa+R,IACTvR,IAAK,aAML7B,MAAO,SSp7DCsT,GACR,GAAIC,GACAC,EAAkB,KAClBC,EAAiB,EAErB,OAAKH,IAILC,EAAYD,EAAII,MAAM,KAGG,IAArBH,EAAUjU,UAILqU,SAASJ,EAAU,IAAMC,EACzBG,SAASJ,EAAU,IAAME,EACzBG,WAAWL,EAAU,WTq7D9B1R,IAAK,iBACL7B,MAAO,SSn7DK6T,EAAQC,EAAQvC,GAC5B,GAAIwC,IAAM,CAEV,IAAIF,EAAS,GAAKC,EAAS,EACvB,OAAO,CAGX,QAAQvC,GACJ,IAAKV,GAAAO,UAAU4C,SAASC,GACpBF,EAAOF,IAAWC,CAClB,MACJ,KAAKjD,GAAAO,UAAU4C,SAASE,IACpBH,EAAOF,IAAWC,CAClB,MACJ,KAAKjD,GAAAO,UAAU4C,SAASG,IACpBJ,EAAOF,EAASC,CAChB,MACJ,KAAKjD,GAAAO,UAAU4C,SAASI,IACpBL,EAAOF,GAAUC,CACjB,MACJ,KAAKjD,GAAAO,UAAU4C,SAASK,GACpBN,EAAOF,EAASC,CAChB,MACJ,KAAKjD,GAAAO,UAAU4C,SAASM,IACpBP,EAAOF,GAAUC,CACjB,MACJ,KAAKjD,GAAAO,UAAU4C,SAASO,IACpBR,EAAQF,EAASC,IAAY,EAKrC,MAAOC,MTs7DPlS,IAAK,qBACL7B,MAAO,SSp7DSmR,EAAWqD,GAC3B,GACIzV,GADAgV,GAAM,CASV,IAL0B,IAAtBS,EAAMC,aAAqBtD,EAAUnN,OAAS6M,EAAAO,UAAUsD,KAAKC,OAASxD,EAAUtH,OAASgH,EAAAO,UAAU/O,KAAKuS,gBACxGb,GAAM,GAIN5C,EAAUnN,OAAS6M,EAAAO,UAAUsD,KAAKG,SAClC,OAAQ1D,EAAUtH,MACd,IAAKgH,GAAAO,UAAU/O,KAAKyS,SAChBf,EAAMvT,KAAKuU,eAAeP,EAAMC,YAAajU,KAAKwU,WAAW7D,EAAUnR,OAAQmR,EAAUI,SACzF,MACJ,KAAKV,GAAAO,UAAU/O,KAAK4S,SAChBlB,EAAMvT,KAAKuU,eAAeP,EAAMU,SAAU1U,KAAKwU,WAAW7D,EAAUnR,OAAQmR,EAAUI,UAclG,IANIiD,EAAMhM,OAAS2I,EAAUnN,OAAS6M,EAAAO,UAAUsD,KAAKC,OAASxD,EAAUtH,OAASgH,EAAAO,UAAU/O,KAAK8S,cAC5FpB,GAAM,GAKLhV,EAAI,EAAGA,EAAIoS,EAAUK,WAAWlS,OAAQP,IACzCgV,GAAOvT,KAAK4U,mBAAmBjE,EAAUK,WAAWzS,GAAIyV,EAG5D,OAAOT,MTu7DPlS,IAAK,sBACL7B,MAAO,SSr7DUwR,EAAYgD,GAC7B,GACIzV,GADAgV,GAAM,CAKV,KAAKhV,EAAI,EAAGA,EAAIyS,EAAWlS,OAAQP,IAC/BgV,GAAQvT,KAAK4U,mBAAmB5D,EAAWzS,GAAIyV,EAGnD,OAAOT,OT48DX1S,EAAa+R,IACTvR,IAAK,OACL7B,MAAO,SS77DLsH,GACF9G,KAAK6S,SAAW/L,KTy8DhBzF,IAAK,aACL7B,MAAO,WS/7DP,MAAOQ,MAAK6S,YT48DZxR,IAAK,uBACL7B,MAAO,SSn8DWwU,GAClB,OAAIhU,KAAK6S,SAASvK,WAGXtI,KAAK6U,oBAAoB7U,KAAK6S,SAASd,gBAAiBiC,MT+8D/D3S,IAAK,qBACL7B,MAAO,SSt8DSwU,GAChB,MAAOhU,MAAK6U,oBAAoB7U,KAAK6S,SAASb,cAAegC,OT08D1DpB,IAGXhU,GAAAA,WSz8DegU,IT28DZF,eAAe,KAAKoC,IAAI,SAASxW,EAAQU,EAAOJ,GACnD,YAMA,SAASwB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAJhHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAsCX,IU/pEM+S,GACF,QAAAA,KAAenS,EAAAJ,KAAAuS,GACXvS,KAAKyG,QAAU,GACfzG,KAAK0H,aAQPgK,EACF,QAAAA,KAAetR,EAAAJ,KAAA0R,GACX1R,KAAKmI,GAAK,GACVnI,KAAK8R,YAAc,EACnB9R,KAAK+R,mBACL/R,KAAKgS,iBACLhS,KAAKiH,WACLjH,KAAK+U,kBAAmB,EACxB/U,KAAKqH,SACLrH,KAAKsI,WAAY,GAQnBsI,EACF,QAAAA,KAAexQ,EAAAJ,KAAA4Q,GACX5Q,KAAKwD,KAAO,GACZxD,KAAKqJ,KAAO,GACZrJ,KAAKR,MAAQ,GACbQ,KAAK+Q,SAAW,GAChB/Q,KAAKgR,cAKbJ,GAAUsD,MACNC,MAAO,QACPE,SAAU,YAKdzD,EAAU/O,MACNuS,cAAe,cACfO,YAAa,YACbL,SAAU,WACVG,SAAU,YAId7D,EAAU4C,UACNC,GAAK,KACLC,IAAK,MACLC,IAAK,MACLC,IAAK,MACLC,GAAK,KACLC,IAAK,MACLC,IAAK,MV6qET,IUtqEM3C,GACF,QAAAA,KAAehR,EAAAJ,KAAAoR,GACXpR,KAAK+G,IAAM,GACX/G,KAAKsR,aAAe,GACpBtR,KAAKuR,OAAS,GACdvR,KAAKiH,WAMbmK,GAAO4D,QACHC,KAAM,OACNC,IAAK,MAIT,IAAIhD,KAEJA,GAAKK,KAAOA,EACZL,EAAKR,QAAUA,EACfQ,EAAKtB,UAAYA,EACjBsB,EAAKd,OAASA,EVyqEdxS,EAAAA,WUvqEesT,EVwqEftT,EUvqES2T,KAAAA,EVwqET3T,EUxqEe8S,QAAAA,EVyqEf9S,EUzqEwBgS,UAAAA,EV0qExBhS,EU1qEmCwS,OAAAA,OV4qE7B+D,IAAI,SAAS7W,EAAQU,EAAOJ,GAClC,YA2CA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCA3ChHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MWhxEhiBwD,EAAAxF,EAAA,YXmzEIyF,EAAU7E,EAAuB4E,GWjzE/BsR,EXuzEY,WW/uEd,QAAAA,KAAchV,EAAAJ,KAAAoV,GAEVpV,KAAKqV,KAAO,GACZrV,KAAKsV,OAAS,KACdtV,KAAKuV,UAAY,EACjBvV,KAAKwV,aAAe,EACpBxV,KAAKyV,cACLzV,KAAK0V,eAAiB,KACtB1V,KAAK2V,cACL3V,KAAK4V,SAAW,OAAQ,QAAS,aAAc,SAC/C5V,KAAKsF,OAASvB,EAAAA,WAAM3B,cX88ExB,MAxOAvB,GAAauU,IACT/T,IAAK,gBACL7B,MAAO,SWxzEIgE,GAIX,MAHMA,KAAQxD,MAAKyV,aACfzV,KAAKyV,WAAWjS,OAEbxD,KAAKyV,WAAWjS,MX2zEvBnC,IAAK,oBACL7B,MAAO,SWzzEQgE,EAAMC,GACrB,GAAIuK,GAAYhO,KAAKiO,cAAczK,GAC/B0K,EAAMF,EAAU3K,QAAQI,EAExByK,SACAF,EAAUnH,KAAKpD,MX6zEnBpC,IAAK,uBACL7B,MAAO,SW1zEWgE,EAAMC,GACxB,GAAIuK,GAAYhO,KAAKiO,cAAczK,GAC/B0K,EAAMF,EAAU3K,QAAQI,EAExByK,SACAF,EAAUpF,OAAOsF,EAAK,MX8zE1B7M,IAAK,eACL7B,MAAO,SW3zEGgE,GACV,GAAIwK,GAAYhO,KAAKiO,cAAczK,GAC/BjF,EAAI,CAER,KAAKA,EAAI,EAAGA,EAAIyP,EAAUlP,OAAQP,IAC9ByP,EAAUzP,GAAGM,KAAKmB,SX+zEtBqB,IAAK,qBACL7B,MAAO,WW3zEP,GAAIqW,IAAO,GAAI7L,OAAO8L,SAEtB9V,MAAKwV,eAAiBK,EAAO7V,KAAK2V,YAAc,IAEhD3V,KAAK+V,aAAa,cAEd/V,KAAKwV,cAAgBxV,KAAKuV,YAC1BvV,KAAKgW,aACLhW,KAAK+V,aAAa,UAGtB/V,KAAK2V,WAAaE,KX+zElBxU,IAAK,cACL7B,MAAO,WW5zEqB,OAAxBQ,KAAK0V,iBAGT1V,KAAK+V,aAAa,QAClB/V,KAAK2V,YAAa,GAAI3L,OAAO8L,UAC7B9V,KAAK0V,eAAiBO,YAAYjW,KAAKkW,mBAAmB3T,KAAKvC,MAAO,SXg0EtEqB,IAAK,aACL7B,MAAO,WW7zEqB,OAAxBQ,KAAK0V,iBAGT1V,KAAK+V,aAAa,SAClBI,cAAcnW,KAAK0V,gBACnB1V,KAAK0V,eAAiB,UXo1E1B7U,EAAauU,IACT/T,IAAK,OACL7B,MAAO,SWn0ELiH,EAAS2P,GAEX,GACI5S,GACAjF,EAFA8X,EAAY,IAMhB,KAAK9X,EAAI,EAAGA,EAAI6X,EAAWtX,OAAQP,IAE/B,GADAiF,EAAO4S,EAAW7X,GAAGiF,KACP,eAATA,GAAoC,cAATA,GAAmC,cAATA,GAAmC,cAATA,EAAuB,CACvG6S,EAAYD,EAAW7X,EACvB,OAIR,MAAkB,QAAd8X,IAKJrW,KAAKsV,OAASgB,SAASC,eAAe,mBAEjCvW,KAAKsV,SAENtV,KAAKsV,OAASgB,SAASE,cAAc,OACrCxW,KAAKsV,OAAOmB,UAAW,EACvBzW,KAAKsV,OAAOnN,GAAK,mBAIrBnI,KAAKqV,KAAOgB,EAAUtP,IACtB/G,KAAKqV,KAAQrV,KAAKqV,KAAKhS,QAAQ,gBAAsBoD,EAAUzG,KAAKqV,KAAQrV,KAAKqV,KAEjFrV,KAAKsF,OAAOe,IAAI,2BAA6BrG,KAAKqV,MAClDrV,KAAKsV,OAAOoB,IAAM1W,KAAKqV,KAGvBrV,KAAKwV,aAAe,GAEb,MXs0EPnU,IAAK,UACL7B,MAAO,WWn0EP,MAAO,WXu0EP6B,IAAK,aACL7B,MAAO,WWp0EP,MAAOQ,MAAKsV,UXw0EZjU,IAAK,mBACL7B,MAAO,SWt0EOgE,EAAMC,GACfzD,KAAKsV,SAGNtV,KAAK4V,QAAQvS,QAAQG,QACrBxD,KAAK2W,kBAAkBnT,EAAMC,GAE7BzD,KAAKsV,OAAO1S,iBAAiBY,EAAMC,OX00EvCpC,IAAK,sBACL7B,MAAO,SWv0EUgE,EAAMC,GAClBzD,KAAKsV,SAGNtV,KAAK4V,QAAQvS,QAAQG,QACrBxD,KAAK4W,qBAAqBpT,EAAMC,GAEhCzD,KAAKsV,OAAOlS,oBAAoBI,EAAMC,OX20E1CpC,IAAK,cACL7B,MAAO,SWx0EEkV,GACT1U,KAAKuV,UAAYb,KX20EjBrT,IAAK,cACL7B,MAAO,WWx0EP,MAAOQ,MAAKuV,aX40EZlU,IAAK,iBACL7B,MAAO,WWz0EP,MAAOQ,MAAKwV,gBX60EZnU,IAAK,YACL7B,MAAO,eAIP6B,IAAK,YACL7B,MAAO,WW30EP,MAAO,MX+0EP6B,IAAK,OACL7B,MAAO,WW50EFQ,KAAKsV,QAGVtV,KAAK6W,iBXg1ELxV,IAAK,QACL7B,MAAO,WW70EFQ,KAAKsV,QAGVtV,KAAKgW,gBXi1EL3U,IAAK,OACL7B,MAAO,WW90EFQ,KAAKsV,QAGVtV,KAAKgW,gBXk1EL3U,IAAK,QACL7B,MAAO,WW/0EFQ,KAAKsV,SAGVtV,KAAKsV,OAAS,KACdtV,KAAKyV,mBXo1EFL,IAGXxW,GAAAA,WWn1EewW,IXq1EZ0B,WAAW,IAAIC,IAAI,SAASzY,EAAQU,EAAOJ,GAC9C,YA2CA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCA3ChHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MY9iFhiBwD,EAAAxF,EAAA,YZilFIyF,EAAU7E,EAAuB4E,GY/kF/BkT,EZqlFY,WYjkFd,QAAAA,KAAc5W,EAAAJ,KAAAgX,GACVhX,KAAKqV,KAAO,GACZrV,KAAKiX,OAAS,KACdjX,KAAKsF,OAASvB,EAAAA,WAAM3B,cZ2uFxB,MA5KAvB,GAAamW,IACT3V,IAAK,mBAML7B,MAAO,SYxlFO0X,GACd,IAAKlX,KAAKiX,OACN,KAAM,yCAEV,MAAMjX,KAAKiX,iBAAkBE,mBACzB,KAAM,8DAGV,IAAIC,GAAUpX,KAAKiX,OAAOI,YAAYH,EACtC,OAAoB,aAAZE,GAAsC,UAAZA,MZwmFtCvW,EAAamW,IACT3V,IAAK,OACL7B,MAAO,SY9lFLiH,EAAS2P,GAaX,MAVApW,MAAKiX,OAASX,SAASC,eAAe,mBAEjCvW,KAAKiX,SAENjX,KAAKiX,OAASX,SAASE,cAAc,SACrCxW,KAAKiX,OAAOR,UAAW,EACvBzW,KAAKiX,OAAO9O,GAAK,qBAIhBnI,KAAKsX,iBAAiBlB,EAAW,GAAG5S,QAKzC4S,EAAWmB,KAAK,SAASlZ,EAAGmZ,GACxB,MAAInZ,GAAEoZ,SAAWD,EAAEC,QACRpZ,EAAEoZ,QAAUD,EAAEC,aAM7BzX,KAAKqV,KAAOe,EAAW,GAAGrP,IAG1B/G,KAAKqV,KAAQrV,KAAKqV,KAAKhS,QAAQ,gBAAsBoD,EAAUzG,KAAKqV,KAAQrV,KAAKqV,KAEjFrV,KAAKsF,OAAOe,IAAI,2BAA6BrG,KAAKqV,MAElDrV,KAAKiX,OAAOrU,iBAAiB,QAAS,SAAS9E,GAC3CoO,QAAQ7F,IAAIvI,KAGhBkC,KAAKiX,OAAOP,IAAM1W,KAAKqV,MAEhB,MZimFPhU,IAAK,UACL7B,MAAO,WY9lFP,MAAO,WZkmFP6B,IAAK,aACL7B,MAAO,WY/lFP,MAAOQ,MAAKiX,UZmmFZ5V,IAAK,mBACL7B,MAAO,SYjmFOgE,EAAMC,GACfzD,KAAKiX,QAGVjX,KAAKiX,OAAOrU,iBAAiBY,EAAMC,MZomFnCpC,IAAK,sBACL7B,MAAO,SYlmFUgE,EAAMC,GAClBzD,KAAKiX,QAGVjX,KAAKiX,OAAO7T,oBAAoBI,EAAMC,MZqmFtCpC,IAAK,cACL7B,MAAO,eAIP6B,IAAK,cACL7B,MAAO,WYnmFP,MAAKQ,MAAKiX,OAGHjX,KAAKiX,OAAOvC,SAFR,KZymFXrT,IAAK,iBACL7B,MAAO,WYpmFP,MAAKQ,MAAKiX,OAGHjX,KAAKiX,OAAOhD,YAFR,KZ0mFX5S,IAAK,YACL7B,MAAO,WYrmFP,MAAKQ,MAAKiX,OAGHjX,KAAKiX,OAAOS,MAAQ,EAAI1X,KAAKiX,OAAOU,OAFhC,KZ2mFXtW,IAAK,YACL7B,MAAO,SYvmFAmY,GACF3X,KAAKiX,SAGVjX,KAAKiX,OAAOU,OAASA,MZ0mFrBtW,IAAK,OACL7B,MAAO,WYvmFFQ,KAAKiX,QAGVjX,KAAKiX,OAAO3T,UZ2mFZjC,IAAK,OACL7B,MAAO,WYxmFFQ,KAAKiX,QAGVjX,KAAKiX,OAAO1T,WZ4mFZlC,IAAK,QACL7B,MAAO,WYzmFFQ,KAAKiX,QAGVjX,KAAKiX,OAAO1T,WZ6mFZlC,IAAK,QACL7B,MAAO,WY1mFFQ,KAAKiX,SAGVjX,KAAKiX,OAAS,UZ+mFXD,IAGXpY,GAAAA,WY9mFeoY,IZgnFZF,WAAW,IAAIc,IAAI,SAAStZ,EAAQU,EAAOJ,GAC9C,YAEAU,QAAOC,eAAeX,EAAS,cAC3BY,OAAO,GajxFX,IAAIqY,KAEJA,GAAO7I,qBAAuB,SAAS8I,EAAMzO,GACzC,GAAI0O,GAAWD,EAAK9I,qBAAqB3F,EACzC,IAAI0O,EAASjZ,OAAS,EAAG,CACrB,GAAIkZ,GAAQF,EAAKG,mBAAqBH,EAAKI,UAC3C,IAAIF,EAAO,CACP,GAAIG,GAAeH,EAAMG,YACzBJ,GAAWD,EAAKM,uBAAuBD,EAAc9O,IAG7D,MAAO0O,IAGXF,EAAO9O,WAAa,SAAS+O,EAAMzO,GAC/B,GAAI0O,GAAW/X,KAAKgP,qBAAqB8I,EAAMzO,EAC/C,OAAI0O,GAASjZ,OAAS,EACX,KAEJiZ,EAAS,IAGpBF,EAAOQ,YAAc,SAASP,EAAMzO,GAChC,MAAOrJ,MAAKgP,qBAAqB8I,EAAMzO,IAG3CwO,EAAOjG,eAAiB,SAASkG,EAAMzO,EAAMiP,GACzC,GAAIC,GAAUvY,KAAK+I,WAAW+O,EAAMzO,EACpC,OAAgB,QAAZkP,KAGGvY,KAAKqY,YAAYE,EAASD,IAGrCT,EAAOW,aAAe,SAAUV,EAAMzO,GAClC,IAAKyO,IAASA,EAAKW,WACf,MAAO,KAEX,KAAK,GAAIla,GAAI,EAAGA,EAAIuZ,EAAKW,WAAW3Z,OAAQP,IACxC,GAAIuZ,EAAKW,WAAWla,GAAGma,WAAarP,EAChC,MAAOyO,GAAKW,WAAWla,EAG/B,OAAO,OAGXsZ,EAAOc,iBAAmB,SAAUb,GAChC,GAAIc,GAAe5Y,KAAKwY,aAAaV,EAAM,kBACvCe,EAAc7Y,KAAKwY,aAAaV,EAAM,QAC1C,OAAIc,GACOA,EAAaE,UACbD,EACAA,EAAYC,UAEhB,IAGXjB,EAAOkB,sBAAwB,SAAUjB,EAAMzO,GAC3C,GAAIkP,GAAUvY,KAAK+I,WAAW+O,EAAMzO,EACpC,OAAgB,QAAZkP,EACO,GAEJvY,KAAK2Y,iBAAiBJ,IbmzFjC3Z,EAAAA,Wa/yFeiZ,ObizFTmB,IAAI,SAAS1a,EAAQU,EAAOJ,GAClC,YA+DA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCA/DhHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,Mcl3FhiB2Y,EAAA3a,EAAA,2Bdy5FI4a,EAA0Bha,EAAuB+Z,Gcx5FrDE,EAAA7a,EAAA,wBd45FI8a,EAAgBla,EAAuBia,Gc35F3CE,EAAA/a,EAAA,wBd+5FIgb,EAAgBpa,EAAuBma,Gc95F3CvV,EAAAxF,EAAA,Ydk6FIyF,EAAU7E,EAAuB4E,Gcj6FrCnC,EAAArD,EAAA,edq6FIsD,EAAa1C,EAAuByC,Gcn6FlC4X,Edy6Fe,WcvqFjB,QAAAA,KAAcnZ,EAAAJ,KAAAuZ,GACVvZ,KAAKwZ,mBAAqB,KAC1BxZ,KAAKyZ,aAAe,KACpBzZ,KAAK0Z,uBAAyB,KAC9B1Z,KAAK8E,WAAa,KAClB9E,KAAKsF,OAASvB,EAAAA,WAAM3B,cACpBpC,KAAKmC,UAAYP,EAAAA,WAASQ,cAE1BpC,KAAK2Z,qBAAuB3Z,KAAK4Z,aAAarX,KAAKvC,MACnDA,KAAK6Z,sBAAwB7Z,KAAK8Z,cAAcvX,KAAKvC,MACrDA,KAAK+Z,sBAAwB/Z,KAAKga,cAAczX,KAAKvC,MACrDA,KAAKia,2BAA6Bja,KAAKka,mBAAmB3X,KAAKvC,MAC/DA,KAAKma,sBAAwBna,KAAKoa,cAAc7X,KAAKvC,Mds+FzD,MA1UAa,GAAa0Y,IACTlY,IAAK,aAML7B,MAAO,Sc56FCsT,GACR,GAAIC,GACAC,EAAkB,KAClBC,EAAiB,EAErB,OAAKH,IAILC,EAAYD,EAAII,MAAM,KAGG,IAArBH,EAAUjU,UAILqU,SAASJ,EAAU,IAAMC,EACzBG,SAASJ,EAAU,IAAME,EACzBG,WAAWL,EAAU,Wd66F9B1R,IAAK,eACL7B,MAAO,Wcz6FPQ,KAAKsF,OAAOe,IAAI,uBAGhBrG,KAAKmC,UAAU4F,eACXvE,KAAM,OACN9C,ad+6FJW,IAAK,gBACL7B,MAAO,Wc16FPQ,KAAKsF,OAAOe,IAAI,wBAGhBrG,KAAKmC,UAAU4F,eACXvE,KAAM,QACN9C,adg7FJW,IAAK,gBACL7B,MAAO,Wc36FPQ,KAAKsF,OAAOe,IAAI,wBAGhBrG,KAAKmC,UAAU4F,eACXvE,KAAM,cACN9C,adi7FJW,IAAK,gBACL7B,MAAO,Wc56FPQ,KAAKsF,OAAOe,IAAI,wBAGhBrG,KAAKmC,UAAU4F,eACXvE,KAAM,cACN9C,adk7FJW,IAAK;AACL7B,MAAO,eAKP6B,IAAK,aACL7B,MAAO,Wc96FFQ,KAAKqa,cAIVra,KAAKsF,OAAOe,IAAI,kBAGZrG,KAAKqa,YAAYC,eACjBta,KAAKsF,OAAOe,IAAI,mBAAqBrG,KAAKqa,YAAYC,cACtDta,KAAKmC,UAAU4F,eACXvE,KAAM,QACN9C,MACIqG,IAAK/G,KAAKqa,YAAYC,qBd27FlCjZ,IAAK,QACL7B,MAAO,Scj7FJ+a,EAAU9T,GACb,GAAI4P,GACAmE,EACAC,CAEJ,KAAKF,EACD,OAAO,CAGX,IAAmC,IAA/BA,EAASnE,WAAWtX,OACpB,OAAO,CASX,IANAuX,EAAYkE,EAASnE,WAAW,GAGhCoE,EAAUnE,EAAU7S,KAAKH,QAAQ,cACjCoX,EAAUpE,EAAU7S,KAAKH,QAAQ,cAE7BmX,EACAxa,KAAKyZ,aAAe,GAAAL,GAAAA,eAEnB,CAAA,IAAIqB,EAIL,OAAO,CAHPza,MAAKyZ,aAAe,GAAAH,GAAAA,WAQxB,MADAtZ,MAAKsF,OAAOe,IAAI,iBACXrG,KAAKyZ,aAAa1W,KAAK0D,EAAS8T,EAASnE,aAK9CpW,KAAKyZ,aAAaiB,YAAY1a,KAAKwU,WAAW+F,EAAS7F,WACvD1U,KAAKyZ,aAAa7W,iBAAiB,OAAQ5C,KAAK2Z,sBAChD3Z,KAAKyZ,aAAa7W,iBAAiB,QAAS5C,KAAK6Z,uBACjD7Z,KAAKyZ,aAAa7W,iBAAiB,QAAS5C,KAAK+Z,uBACjD/Z,KAAKyZ,aAAa7W,iBAAiB,aAAc5C,KAAKia,4BACtDja,KAAKyZ,aAAa7W,iBAAiB,QAAS5C,KAAMma,uBAG9CI,EAASI,iBACT3a,KAAK0Z,uBAAyB,GAAAR,GAAAA,WAC9BlZ,KAAK0Z,uBAAuB/W,KAAK4X,EAASI,eAAgB3a,KAAKyZ,cAC/DzZ,KAAK0Z,uBAAuBtR,SAIhCpI,KAAKmC,UAAU4F,eACXvE,KAAM,gBACN9C,UAIJV,KAAKmC,UAAU4F,eACXvE,KAAM,aACN9C,MACI6X,QAASvY,KAAKyZ,aAAa1Q,aAC3BvF,KAAMxD,KAAKyZ,aAAamB,aAKhC5a,KAAKwZ,mBAAmBqB,YAAY7a,KAAKyZ,aAAa1Q,cAGlDwR,EAASF,cACLE,EAASF,YAAYC,eACrBta,KAAKyZ,aAAa1Q,aAAa+R,MAAMC,OAAS,WAElD/a,KAAKyZ,aAAa1Q,aAAanG,iBAAiB,QAAS5C,KAAKgb,WAAWzY,KAAKgY,GAAUhY,KAAKvC,QAIjGA,KAAKib,2BAGLjb,KAAKkb,SAEE,IAlDHlb,KAAKyZ,aAAe,MACb,Mdk+FXpY,IAAK,QACL7B,MAAO,Wc76FFQ,KAAKyZ,eAIVzZ,KAAKsF,OAAOe,IAAI,iBAGhBrG,KAAKyZ,aAAanW,Wdk7FlBjC,IAAK,SACL7B,MAAO,Wc96FFQ,KAAKyZ,eAIVzZ,KAAKsF,OAAOe,IAAI,kBAGhBrG,KAAKyZ,aAAalW,Ydm7FlBlC,IAAK,QACL7B,MAAO,Wc/6FFQ,KAAKyZ,eAIVzZ,KAAKsF,OAAOe,IAAI,iBAGhBrG,KAAKyZ,aAAarW,oBAAoB,OAAQpD,KAAK2Z,sBACnD3Z,KAAKyZ,aAAarW,oBAAoB,QAASpD,KAAK6Z,uBACpD7Z,KAAKyZ,aAAarW,oBAAoB,QAASpD,KAAK+Z,uBACpD/Z,KAAKyZ,aAAarW,oBAAoB,aAAcpD,KAAKia,4BACzDja,KAAKyZ,aAAarW,oBAAoB,QAASpD,KAAKma,uBACpDna,KAAKyZ,aAAaxW,OAGlBjD,KAAKmC,UAAU4F,eACXvE,KAAM,gBACN9C,MACI6X,QAASvY,KAAKyZ,aAAa1Q,aAC3BvF,KAAMxD,KAAKyZ,aAAamB,aAKhC5a,KAAKwZ,mBAAmB2B,YAAYnb,KAAKyZ,aAAa1Q,cAGtD/I,KAAKyZ,aAAavW,QAClBlD,KAAKyZ,aAAe,KAGhBzZ,KAAK0Z,yBACL1Z,KAAK0Z,uBAAuBzW,OAC5BjD,KAAK0Z,uBAAyB,Udq7FlCrY,IAAK,2BACL7B,MAAO,Wcj7FFQ,KAAKyZ,cAGVzZ,KAAKyZ,aAAa2B,UAAUpb,KAAK8E,WAAW4S,MAAQ,EAAI1X,KAAK8E,WAAW6S,Ydq9F5E9W,EAAa0Y,IACTlY,IAAK,OACL7B,MAAO,Sc17FL6b,EAAmBC,GACrBtb,KAAKwZ,mBAAqB6B,EAC1Brb,KAAK8E,WAAawW,EAClBtb,KAAK8E,WAAWlC,iBAAiB,eAAgB5C,KAAKib,yBAAyB1Y,KAAKvC,Ud67FpFqB,IAAK,OACL7B,MAAO,Sc37FL+a,EAAU9T,GACZ,MAAOzG,MAAKmQ,MAAMoK,EAAU9T,Md87F5BpF,IAAK,OACL7B,MAAO,Wc37FPQ,KAAKkb,Wd+7FL7Z,IAAK,QACL7B,MAAO,Wc57FPQ,KAAKub,Ydg8FLla,IAAK,OACL7B,MAAO,Wc77FPQ,KAAKwb,Wdi8FLna,IAAK,QACL7B,MAAO,Wc97FPQ,KAAK8E,WAAW1B,oBAAoB,eAAgBpD,KAAKib,0BACzDjb,KAAK8E,WAAa,Sdm8FfyU,IAGX3a,GAAAA,Wcl8Fe2a,Ido8FZzC,WAAW,EAAE2E,cAAc,EAAEC,uBAAuB,GAAGC,uBAAuB,GAAGC,0BAA0B,KAAKC,IAAI,SAASvd,EAAQU,EAAOJ,GAC/I,YA4CA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCA5ChHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MezwGhiBwD,EAAAxF,EAAA,Yf6yGIyF,EAAU7E,EAAuB4E,Ge3yG/BgY,EfizGsB,We9pGxB,QAAAA,KAAc1b,EAAAJ,KAAA8b,GACV9b,KAAK+b,gBAAkB,KACvB/b,KAAKgc,eAAiB,KACtBhc,KAAKwV,gBACLxV,KAAKic,SACLjc,KAAKkc,WACLlc,KAAKsF,OAASvB,EAAAA,WAAM3B,cACpBpC,KAAKmc,mBfg2GT,MAxMAtb,GAAaib,IACTza,IAAK,aAML7B,MAAO,SepzGCuH,GACR,GAAIqV,GAAM,GAAIvM,eACduM,GAAIpM,KAAK,MAAOjJ,GAAK,GACrBqV,EAAIC,iBAAiB,eAAgB,mCACrCD,EAAIlM,UfuzGJ7O,IAAK,oBACL7B,MAAO,SerzGQ+Y,EAAS+D,EAAWC,GAEnC,GAAItc,GAAOD,KACPwc,EAAY,WACJxc,KAAKyc,aAAc,GAGN/c,SAAbM,KAAK+G,KAAyC,IAApB/G,KAAK+G,IAAIjI,SAGnCkB,KAAK2Q,YAAc3Q,KAAK2Q,cAG5B1Q,EAAKqF,OAAOe,IAAI,uBAAyBrG,KAAK0c,MAAQ,WAAa1c,KAAK+G,KACxE9G,EAAK0c,WAAW3c,KAAK+G,KACjB/G,KAAK4c,WAAY,IACjB5c,KAAKyc,WAAY,MAGzBI,GACIrZ,KAAM8Y,EACN/D,QAASA,EACT9U,SAAU+Y,EAAUja,KAAKga,GAGjChE,GAAQ3V,iBAAiB0Z,EAAWO,EAAepZ,UACnDzD,KAAKmc,gBAAgBtV,KAAKgW,MfwzG1Bxb,IAAK,2BACL7B,MAAO,WepzGP,IAAK,GAFmBwG,GAAAhG,KAEfzB,EAAI,EAAGA,EAAIyB,KAAK+b,gBAAgBjd,OAAQP,IAAK,CAClD,GAAIge,GAAgBvc,KAAK+b,gBAAgBxd,EACzC,IAAIge,EAAcxV,KAAOwV,EAAcxV,IAAIjI,OAAS,EAChD,OAAQyd,EAAcG,OAClB,IAAK,eACDH,EAAcK,SAAU,EACxB5c,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,aAAcO,EAC1D,MACJ,KAAK,QACDA,EAAcK,SAAU,EACxB5c,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,UAAWO,EACvD,MACJ,KAAK,QACDA,EAAcK,SAAU,EACxB5c,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,SAAUO,EACtD,MACJ,KAAK,SACDA,EAAcK,SAAU,EACxBL,EAAc5L,UAAY,WACtB,MAAQ3K,GAAKgW,eAAec,iBAAmB,GAEnD9c,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,OAAQO,EACpD,MACJ,KAAK,gBACDA,EAAcK,SAAU,EACxBL,EAAc5L,UAAY,WAEtB,MAAS3K,GAAKgW,eAAec,iBAAmB9W,EAAKgW,eAAee,eAAkB,KAE1F/c,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,aAAcO,EAC1D,MACJ,KAAK,WACDA,EAAcK,SAAU,EACxBL,EAAc5L,UAAY,WAEtB,MAAS3K,GAAKgW,eAAec,iBAAmB9W,EAAKgW,eAAee,eAAkB,IAE1F/c,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,aAAcO,EAC1D,MACJ,KAAK,gBACDA,EAAcK,SAAU,EACxBL,EAAc5L,UAAY,WAEtB,MAAS3K,GAAKgW,eAAec,iBAAmB9W,EAAKgW,eAAee,eAAkB,KAE1F/c,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,aAAcO,EAC1D,MACJ,KAAK,SACDA,EAAcK,SAAU,EACxBL,EAAc5L,UAAY,WACtB,GAAI4C,GAAOvN,EAAKgW,eAAec,iBAAmB9W,EAAKwP,YAEvD,OADAxP,GAAKwP,aAAexP,EAAKgW,eAAec,iBACjCvJ,GAEXvT,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,aAAcO,EAC1D,MACJ,KAAK,WACDvc,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,QAASO,EACrD,MACJ,KAAK,OACDA,EAAcK,SAAU,EACxBL,EAAc5L,UAAY,WACtB,GAAI4C,IAAOvN,EAAKiW,OAA8C,IAApCjW,EAAKgW,eAAegB,WAE9C,OADAhX,GAAKiW,MAA6C,IAApCjW,EAAKgW,eAAegB,YAC3BzJ,GAEXvT,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,eAAgBO,EAC5D,MACJ,KAAK,SACDA,EAAcK,SAAU,EACxBL,EAAc5L,UAAY,WACtB,GAAI4C,IAAOvN,EAAKkW,SAAYlW,EAAKgW,eAAegB,YAAc,CAE9D,OADAhX,GAAKkW,QAAWlW,EAAKgW,eAAegB,YAAc,EAC3CzJ,GAEXvT,KAAK2W,kBAAkB3W,KAAKgc,eAAgB,eAAgBO,EAC5D,MACJ,KAAK,aACDA,EAAcK,SAAU,EACxBL,EAAc5L,UAAY,WACtB,MAAQ2F,UAAS2G,YAAc3G,SAAS4G,eAAiB5G,SAAS6G,oBAEtEnd,KAAK2W,kBAAkBL,SAAU,yBAA0BiG,GAC3Dvc,KAAK2W,kBAAkBL,SAAU,sBAAuBiG,GACxDvc,KAAK2W,kBAAkBL,SAAU,qBAAsBiG,GACvDvc,KAAK2W,kBAAkBL,SAAU,mBAAoBiG,Qfg0GrElb,IAAK,8BACL7B,MAAO,WevzGP,IAAK,GAAIjB,GAAI,EAAGA,EAAIyB,KAAKmc,gBAAgBrd,OAAQP,IAC7CyB,KAAKmc,gBAAgB5d,GAAGga,QAAQnV,oBAAoBpD,KAAKmc,gBAAgB5d,GAAGiF,KAAMxD,KAAKmc,gBAAgB5d,GAAGkF,SAE9GzD,MAAKmc,uBfs1GTtb,EAAaib,IACTza,IAAK,OACL7B,MAAO,Seh0GLmb,EAAgByC,GAClBpd,KAAK+b,gBAAkBpB,EACvB3a,KAAKgc,eAAiBoB,EACtBpd,KAAKic,MAA6C,IAApCjc,KAAKgc,eAAegB,YAClChd,KAAKkc,QAAWlc,KAAKgc,eAAegB,YAAc,Kfm0GlD3b,IAAK,QACL7B,MAAO,Weh0G6B,IAAhCQ,KAAK+b,gBAAgBjd,QAGzBkB,KAAKqd,8Bfo0GLhc,IAAK,OACL7B,MAAO,Wej0GPQ,KAAKsd,kCfs0GFxB,IAGXld,GAAAA,Wer0Gekd,Ifu0GZhF,WAAW,IAAIyG,IAAI,SAASjf,EAAQU,EAAOJ,GAC9C,YAgDA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAhDhHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MgBxgHhiBkd,EAAAlf,EAAA,gBhB4iHImf,EAASve,EAAuBse,GgB3iHpCjN,EAAAjS,EAAA,mBhB+iHIkS,EAAWtR,EAAuBqR,GgB7iHhCmN,EhBmjHW,WgB35Gb,QAAAA,KAActd,EAAAJ,KAAA0d,GhBwlHd,MA5LA7c,GAAa6c,IACTrc,IAAK,oBAML7B,MAAO,SgBtjHQme,GACf,GAAIpB,GAAgB,GAAIkB,GAAAA,WAAKG,aAK7B,OAHArB,GAAcG,MAAQiB,EAAa7M,aAAa,SAChDyL,EAAcxV,IAAMyJ,EAAAA,WAAOmI,iBAAiBgF,GAErCpB,KhByjHPlb,IAAK,kBACL7B,MAAO,SgBvjHMqe,GAKb,IAAK,GAJDxD,GAAc,GAAIoD,GAAAA,WAAKK,YACvBpF,EAAA,OACAI,EAAA,OAEKva,EAAI,EAAGA,EAAIsf,EAAgBpF,WAAW3Z,OAAQP,IAInD,OAHAma,EAAWmF,EAAgBpF,WAAWla,GAAGma,SACzCI,EAAYtI,EAAAA,WAAOmI,iBAAiBkF,EAAgBpF,WAAWla,IAEvDma,GACJ,IAAK,eACD2B,EAAYC,aAAexB,CAC3B,MACJ,KAAK,gBACDuB,EAAY0D,cAAgBjF,CAC5B,MACJ,KAAK,cACDuB,EAAY2D,YAAclF,EAKtC,MAAOuB,MhB0jHPhZ,IAAK,gBACL7B,MAAO,SgBxjHIye,GACX,GAAI5H,GAAY,GAAIoH,GAAAA,WAAKS,SAazB,OAXA7H,GAAUlO,GAAK8V,EAAcnN,aAAa,MAC1CuF,EAAU8H,SAAWF,EAAcnN,aAAa,YAChDuF,EAAU7S,KAAOya,EAAcnN,aAAa,QAC5CuF,EAAUoB,QAAUwG,EAAcnN,aAAa,WAC/CuF,EAAU+H,MAAQH,EAAcnN,aAAa,SAC7CuF,EAAUgI,OAASJ,EAAcnN,aAAa,UAC9CuF,EAAUiI,SAAWL,EAAcnN,aAAa,YAChDuF,EAAUkI,oBAAsBN,EAAcnN,aAAa,uBAC3DuF,EAAUmI,aAAeP,EAAcnN,aAAa,gBACpDuF,EAAUtP,IAAMyJ,EAAAA,WAAOmI,iBAAiBsF,GAEjC5H,KhB2jHPhV,IAAK,aACL7B,MAAO,SgBzjHCif,GACR,GAAIC,GAAS,GAAIjB,GAAAA,WAAKkB,OAClBC,EAAA,OACAf,EAAA,OACAgB,EAAA,OACAtgB,EAAA,MAMJ,KAJAmgB,EAAOhK,SAAWlE,EAAAA,WAAOuI,sBAAsB0F,EAAY,YAC3DC,EAAOI,aAAetO,EAAAA,WAAOuI,sBAAsB0F,EAAY,gBAE/DG,EAAgBpO,EAAAA,WAAOoB,eAAe6M,EAAY,iBAAkB,YAC/DlgB,EAAI,EAAGA,EAAIqgB,EAAc9f,OAAQP,IAClCmgB,EAAO/D,eAAe9T,KAAK7G,KAAK+e,kBAAkBH,EAAcrgB,IASpE,KANAsf,EAAkBrN,EAAAA,WAAOzH,WAAW0V,EAAY,eAC5CZ,IACAa,EAAOrE,YAAcra,KAAKgf,gBAAgBnB,IAG9CgB,EAAiBrO,EAAAA,WAAOoB,eAAe6M,EAAY,aAAc,aAC5DlgB,EAAI,EAAGA,EAAIsgB,EAAe/f,OAAQP,IACnCmgB,EAAOtI,WAAWvP,KAAK7G,KAAKif,cAAcJ,EAAetgB,IAG7D,OAAOmgB,MhB4jHPrd,IAAK,eACL7B,MAAO,SgB1jHG0f,GACV,GAAI3E,GAAW,GAAIkD,GAAAA,WAAK0B,SACpBV,EAAA,MAaJ,OAXAlE,GAASpS,GAAK+W,EAAapO,aAAa,MACxCyJ,EAAS6E,KAAOF,EAAapO,aAAa,QAC1CyJ,EAAS8E,SAAWH,EAAapO,aAAa,YAE9C2N,EAAajO,EAAAA,WAAOzH,WAAWmW,EAAc,UACzCT,IACAlE,EAASmE,OAAS1e,KAAKsf,WAAWb,IAK/BlE,KhB6jHPlZ,IAAK,aACL7B,MAAO,SgB3jHC+f,GACR,GAAIC,GAAS,GAAI/B,GAAAA,WAAKgC,OAClBC,EAAalP,EAAAA,WAAOzH,WAAWwW,EAAQ,UACvCI,EAAA,OACAC,EAAA,OACArhB,EAAA,MAEJ,IAAmB,OAAfmhB,EACA,MAAO,KAUX,KAPAF,EAAOK,SAAWrP,EAAAA,WAAOuI,sBAAsB2G,EAAY,YAC3DF,EAAOM,QAAUtP,EAAAA,WAAOuI,sBAAsB2G,EAAY,WAC1DF,EAAO1N,YAActB,EAAAA,WAAOuI,sBAAsB2G,EAAY,eAC9DF,EAAOO,OAASvP,EAAAA,WAAOuI,sBAAsB2G,EAAY,UACzDF,EAAO9Y,MAAQ8J,EAAAA,WAAOuI,sBAAsB2G,EAAY,SAExDC,EAAkBnP,EAAAA,WAAO6H,YAAYqH,EAAY,cAC5CnhB,EAAI,EAAGA,EAAIohB,EAAgB7gB,OAAQP,IAAK,CACzC,GAAIyhB,GAAa,GAAIvC,GAAAA,WAAKwC,UAC1BD,GAAW7X,GAAKwX,EAAgBphB,GAAGuS,aAAa,MAChDkP,EAAWjZ,IAAMyJ,EAAAA,WAAOmI,iBAAiBgH,EAAgBphB,IACzDihB,EAAOU,YAAYrZ,KAAKmZ,GAK5B,IADAJ,EAAgBpP,EAAAA,WAAOoB,eAAe8N,EAAY,YAAa,YAC1DnhB,EAAI,EAAGA,EAAIqhB,EAAc9gB,OAAQP,IAClCihB,EAAOW,UAAUtZ,KAAK7G,KAAKogB,aAAaR,EAAcrhB,IAG1D,OAAOihB,MhB6jHPne,IAAK,SACL7B,MAAO,SgB3jHH6gB,EAAUC,GACd,GAAIf,GAAS/O,EAAAA,WAAOzH,WAAWsX,EAAU,KAE1B,QAAXd,IAIJe,EAAMhZ,GAAK,GAAImW,GAAAA,WAAK8C,GACpBD,EAAMhZ,GAAGa,GAAKoX,EAAOzO,aAAa,MAClCwP,EAAMhZ,GAAGkY,OAASxf,KAAKwgB,WAAWjB,QhB6kHtC1e,EAAa6c,IACTrc,IAAK,QACL7B,MAAO,SgBjkHJ6S,GACH,GAAIiO,GAAQ,GAAI7C,GAAAA,WAAKgD,KACjBJ,EAAW7P,EAAAA,WAAOzH,WAAWsJ,EAAQ,OAEzC,OAAiB,QAAbgO,EACOC,GAGXA,EAAMI,QAAUL,EAASvP,aAAa,WAEtC9Q,KAAK2gB,OAAON,EAAUC,GAEfA,OhBqkHJ5C,IAGX9e,GAAAA,WgBpkHe8e,IhBskHZjL,kBAAkB,GAAGmO,eAAe,KAAKC,IAAI,SAASviB,EAAQU,EAAOJ,GACxE,YA0DA,SAASM,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASiB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCA1DhHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAGX,IAAIqB,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIzC,GAAI,EAAGA,EAAIyC,EAAMlC,OAAQP,IAAK,CAAE,GAAI0C,GAAaD,EAAMzC,EAAI0C,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAM9B,OAAOC,eAAewB,EAAQE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUX,EAAagB,EAAYC,GAAiJ,MAA9HD,IAAYR,EAAiBR,EAAYkB,UAAWF,GAAiBC,GAAaT,EAAiBR,EAAaiB,GAAqBjB,MiB5vHhiBwgB,EAAAxiB,EAAA,oBjBkyHIyiB,EAAmB7hB,EAAuB4hB,GiBjyH9Chd,EAAAxF,EAAA,YjBqyHIyF,EAAU7E,EAAuB4E,GiBpyHrCI,EAAA5F,EAAA,mBjBwyHI6F,EAAiBjF,EAAuBgF,GiBvyH5CvC,EAAArD,EAAA,ejB2yHIsD,EAAa1C,EAAuByC,GiBzyHlCqf,EjB+yHkB,WiB/qHpB,QAAAA,KAAc5gB,EAAAJ,KAAAghB,GACVhhB,KAAKihB,UACLjhB,KAAKwZ,mBAAqB,KAC1BxZ,KAAKkhB,cACLlhB,KAAKmhB,kBACLnhB,KAAKohB,gBAAkB,GAAAL,GAAAA,WACvB/gB,KAAKqF,cAAgBlB,EAAAA,WAAa/B,cAClCpC,KAAKsF,OAASvB,EAAAA,WAAM3B,cACpBpC,KAAKmC,UAAYP,EAAAA,WAASQ,cAC1BpC,KAAKyZ,aAAe,KACpBzZ,KAAKqhB,uBAAyBrhB,KAAKshB,eAAe/e,KAAKvC,MjBs3H3D,MAhNAa,GAAamgB,IACT3f,IAAK,mBAML7B,MAAO,SiBjzHO0gB,GACd,GAAIF,GAAA,MAEJ,IAA2B,IAAvBE,EAAYphB,OAIhB,IAAK,GAAIP,GAAI,EAAGA,EAAI2hB,EAAYphB,OAAQP,IAEpC,GADAyhB,EAAaE,EAAY3hB,GACrByhB,EAAWjZ,KAAOiZ,EAAWjZ,IAAIjI,OAAS,EAAG,CAC7CkB,KAAKsF,OAAOe,IAAI,0BAA4B2Z,EAAWjZ,IACvD,IAAIwa,GAAO,GAAI1R,eACf0R,GAAKvR,KAAK,MAAOgQ,EAAWjZ,KAAK,GACjCwa,EAAKlF,iBAAiB,eAAgB,mCACtCkF,EAAKrR,WjBszHb7O,IAAK,iBACL7B,MAAO,WiBhzHPQ,KAAKsF,OAAOe,IAAI,kBAGhBrG,KAAKwhB,gBAGLxhB,KAAKyhB,uBjBqzHLpgB,IAAK,iBACL7B,MAAO,WiBlzHFQ,KAAKohB,iBAGVphB,KAAKohB,gBAAgB7d,WjBszHrBlC,IAAK,kBACL7B,MAAO,WiBnzHFQ,KAAKohB,iBAGVphB,KAAKohB,gBAAgB9d,UjBuzHrBjC,IAAK,gBACL7B,MAAO,WiBpzHFQ,KAAKohB,kBAGVphB,KAAKmC,UAAUiB,oBAAoB,cAAepD,KAAKqhB,wBACvDrhB,KAAKohB,gBAAgBne,WjBwzHrB5B,IAAK,gBACL7B,MAAO,SiBtzHIkiB,GACX,GACIhD,GADAnE,EAAWva,KAAKihB,OAAOjhB,KAAKkhB,YAAY5Z,GAAGkY,OAAOW,UAAUuB,EAGhE1hB,MAAKmhB,eAAiBO,EACtB1hB,KAAKsF,OAAOe,IAAI,2BAA6BrG,KAAKmhB,gBAGlDzC,EAASnE,EAASmE,OAEdA,GACA1e,KAAKsF,OAAOe,IAAI,8BAAgCqY,EAAOhK,UACvD1U,KAAKmC,UAAUS,iBAAiB,cAAe5C,KAAKqhB,wBAC/CrhB,KAAKohB,gBAAgBre,KAAKwX,EAASmE,OAAQ1e,KAAKihB,OAAOjhB,KAAKkhB,YAAYza,UACzEzG,KAAKyhB,qBAGTzhB,KAAKyhB,uBjB0zHTpgB,IAAK,YACL7B,MAAO,SiBvzHAkiB,GACP,GAAIxb,GAAOlG,KAAKihB,OAAOS,GACnBpa,EAAKpB,EAAKoB,EAEH,QAAPA,IAKJtH,KAAKkhB,WAAaQ,EAClB1hB,KAAKsF,OAAOe,IAAI,uBAAyBrG,KAAKkhB,WAAa,aAAe5Z,EAAGa,IAG7EnI,KAAK2hB,iBAAiBra,EAAGkY,OAAOU,aAGhClgB,KAAK4hB,cAAc,OjB0zHnBvgB,IAAK,gBACL7B,MAAO,WiBtzHPQ,KAAKkhB,aAEDlhB,KAAKkhB,WAAalhB,KAAKihB,OAAOniB,OAC9BkB,KAAK6hB,UAAU7hB,KAAKkhB,YAGpBlhB,KAAKmC,UAAU4F,eACXvE,KAAM,aACN9C,ajB6zHRW,IAAK,oBACL7B,MAAO,WiBxzHP,GAAI8H,GAAKtH,KAAKihB,OAAOjhB,KAAKkhB,YAAY5Z,EAEtCtH,MAAKmhB,iBAEDnhB,KAAKmhB,eAAiB7Z,EAAGkY,OAAOW,UAAUrhB,OAC1CkB,KAAK4hB,cAAc5hB,KAAKmhB,gBAExBnhB,KAAK8hB,oBjB21HbjhB,EAAamgB,IACT3f,IAAK,OACL7B,MAAO,SiBj0HL6H,EAAOgU,EAAmBC,GAC5Btb,KAAKihB,OAAS5Z,EACdrH,KAAKwZ,mBAAqB6B,EAC1Brb,KAAKohB,gBAAgBze,KAAK3C,KAAKwZ,mBAAoB8B,MjBo0HnDja,IAAK,QACL7B,MAAO,WiBj0HFQ,KAAKihB,QAAiC,IAAvBjhB,KAAKihB,OAAOniB,SAKhCkB,KAAKmC,UAAU4F,eACXvE,KAAM,eACN9C,UAGJV,KAAK6hB,UAAU,OjBq0HfxgB,IAAK,OACL7B,MAAO,WiBl0HPQ,KAAK+hB,qBjBs0HL1gB,IAAK,QACL7B,MAAO,WiBn0HPQ,KAAKgiB,oBjBu0HL3gB,IAAK,OACL7B,MAAO,WiBp0HPQ,KAAKwhB,mBjBw0HLngB,IAAK,QACL7B,MAAO,WiBr0HPQ,KAAKohB,gBAAgBle,YjB00HlB8d,IAGXpiB,GAAAA,WiBz0HeoiB,IjB20HZlK,WAAW,EAAEmL,kBAAkB,EAAExG,cAAc,EAAEyG,mBAAmB,KAAKC,IAAI,SAAS7jB,EAAQU,EAAOJ,GACxG,YAMA,SAASwB,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAJhHjB,OAAOC,eAAeX,EAAS,cAC3BY,OAAO,GAsCX,IkBxjIMihB,GACF,QAAAA,KAAergB,EAAAJ,KAAAygB,GACXzgB,KAAK0gB,QAAU,GACf1gB,KAAKsH,GAAK,MAQZiZ,EACF,QAAAA,KAAengB,EAAAJ,KAAAugB,GACXvgB,KAAKmI,GAAK,GACVnI,KAAKwf,OAAS,KACdxf,KAAKoiB,QAAU,MAQjB3C,EACF,QAAAA,KAAerf,EAAAJ,KAAAyf,GACXzf,KAAK6f,SAAW,GAChB7f,KAAK8f,QAAU,GACf9f,KAAK8R,YAAc,GACnB9R,KAAK+f,OAAS,GACd/f,KAAK0G,MAAQ,GACb1G,KAAKkgB,eACLlgB,KAAKmgB,aACLngB,KAAKqiB,eAQPpC,EACF,QAAAA,KAAe7f,EAAAJ,KAAAigB,GACXjgB,KAAK+G,IAAM,GACX/G,KAAKmI,GAAK,IAQZma,EACF,QAAAA,KAAeliB,EAAAJ,KAAAsiB,GACXtiB,KAAK+G,IAAM,GACX/G,KAAKuiB,MAAQ,IAQfpD,EACF,QAAAA,KAAe/e,EAAAJ,KAAAmf,GACXnf,KAAKmI,GAAK,GACVnI,KAAKof,KAAO,GACZpf,KAAKqf,SAAW,EAChBrf,KAAK0e,OAAS,KACd1e,KAAKwiB,gBACLxiB,KAAKyiB,gBAKbtD,GAASjL,MACLwO,OAAQ,SACRC,eAAgB,eAChBC,cAAgB,elB4kIpB,IkBrkIMjE,GACF,QAAAA,KAAeve,EAAAJ,KAAA2e,GACX3e,KAAK0U,SAAW,EAChB1U,KAAK2a,kBACL3a,KAAK8e,aAAe,GACpB9e,KAAKqa,YAAc,KACnBra,KAAKoW,eAQPyM,EACF,QAAAA,KAAeziB,EAAAJ,KAAA6iB,GACX7iB,KAAKmI,GAAK,GACVnI,KAAKoe,MAAQ,EACbpe,KAAKqe,OAAS,EACdre,KAAK8iB,eAAiB,KACtB9iB,KAAK+iB,eAAiB,GACtB/iB,KAAKgjB,aAAe,GACpBhjB,KAAK2a,kBACL3a,KAAKsa,aAAe,GACpBta,KAAKijB,QAAU,GACfjjB,KAAK8e,aAAe,IAYtBoE,EACF,QAAAA,KAAe9iB,EAAAJ,KAAAkjB,GACXljB,KAAKmI,GAAK,GACVnI,KAAKoe,MAAQ,EACbpe,KAAKqe,OAAS,EACdre,KAAKmjB,cAAgB,EACrBnjB,KAAKojB,eAAkB,EACvBpjB,KAAKse,UAAW,EAChBte,KAAKue,qBAAsB,EAC3Bve,KAAKwe,aAAe,GACpBxe,KAAK8iB,eAAiB,KACtB9iB,KAAKgjB,aAAe,GACpBhjB,KAAK2a,kBACL3a,KAAKsa,aAAe,GACpBta,KAAK8e,aAAe,IAQtBlB,EACF,QAAAA,KAAexd,EAAAJ,KAAA4d,GACX5d,KAAK+G,IAAM,GACX/G,KAAK0c,MAAQ,GASrBkB,GAAc1J,MACVmP,aAAa,eACbC,MAAM,QACNC,SAAU,WACVC,cAAe,gBACfC,cAAe,gBACfC,SAAU,WACVC,KAAM,OACNC,OAAQ,SACRC,MAAO,QACPC,OAAQ,SACRC,OAAQ,SACRC,WAAY,aACZC,OAAQ,SACRC,SAAU,WACVC,iBAAkB,mBAClBC,MAAO,QlBolIX,IkB7kIMtG,GACF,QAAAA,KAAe1d,EAAAJ,KAAA8d,GACX9d,KAAKsa,aAAe,GACpBta,KAAK+d,cAAgB,GACrB/d,KAAKge,YAAc,IAQrBE,EACF,QAAAA,KAAe9d,EAAAJ,KAAAke,GACXle,KAAKmI,GAAK,GACVnI,KAAKme,SAAW,GAChBne,KAAKwD,KAAO,GACZxD,KAAKyX,QAAU,EACfzX,KAAKoe,MAAQ,EACbpe,KAAKqe,OAAS,EACdre,KAAKse,UAAW,EAChBte,KAAKue,qBAAsB,EAC3Bve,KAAKwe,aAAe,GACpBxe,KAAK+G,IAAM,GAKnBmX,GAAUmG,UACNC,UAAW,YACXC,YAAa,elBylIjB,IkBllIMC,GACF,QAAAA,KAAepkB,EAAAJ,KAAAwkB,GACXxkB,KAAKykB,IAAM,GACXzkB,KAAK0kB,aAAe,IAKxBxe,IAEJA,GAAKua,KAAOA,EACZva,EAAKqa,GAAKA,EACVra,EAAKuZ,OAASA,EACdvZ,EAAK+Z,WAAaA,EAClB/Z,EAAKoc,WAAaA,EAClBpc,EAAKiZ,SAAWA,EAChBjZ,EAAKyY,OAASA,EACdzY,EAAK2c,UAAYA,EACjB3c,EAAKgd,UAAYA,EACjBhd,EAAK0X,cAAgBA,EACrB1X,EAAK4X,YAAcA,EACnB5X,EAAKgY,UAAYA,EACjBhY,EAAKse,eAAiBA,ElBmlItB5lB,EAAAA,WkBjlIesH,ElBklIftH,EkBhlIS6hB,KAAAA,ElBilIT7hB,EkBjlIe2hB,GAAAA,ElBklIf3hB,EkBllImB6gB,OAAAA,ElBmlInB7gB,EkBnlI2BqhB,WAAAA,ElBolI3BrhB,EkBplIuC0jB,WAAAA,ElBqlIvC1jB,EkBrlImDugB,SAAAA,ElBslInDvgB,EkBtlI6D+f,OAAAA,ElBulI7D/f,EkBvlIqEikB,UAAAA,ElBwlIrEjkB,EkBxlIgFskB,UAAAA,ElBylIhFtkB,EkBzlI2Fgf,cAAAA,ElB0lI3Fhf,EkB1lI0Gkf,YAAAA,ElB2lI1Glf,EkB3lIuHsf,UAAAA,ElB4lIvHtf,EkB5lIkI4lB,eAAAA,YlB8lIvH","file":"adsplayer.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function (global){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.AdsPlayer = undefined;\n\nvar _AdsPlayer = require('./src/AdsPlayer');\n\nvar _AdsPlayer2 = _interopRequireDefault(_AdsPlayer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Shove both of these into the global scope\nvar context = typeof window !== 'undefined' && window || global;\n\nvar adsplayer = context.adsplayer;\nif (!adsplayer) {\n    adsplayer = context.adsplayer = {};\n}\n\nadsplayer.AdsPlayer = _AdsPlayer2.default;\n\nexports.default = adsplayer;\nexports.AdsPlayer = _AdsPlayer2.default;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{\"./src/AdsPlayer\":2}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* AdsPlayer.\n* @constructor AdsPlayer\n* @param {Object} adsPlayerContainer - the DOM container in which &lt;video&gt; and &lt;img&gt; HTML components will be appended\n*/\n\nvar _AdsPlayerController = require('./AdsPlayerController');\n\nvar _AdsPlayerController2 = _interopRequireDefault(_AdsPlayerController);\n\nvar _EventBus = require('./EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar NAME = 'AdsPlayer';\nvar VERSION = '1.0.0';\nvar GIT_TAG = '62ff64f';\nvar BUILD_DATE = '2016-11-28_10:26:5';\n\n///////////////////////////////////////////////////////////////////////////////////////////////\n////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\nfunction _onError(e) {\n    this._error = e.data;\n}\n\nfunction _onWarning(e) {\n    this._warning = e.data;\n}\n\nvar AdsPlayer = function () {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    function AdsPlayer(adsPlayerContainer) {\n        _classCallCheck(this, AdsPlayer);\n\n        this._adsPlayerContainer = adsPlayerContainer;\n        this._error = null;\n        this._warning = null;\n        this._eventBus = _EventBus2.default.getInstance();\n        this._adsPlayerController = null;\n\n        this.onErrorListener = _onError.bind(this);\n        this.onWarningListener = _onWarning.bind(this);\n    }\n\n    // Plugin API\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * Returns the plugin name.\n    * @method getName\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {string} the plugin name\n    */\n\n\n    _createClass(AdsPlayer, [{\n        key: 'getName',\n        value: function getName() {\n            return NAME;\n        }\n\n        /**\n        * [Plugin API, invoked by hasplayer.js]\n        * Initializes the plugin.\n        * @method init\n        * @access public\n        * @memberof AdsPlayer#\n        * @param {Object} player - the MediaPlayer\n        * @param {function} callback - the callback function to invoke when initialization is done\n        */\n\n    }, {\n        key: 'init',\n        value: function init(player, callback) {\n            this._adsPlayerController = new _AdsPlayerController2.default();\n            this._adsPlayerController.init(player, this._adsPlayerContainer);\n            this._eventBus.addEventListener('error', this.onErrorListener);\n            this._eventBus.addEventListener('warning', this.onWarningListener);\n\n            callback();\n        }\n\n        /**\n        * [Plugin API, invoked by hasplayer.js]\n        * This method is invoked when a new stream is to be loaded/opened.\n        * @method load\n        * @access public\n        * @memberof AdsPlayer#\n        * @param {object} stream - the stream contaning all stream informations (url, protData, adsUrl)\n        */\n\n    }, {\n        key: 'load',\n        value: function load(stream, callback) {\n            if (stream.adsUrl) {\n                this._adsPlayerController.load(stream.adsUrl).then(function () {\n                    callback();\n                }).catch(function () {\n                    callback();\n                });\n            } else {\n                callback();\n            }\n        }\n\n        /**\n        * [Plugin API, invoked by hasplayer.js]\n        * This method is invoked when the current stream is to be stopped.\n        * @method stop\n        * @access public\n        * @memberof AdsPlayer#\n        */\n\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._adsPlayerController.stop();\n        }\n\n        /**\n        * [Plugin API, invoked by hasplayer.js]\n        * This method is invoked when the player is to be reset.\n        * @method reset\n        * @access public\n        * @memberof AdsPlayer#\n        */\n\n    }, {\n        key: 'reset',\n        value: function reset() {\n            this._adsPlayerController.reset();\n        }\n\n        /**\n        * [Plugin API, invoked by hasplayer.js]\n        * This method is invoked when this plugin is being removed/destroyed.\n        * @method destroy\n        * @access public\n        * @memberof AdsPlayer#\n        */\n\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n            this._adsPlayerController.destroy();\n            this._eventBus.removeEventListener('error', this.onErrorListener);\n            this._eventBus.removeEventListener('warning', this.onWarningListener);\n        }\n\n        // AdsPlayer additionnal API\n\n        /**\n        * Returns the plugin version.\n        * @method getVersion\n        * @access public\n        * @memberof AdsPlayer#\n        * @return {string} the plugin version\n        */\n\n    }, {\n        key: 'getVersion',\n        value: function getVersion() {\n            return VERSION;\n        }\n\n        /**\n        * Returns the full plugin version, including git revision\n        * @access public\n        * @memberof AdsPlayer#\n        * @return {string} the full plugin version, including git revision\n        */\n\n    }, {\n        key: 'getVersionFull',\n        value: function getVersionFull() {\n            if (GIT_TAG.indexOf(\"@@\") === -1) {\n                return VERSION + '_' + GIT_TAG;\n            } else {\n                return VERSION;\n            }\n        }\n\n        /**\n        * Returns the build date.\n        * @method getBuildDate\n        * @access public\n        * @memberof AdsPlayer#\n        * @return {string} the build date\n        */\n\n    }, {\n        key: 'getBuildDate',\n        value: function getBuildDate() {\n            if (BUILD_DATE.indexOf(\"@@\") === -1) {\n                return BUILD_DATE;\n            } else {\n                return 'Not a builded version';\n            }\n        }\n\n        /**\n        * Plays/resumes the playback of the current ad.\n        * @method pause\n        * @access public\n        * @memberof AdsPlayer#\n        */\n\n    }, {\n        key: 'play',\n        value: function play() {\n            this._adsPlayerController.play();\n        }\n\n        /**\n        * Pauses the playback of the current ad.\n        * @method pause\n        * @access public\n        * @memberof AdsPlayer#\n        */\n\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._adsPlayerController.pause();\n        }\n\n        /**\n        * Registers a listener on the specified event.\n        * The possible event types are:\n        * <li>'error' (see [error]{@link AdsPlayer#event:error} event specification)\n        * <li>'warning' (see [warning]{@link AdsPlayer#event:warning} event specification)\n        * <li>'start' (see [start]{@link AdsPlayer#event:start} event specification)\n        * <li>'end' (see [end]{@link AdsPlayer#event:end} event specification)\n        * <li>'click' (see [click]{@link AdsPlayer#event:click} event specification)\n        * @method addEventListener\n        * @access public\n        * @memberof AdsPlayer#\n        * @param {string} type - the event type for listen to\n        * @param {callback} listener - the callback which is called when an event of the specified type occurs\n        * @param {boolean} useCapture - see HTML DOM addEventListener() method specification\n        */\n\n    }, {\n        key: 'addEventListener',\n        value: function addEventListener(type, listener, useCapture) {\n            this._eventBus.addEventListener(type, listener, useCapture);\n        }\n\n        /**\n        * Unregisters the listener previously registered with the addEventListener() method.\n        * @method removeEventListener\n        * @access public\n        * @memberof AdsPlayer#\n        * @see [addEventListener]{@link AdsPlayer#addEventListener}\n        * @param {string} type - the event type on which the listener was registered\n        * @param {callback} listener - the callback which was registered to the event type\n        */\n\n    }, {\n        key: 'removeEventListener',\n        value: function removeEventListener(type, listener) {\n            this._eventBus.removeEventListener(type, listener);\n        }\n\n        /**\n        * Returns the Error object for the most recent error.\n        * @access public\n        * @memberof AdsPlayer#\n        * @return {object} the Error object for the most recent error, or null if there has not been an error\n        */\n\n    }, {\n        key: 'getError',\n        value: function getError() {\n            return this._error;\n        }\n\n        /**\n        * Returns the Warning object for the most recent warning.\n        * @access public\n        * @memberof AdsPlayer#\n        * @return {object} the Warning object for the most recent warning, or null if there has not been a warning\n        */\n\n    }, {\n        key: 'getWarning',\n        value: function getWarning() {\n            return this._warning;\n        }\n    }]);\n\n    return AdsPlayer;\n}();\n\n// /**\n//  * @class\n//  * @classdesc AdsPlayer\n//  */\n// AdsPlayer.prototype = {\n//     constructor: AdsPlayer\n// };\n\n// AdsPlayer.mast = {};\n// AdsPlayer.mast.model = {};\n// AdsPlayer.mast.model.Trigger = {};\n// AdsPlayer.mast.model.Trigger.Condition = {};\n// AdsPlayer.vast = {};\n// AdsPlayer.vast.model = {};\n// AdsPlayer.vast.model.Vast = {};\n// AdsPlayer.media = {};\n// AdsPlayer.utils = {};\n\n\n/////////// EVENTS\n\n/**\n* The 'start' event is fired when the playback of ad(s) is starting.\n* When the 'start' event is fired, the application shall hide the main player component and\n* display the ads player container in which the ad media player component(s) will be created\n* and displayed.\n*\n* @event AdsPlayer#start\n* @param {object} event - the event\n* @param {object} event.type - the event type ('start')\n*/\n\n/**\n* The 'end' event is fired when the playback of ad(s) has ended.\n* When the 'end' event is fired, the application shall display the main player component and\n* hide the ads player container.\n*\n* @event AdsPlayer#end\n* @param {object} event - the event\n* @param {object} event.type - the event type ('end')\n*/\n\n/**\n* The 'addElement' event is fired when a DOM element for playing an ad has been created\n* and will be appended in the ads player container.\n* The element can be either a &lt;video&gt; or an &lt;img&gt; element.\n*\n* @event AdsPlayer#addElement\n* @param {object} event - the event\n* @param {object} event.type - the event type ('addElement')\n* @param {object} event.data - the event data\n* @param {string} event.data.element - the created element\n* @param {string} event.data.type - the type of the element, 'video' for &lt;video&gt; or 'image' for &lt;img&gt;\n*/\n\n/**\n* The 'removeElement' event is fired when the DOM element for playing an ad is being removed\n* from the ads player container and deleted.\n*\n* @event AdsPlayer#removeElement\n* @param {object} event - the event\n* @param {object} event.type - the event type ('removeElement')\n* @param {object} event.data - the event data\n* @param {string} event.data.element - the created element\n* @param {string} event.data.type - the type of the element, 'video' for &lt;video&gt; or 'image' for &lt;img&gt;\n*/\n\n/**\n* The 'play' event is fired when the playback of media ad is starting.\n*\n* @event AdsPlayer#play\n* @param {object} event - the event\n* @param {object} event.type - the event type ('play')\n*/\n\n/**\n* The 'pause' event is fired when the playback of an ad is paused.\n*\n* @event AdsPlayer#pause\n* @param {object} event - the event\n* @param {object} event.type - the event type ('pause')\n*/\n\n/**\n* The 'click' event is fired when a click has been performed on the ad component.\n* When the 'click' event is fired, the application shall open the web page with the provided URI.\n*\n* @event AdsPlayer#click\n* @param {object} event - the event\n* @param {object} event.type - the event type ('click')\n* @param {object} event.data - the event data\n* @param {string} event.data.uri - the web page uri\n*/\n\n/**\n* The error event is fired when an error occurs.\n* When the error event is fired, the application shall stop the player.\n*\n* @event AdsPlayer#error\n* @param {object} event - the event\n* @param {object} event.type - the event type ('error')\n* @param {object} event.data - the event data\n* @param {string} event.data.code - error code\n* @param {string} event.data.message - error message\n* @param {object} event.data.data - error additionnal data\n*/\n\n/**\n* The warning event is fired when a warning occurs.\n*\n* @event AdsPlayer#warning\n* @param {object} event - the event\n* @param {object} event.type - the event type ('warning')\n* @param {object} event.data - the event data\n* @param {string} event.data.code - warning code\n* @param {string} event.data.message - warning message\n* @param {object} event.data.data - warning additionnal data\n*/\n\nexports.default = AdsPlayer;\n\n},{\"./AdsPlayerController\":3,\"./EventBus\":6}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* AdsPlayerController is th main controller class for AdsPlayer module.\n* It is in charge of downloading the MAST/VAST files and orchestrates the\n* detection of triggers and playing of ad(s).\n*/\n\nvar _Debug = require('./Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _FileLoader = require('./FileLoader');\n\nvar _FileLoader2 = _interopRequireDefault(_FileLoader);\n\nvar _ErrorHandler = require('./ErrorHandler');\n\nvar _ErrorHandler2 = _interopRequireDefault(_ErrorHandler);\n\nvar _EventBus = require('./EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nvar _MastParser = require('./mast/MastParser');\n\nvar _MastParser2 = _interopRequireDefault(_MastParser);\n\nvar _TriggerManager = require('./mast/TriggerManager');\n\nvar _TriggerManager2 = _interopRequireDefault(_TriggerManager);\n\nvar _VastParser = require('./vast/VastParser');\n\nvar _VastParser2 = _interopRequireDefault(_VastParser);\n\nvar _VastPlayerManager = require('./vast/VastPlayerManager');\n\nvar _VastPlayerManager2 = _interopRequireDefault(_VastPlayerManager);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar AdsPlayerController = function () {\n    _createClass(AdsPlayerController, [{\n        key: '_loadVast',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _loadVast(url) {\n            var _this = this;\n\n            var fileLoader = new _FileLoader2.default(),\n                vast = null;\n\n            return new Promise(function (resolve /*, reject*/) {\n                _this._debug.log(\"Download VAST file: \" + url);\n                fileLoader.load(url).then(function (result) {\n                    _this._debug.log(\"Parse VAST file\");\n                    vast = _this._vastParser.parse(result.response);\n                    vast.baseUrl = result.baseUrl;\n                    resolve(vast);\n                }).catch(function (error) {\n                    if (error) {\n                        _this._errorHandler.sendWarning(_ErrorHandler2.default.LOAD_VAST_FAILED, \"Failed to load VAST file\", error);\n                    }\n                    resolve(null);\n                });\n                _this._fileLoaders.push(fileLoader);\n            });\n        }\n    }, {\n        key: '_loadTriggerVasts',\n        value: function _loadTriggerVasts(trigger) {\n            var loadVastPromises = [],\n                i,\n                uri;\n\n            for (i = 0; i < trigger.sources.length; i++) {\n                uri = trigger.sources[i].uri;\n                // Check for relative uri path\n                if (uri.indexOf('http://') === -1) {\n                    uri = this._mast.baseUrl + uri;\n                }\n                loadVastPromises.push(this._loadVast(uri));\n            }\n\n            return new Promise(function (resolve, reject) {\n                Promise.all(loadVastPromises).then(function (vasts) {\n                    // Push vast objects in the trigger in the original order\n                    // (this = promises returned objects)\n                    for (var i = 0; i < vasts.length; i++) {\n                        if (vasts[i] && vasts[i].ad) {\n                            trigger.vasts.push(vasts[i]);\n                        }\n                    }\n                    resolve();\n                }).catch(function () {\n                    reject();\n                });\n            });\n        }\n    }, {\n        key: '_parseMastFile',\n        value: function _parseMastFile(mastContent, mastBaseUrl) {\n            var triggerManager, i;\n\n            // Parse the MAST file\n            this._mast = this._mastParser.parse(mastContent);\n\n            if (!this._mast) {\n                return;\n            }\n\n            // Store base URL for subsequent VATS files download\n            this._mast.baseUrl = mastBaseUrl;\n\n            // Initialize the trigger managers\n            for (i = 0; i < this._mast.triggers.length; i++) {\n                triggerManager = new _TriggerManager2.default();\n                triggerManager.init(this._mast.triggers[i]);\n                this._triggerManagers.push(triggerManager);\n            }\n        }\n    }, {\n        key: '_onVideoPlaying',\n        value: function _onVideoPlaying() {\n            if (this._vastPlayerManager) {\n                this._debug.log(\"Pause main video\");\n                this._mainVideo.pause();\n            }\n        }\n    }, {\n        key: '_onVideoTimeupdate',\n        value: function _onVideoTimeupdate() {\n            var trigger = this._checkTriggersStart();\n            if (trigger !== null) {\n                this._activateTrigger(trigger);\n            }\n        }\n    }, {\n        key: '_onVideoEnded',\n        value: function _onVideoEnded() {\n            // Check for end-roll triggers\n            var trigger = this._checkTriggersStart();\n            if (trigger !== null) {\n                this._activateTrigger(trigger);\n            }\n\n            this._checkTriggersEnd();\n        }\n    }, {\n        key: '_pauseVideo',\n        value: function _pauseVideo() {\n            if (!this._mainVideo.paused) {\n                this._debug.log(\"Pause main video\");\n                this._mainVideo.pause();\n            }\n        }\n    }, {\n        key: '_resumeVideo',\n        value: function _resumeVideo() {\n            if (this._mainVideo.paused) {\n                this._debug.log(\"Resume main video\");\n                this._mainVideo.play();\n            }\n        }\n    }, {\n        key: '_onTriggerEnd',\n        value: function _onTriggerEnd() {\n            this._debug.log('End playing trigger');\n\n            // Delete VAST player manager\n            if (this._vastPlayerManager) {\n                this._vastPlayerManager.reset();\n                this._vastPlayerManager = null;\n            }\n\n            // Check if another trigger has to be activated\n            var trigger = this._checkTriggersStart();\n            if (trigger !== null) {\n                this._activateTrigger(trigger);\n            } else {\n                // Notifies the application ad(s) playback has ended\n                this._eventBus.dispatchEvent({ type: 'end', data: null });\n\n                if (!this._mainVideo.ended) {\n                    // Resume the main video element\n                    this._resumeVideo();\n                }\n            }\n        }\n    }, {\n        key: '_playTrigger',\n        value: function _playTrigger(trigger) {\n            if (trigger.vasts.length === 0) {\n                return;\n            }\n\n            // Pause the main video element\n            this._pauseVideo();\n\n            // Notifies the application ad(s) playback starts\n            this._eventBus.dispatchEvent({ type: 'start', data: null });\n\n            // Play the trigger\n            this._debug.log('Start playing trigger ' + trigger.id);\n            this._vastPlayerManager = new _VastPlayerManager2.default();\n            this._vastPlayerManager.init(trigger.vasts, this._adsPlayerContainer, this._mainVideo);\n            this._vastPlayerManager.start();\n        }\n    }, {\n        key: '_activateTrigger',\n        value: function _activateTrigger(trigger) {\n            var _this2 = this;\n\n            // Check if a trigger is not already activated\n            if (this._vastPlayerManager) {\n                return;\n            }\n\n            this._debug.log('Activate trigger ' + trigger.id);\n\n            trigger.activated = true;\n\n            if (trigger.vasts.length === 0) {\n                // Download VAST files\n                this._loadTriggerVasts(trigger).then(function () {\n                    _this2._playTrigger(trigger);\n                });\n            } else {\n                this._playTrigger(trigger);\n            }\n        }\n    }, {\n        key: '_checkTriggersStart',\n        value: function _checkTriggersStart() {\n            for (var i = 0; i < this._triggerManagers.length; i++) {\n                if (this._triggerManagers[i].checkStartConditions(this._mainVideo)) {\n                    return this._triggerManagers[i].getTrigger();\n                }\n            }\n            return null;\n        }\n    }, {\n        key: '_checkTriggersEnd',\n        value: function _checkTriggersEnd() {\n            for (var i = 0; i < this._triggerManagers.length; i++) {\n                if (this._triggerManagers[i].checkEndConditions(this._mainVideo)) {\n                    // Remove trigger manager => will not be activated anymore\n                    this._triggerManagers.splice(0, 1);\n                    i--;\n                }\n            }\n        }\n    }, {\n        key: '_start',\n        value: function _start() {\n            if (!this._mast) {\n                return;\n            }\n\n            if (this._mast.triggers.length === 0) {\n                this._debug.warn('No trigger in MAST');\n            }\n\n            // Check for pre-roll trigger\n            var trigger = this._checkTriggersStart();\n            if (trigger !== null) {\n                this._activateTrigger(trigger);\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function AdsPlayerController() {\n        _classCallCheck(this, AdsPlayerController);\n\n        this._mainPlayer = null;\n        this._mainVideo = null;\n        this._adsPlayerContainer = null;\n        this._mast = null;\n        this._fileLoaders = [];\n        this._triggerManagers = [];\n        this._vastPlayerManager = null;\n        this._mastParser = new _MastParser2.default();\n        this._vastParser = new _VastParser2.default();\n        this._errorHandler = _ErrorHandler2.default.getInstance();\n        this._debug = _Debug2.default.getInstance();\n        this._eventBus = _EventBus2.default.getInstance();\n\n        this._onVideoPlayingListener = this._onVideoPlaying.bind(this);\n        this._onVideoTimeupdateListener = this._onVideoTimeupdate.bind(this);\n        this._onVideoEndedListener = this._onVideoEnded.bind(this);\n        this._onTriggerEndListener = this._onTriggerEnd.bind(this);\n    }\n\n    /**\n     * Initialize the Ads Player Controller.\n     * @method init\n     * @access public\n     * @memberof AdsPlayerController#\n     * @param {Object} mainVideo - the HTML5 video element used by the main media player\n     * @param {Object} adsPlayerContainer - The container to create the HTML5 video/image elements used to play and render the ads media\n     */\n\n\n    _createClass(AdsPlayerController, [{\n        key: 'init',\n        value: function init(player, adsPlayerContainer) {\n            this._mainPlayer = player;\n            this._mainVideo = player.getVideoModel().getElement();\n            this._adsPlayerContainer = adsPlayerContainer;\n\n            // Add <video> event listener\n            this._mainVideo.addEventListener('playing', this._onVideoPlayingListener);\n            this._mainVideo.addEventListener('timeupdate', this._onVideoTimeupdateListener);\n            this._mainVideo.addEventListener('seeking', this._onVideoTimeupdateListener);\n            this._mainVideo.addEventListener('ended', this._onVideoEndedListener);\n\n            // Add trigger end event listener\n            this._eventBus.addEventListener('triggerEnd', this._onTriggerEndListener);\n\n            this._debug.setLevel(4);\n        }\n\n        /**\n         * Load/open a MAST file.\n         * @method load\n         * @access public\n         * @memberof AdsPlayerController#\n         * @param {string} mastUrl - the MAST file url\n         */\n\n    }, {\n        key: 'load',\n        value: function load(url) {\n            var _this3 = this;\n\n            var fileLoader = new _FileLoader2.default();\n\n            // Reset the MAST and trigger managers\n            this._mast = null;\n            this._triggerManagers = [];\n\n            // Download and parse MAST file\n            this._debug.log(\"Download MAST file: \" + url);\n\n            return new Promise(function (resolve, reject) {\n                fileLoader.load(url).then(function (result) {\n                    _this3._debug.log(\"Parse MAST file\");\n                    _this3._parseMastFile(result.response, result.baseUrl);\n                    // Start managing triggers and ads playing\n                    _this3._debug.log(\"Start\");\n                    _this3._start();\n                    resolve();\n                }).catch(function (error) {\n                    if (error) {\n                        _this3._errorHandler.sendError(error.name, error.message, error.data);\n                        reject(error);\n                    } else {\n                        resolve();\n                    }\n                });\n                _this3._fileLoaders.push(fileLoader);\n            });\n        }\n\n        /**\n         * Stops and resets the Ads player.\n         * @method reset\n         * @access public\n         * @memberof AdsPlayerController#\n         */\n\n    }, {\n        key: 'stop',\n        value: function stop() {\n\n            this._debug.log(\"Stop\");\n\n            // Stop/abort the file loaders\n            for (var i = 0; i < this._fileLoaders.length; i++) {\n                this._fileLoaders[i].abort();\n            }\n            this._fileLoaders = [];\n\n            // Stop the ad player\n            if (this._vastPlayerManager) {\n                this._vastPlayerManager.stop();\n                this._vastPlayerManager.reset();\n                this._vastPlayerManager = null;\n\n                // Notifies the application ad(s) playback has ended\n                this._eventBus.dispatchEvent({ type: 'end', data: null });\n            }\n        }\n    }, {\n        key: 'reset',\n        value: function reset() {\n\n            this._debug.log(\"Reset\");\n\n            this.stop();\n\n            // Reset the trigger managers\n            this._triggerManagers = [];\n\n            // Reset the MAST\n            this._mast = null;\n        }\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n\n            this._debug.log(\"Destroy\");\n\n            this.reset();\n\n            // Remove <video> event listener\n            this._mainVideo.removeEventListener('playing', this._onVideoPlayingListener);\n            this._mainVideo.removeEventListener('timeupdate', this._onVideoTimeupdateListener);\n            this._mainVideo.removeEventListener('seeking', this._onVideoTimeupdateListener);\n            this._mainVideo.removeEventListener('ended', this._onVideoEndedListener);\n\n            // Remove trigger end event listener\n            this._eventBus.removeEventListener('triggerEnd', this._onTriggerEndListener);\n        }\n\n        /**\n         * Plays/resumes the playback of the current ad.\n         * @method reset\n         * @access public\n         * @memberof AdsPlayerController#\n         */\n\n    }, {\n        key: 'play',\n        value: function play() {\n\n            this._debug.log(\"Play\");\n            // Play the ad player\n            if (this._vastPlayerManager) {\n                this._vastPlayerManager.play();\n            }\n        }\n\n        /**\n         * Pauses the playback of the current ad.\n         * @method reset\n         * @access public\n         * @memberof AdsPlayerController#\n         */\n\n    }, {\n        key: 'pause',\n        value: function pause() {\n\n            this._debug.log(\"Pause\");\n            // Stop the ad player\n            if (this._vastPlayerManager) {\n                this._vastPlayerManager.pause();\n            }\n        }\n    }]);\n\n    return AdsPlayerController;\n}();\n\nexports.default = AdsPlayerController;\n\n},{\"./Debug\":4,\"./ErrorHandler\":5,\"./EventBus\":6,\"./FileLoader\":7,\"./mast/MastParser\":8,\"./mast/TriggerManager\":9,\"./vast/VastParser\":16,\"./vast/VastPlayerManager\":17}],4:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* Debug utility class.\n*/\nDate.prototype.HHMMSSmmm = function () {\n\n    var h = this.getHours().toString(),\n        m = this.getMinutes().toString(),\n        s = this.getSeconds().toString(),\n        ms = this.getMilliseconds().toString(),\n        HH = h[1] ? h : \"0\" + h[0],\n        MM = m[1] ? m : \"0\" + m[0],\n        SS = s[1] ? s : \"0\" + s[0],\n        mmm = ms[2] ? ms : \"0\" + (ms[1] ? ms : \"0\" + ms[0]);\n\n    return HH + \":\" + MM + \":\" + SS + \".\" + mmm;\n};\n\nDate.prototype.MMSSmmm = function () {\n\n    var m = this.getMinutes().toString(),\n        s = this.getSeconds().toString(),\n        ms = this.getMilliseconds().toString(),\n        MM = m[1] ? m : \"0\" + m[0],\n        SS = s[1] ? s : \"0\" + s[0],\n        mmm = ms[2] ? ms : \"0\" + (ms[1] ? ms : \"0\" + ms[0]);\n\n    return MM + \":\" + SS + \".\" + mmm;\n};\n\n// MemoryLogger definition\n\nvar MemoryLogger = function MemoryLogger() {\n    // array to store logs\n    this.logArray = [];\n    // boolean to set leve in message\n    this.showLevel = true;\n};\n\nMemoryLogger.prototype.error = MemoryLogger.prototype.warn = MemoryLogger.prototype.info = MemoryLogger.prototype.debug = function (message) {\n    this.logArray.push(message);\n};\n\nMemoryLogger.prototype.getLogs = function () {\n    return this.logArray;\n};\n\nvar NONE = 0;\nvar ERROR = 1;\nvar WARN = 2;\nvar INFO = 3;\nvar DEBUG = 4;\nvar ALL = 4;\n\nvar _instance = null;\n\nvar Debug = function () {\n    _createClass(Debug, [{\n        key: \"_getStringLevel\",\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _getStringLevel(level) {\n            switch (level) {\n                case NONE:\n                    return \"\";\n                case ERROR:\n                    return \"ERROR\";\n                case WARN:\n                    return \"WARN\";\n                case INFO:\n                    return \"INFO\";\n                case DEBUG:\n                case ALL:\n                    return \"DEBUG\";\n                default:\n                    return \"\";\n            }\n        }\n    }, {\n        key: \"_prepareLog\",\n        value: function _prepareLog(logLevel, args) {\n            var message = \"\",\n                logTime = null;\n\n            if (this.showTimestamp) {\n                logTime = new Date();\n                message += \"[\" + logTime.HHMMSSmmm() + \"]\";\n            }\n\n            if (this._logger && this._logger.showLevel) {\n                message += \"[\" + this._getStringLevel(logLevel) + \"]\";\n            }\n\n            if (this.showElapsedTime) {\n                message += \"[\" + new Date(logTime - this._startTime).MMSSmmm() + \"]\";\n            }\n\n            message += \"[AdsPlayer] \";\n\n            Array.apply(null, args).forEach(function (item) {\n                message += item + \" \";\n            });\n\n            return message;\n        }\n    }, {\n        key: \"_log\",\n        value: function _log(logLevel, args) {\n            if (logLevel <= this.getLevel()) {\n\n                var message = this._prepareLog(logLevel, args);\n\n                switch (logLevel) {\n                    case ERROR:\n                        this._logger.error(message);\n                        break;\n                    case WARN:\n                        this._logger.warn(message);\n                        break;\n                    case INFO:\n                        this._logger.info(message);\n                        break;\n                    case DEBUG:\n                        this._logger.debug(message);\n                        break;\n                }\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }], [{\n        key: \"getInstance\",\n        value: function getInstance() {\n            if (_instance === null) {\n                _instance = new Debug();\n            }\n\n            return _instance;\n        }\n    }]);\n\n    function Debug() {\n        _classCallCheck(this, Debug);\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._level = 4;\n        this._showTimestamp = true;\n        this._showElapsedTime = false;\n        this._startTime = new Date();\n        this._logger = console;\n\n        _instance = this;\n        return _instance;\n    }\n\n    _createClass(Debug, [{\n        key: \"getLevel\",\n        value: function getLevel() {\n            return this._level;\n        }\n    }, {\n        key: \"setLevel\",\n        value: function setLevel(value) {\n            this._level = value;\n        }\n    }, {\n        key: \"getLogger\",\n        value: function getLogger() {\n            return this._logger;\n        }\n    }, {\n        key: \"setLogger\",\n        value: function setLogger(type) {\n            switch (type) {\n                case 'memory':\n                    this._logger = new MemoryLogger();\n                    break;\n\n                case 'console':\n                    this._logger = console;\n                    break;\n\n                default:\n                    this._logger = null;\n            }\n        }\n    }, {\n        key: \"error\",\n        value: function error() {\n            this._log(ERROR, arguments);\n        }\n    }, {\n        key: \"warn\",\n        value: function warn() {\n            this._log(WARN, arguments);\n        }\n    }, {\n        key: \"info\",\n        value: function info() {\n            this._log(INFO, arguments);\n        }\n\n        // Keep this function for compatibility\n\n    }, {\n        key: \"log\",\n        value: function log() {\n            this._log(DEBUG, arguments);\n        }\n    }]);\n\n    return Debug;\n}();\n\nexports.default = Debug;\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* Errors and warning notifications handler.\n*/\n\nvar _Debug = require('./Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _EventBus = require('./EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _instance = null;\n\nvar ErrorHandler = function () {\n    _createClass(ErrorHandler, null, [{\n        key: 'getInstance',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n        value: function getInstance() {\n            if (_instance === null) {\n                _instance = new ErrorHandler();\n            }\n\n            return _instance;\n        }\n    }]);\n\n    function ErrorHandler() {\n        _classCallCheck(this, ErrorHandler);\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._eventBus = _EventBus2.default.getInstance();\n        this._debug = _Debug2.default.getInstance();\n\n        _instance = this;\n        return _instance;\n    }\n\n    /**\n     * [sendWarning description]\n     * @param  {[type]} code    [description]\n     * @param  {[type]} message [description]\n     * @param  {[type]} data    [description]\n     * @return {[type]}         [description]\n     */\n\n\n    _createClass(ErrorHandler, [{\n        key: 'sendWarning',\n        value: function sendWarning(code, message, data) {\n            this._eventBus.dispatchEvent({\n                type: 'warning',\n                data: {\n                    code: code,\n                    message: message,\n                    data: data\n                }\n            });\n            this._debug.warn(\"[Warn] Code: \" + code + \", Message: \" + message + \", Data: \" + JSON.stringify(data, null, '\\t'));\n        }\n\n        /**\n         * [sendError description]\n         * @param  {[type]} code    [description]\n         * @param  {[type]} message [description]\n         * @param  {[type]} data    [description]\n         * @return {[type]}         [description]\n         */\n\n    }, {\n        key: 'sendError',\n        value: function sendError(code, message, data) {\n            this._eventBus.dispatchEvent({\n                type: 'error',\n                data: {\n                    code: code,\n                    message: message,\n                    data: data\n                }\n            });\n            this._debug.error(\"[Error] Code: \" + code + \", Message: \" + message + \", Data: \" + JSON.stringify(data, null, '\\t'));\n        }\n    }]);\n\n    return ErrorHandler;\n}();\n\n// File Loader errors\n\n\nErrorHandler.DOWNLOAD_ERR_FILES = \"DOWNLOAD_ERR_FILES\";\nErrorHandler.DOWNLOAD_ERR_NOT_XML = \"DOWNLOAD_ERR_NOT_XML\";\n\nErrorHandler.LOAD_VAST_FAILED = \"LOAD_VAST_FAILED\";\n\n// Media Player errors\nErrorHandler.NO_VALID_MEDIA_FOUND = \"NO_VALID_MEDIA_FOUND\";\nErrorHandler.LOAD_MEDIA_FAILED = \"LOAD_MEDIA_FAILED\";\nErrorHandler.UNSUPPORTED_MEDIA_FILE = \"UNSUPPORTED_MEDIA_FILE\";\nErrorHandler.UNAVAILABLE_LINK = \"UNAVAILABLE_LINK\";\n\nexports.default = ErrorHandler;\n\n},{\"./Debug\":4,\"./EventBus\":6}],6:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* Event bus utility class for events listening and notifying.\n*/\n\nvar _Debug = require('./Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _instance = null;\n\nvar EventBus = function () {\n    _createClass(EventBus, [{\n        key: '_getListeners',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n\n        value: function _getListeners(type, useCapture) {\n            if (useCapture === undefined) {\n                // to provide a default parameter that works !!\n                useCapture = false;\n            }\n            var captype = (useCapture ? '1' : '0') + type;\n\n            if (!(captype in this._registrations)) {\n                this._registrations[captype] = [];\n            }\n\n            return this._registrations[captype];\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }], [{\n        key: 'getInstance',\n        value: function getInstance() {\n            if (_instance === null) {\n                _instance = new EventBus();\n            }\n\n            return _instance;\n        }\n    }]);\n\n    function EventBus() {\n        _classCallCheck(this, EventBus);\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._registrations = {};\n        this._debug = _Debug2.default.getInstance();\n\n        _instance = this;\n        return _instance;\n    }\n\n    /**\n     * [addEventListener description]\n     * @param {[type]} type       [description]\n     * @param {[type]} listener   [description]\n     * @param {[type]} useCapture [description]\n     */\n\n\n    _createClass(EventBus, [{\n        key: 'addEventListener',\n        value: function addEventListener(type, listener, useCapture) {\n            var listeners = this._getListeners(type, useCapture),\n                idx = listeners.indexOf(listener);\n\n            if (idx === -1) {\n                listeners.push(listener);\n            }\n        }\n\n        /**\n         * [removeEventListener description]\n         * @param  {[type]} type       [description]\n         * @param  {[type]} listener   [description]\n         * @param  {[type]} useCapture [description]\n         * @return {[type]}            [description]\n         */\n\n    }, {\n        key: 'removeEventListener',\n        value: function removeEventListener(type, listener, useCapture) {\n            var listeners = this._getListeners(type, useCapture),\n                idx = listeners.indexOf(listener);\n\n            if (idx !== -1) {\n                listeners.splice(idx, 1);\n            }\n        }\n\n        /**\n         * [dispatchEvent description]\n         * @param  {[type]} evt [description]\n         * @return {[type]}     [description]\n         */\n\n    }, {\n        key: 'dispatchEvent',\n        value: function dispatchEvent(evt) {\n            var listeners = this._getListeners(evt.type, false).slice(),\n                i = 0;\n\n            for (i = 0; i < listeners.length; i += 1) {\n                listeners[i].call(this, evt);\n            }\n            return !evt.defaultPrevented;\n        }\n    }]);\n\n    return EventBus;\n}();\n\nexports.default = EventBus;\n\n},{\"./Debug\":4}],7:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* File downloader utility class.\n*/\n\nvar _ErrorHandler = require(\"./ErrorHandler\");\n\nvar _ErrorHandler2 = _interopRequireDefault(_ErrorHandler);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FileLoader = function () {\n    _createClass(FileLoader, [{\n        key: \"_parseBaseUrl\",\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _parseBaseUrl(url) {\n            var base = null;\n\n            if (url.indexOf(\"/\") !== -1) {\n                if (url.indexOf(\"?\") !== -1) {\n                    url = url.substring(0, url.indexOf(\"?\"));\n                }\n                base = url.substring(0, url.lastIndexOf(\"/\") + 1);\n            }\n\n            return base;\n        }\n    }, {\n        key: \"_parseXml\",\n        value: function _parseXml(data) {\n\n            if (!window.DOMParser) {\n                return null;\n            }\n\n            try {\n                var parser = new window.DOMParser();\n\n                var xmlDoc = parser.parseFromString(data, \"text/xml\");\n                if (xmlDoc.getElementsByTagName('parsererror').length > 0) {\n                    throw new Error('Error parsing XML');\n                }\n                return xmlDoc;\n            } catch (e) {\n                return null;\n            }\n        }\n    }, {\n        key: \"_abort\",\n        value: function _abort() {\n            if (this._request !== null && this._request.readyState > 0 && this._request.readyState < 4) {\n                this._request.abort();\n            }\n        }\n    }, {\n        key: \"_load\",\n        value: function _load(url, resolve, reject) {\n            var baseUrl = this._parseBaseUrl(url),\n                needFailureReport = true,\n                onload = null,\n                report = null,\n                onabort = null,\n                self = this;\n\n            onabort = function onabort() {\n                this.aborted = true;\n            };\n\n            onload = function onload() {\n                if (this.status < 200 || this.status > 299) {\n                    return;\n                }\n\n                if (this.status === 200 && this.readyState === 4) {\n\n                    // Parse responseText in case of wrong response Content-Type\n                    var xmlDoc = this.responseXML || self._parseXml(this.responseText);\n\n                    // Check if response is in XML format.\n                    if (xmlDoc === null) {\n                        needFailureReport = true;\n                        return;\n                    }\n\n                    // Get the redirection URL and use it as base URL\n                    if (this.responseURL) {\n                        baseUrl = self._parseBaseUrl(this.responseURL);\n                    }\n\n                    needFailureReport = false;\n\n                    // Return XML DOM (as input to parsers)\n                    resolve({\n                        response: xmlDoc,\n                        baseUrl: baseUrl\n                    });\n                }\n            };\n\n            report = function report() {\n                if (!needFailureReport) {\n                    return;\n                }\n                needFailureReport = false;\n\n                if (this.aborted) {\n                    // Request has been aborted => reject without error\n                    reject();\n                } else if (this.status < 200 || this.status > 299) {\n                    // Request has failed => reject with error\n                    reject({\n                        name: _ErrorHandler2.default.DOWNLOAD_ERR_FILES,\n                        message: \"Failed to download file\",\n                        data: {\n                            url: url,\n                            status: this.status\n                        }\n                    });\n                } else if (this.responseXML === null) {\n                    // Response was not in XML format => reject with error\n                    reject({\n                        name: _ErrorHandler2.default.DOWNLOAD_ERR_NOT_XML,\n                        message: \"The downloaded file format is not in xml format\",\n                        data: {\n                            url: url\n                        }\n                    });\n                }\n            };\n\n            try {\n                this._request = new XMLHttpRequest();\n                this._request.onload = onload;\n                this._request.onloadend = report;\n                this._request.onerror = report;\n                this._request.onabort = onabort;\n                this._request.open(\"GET\", url, true);\n                this._request.timeout = 10000;\n                this._request.send();\n            } catch (e) {\n                this._request.onerror();\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function FileLoader() {\n        _classCallCheck(this, FileLoader);\n\n        this._request = null;\n    }\n\n    _createClass(FileLoader, [{\n        key: \"load\",\n        value: function load(url) {\n            var _this = this;\n\n            return new Promise(function (resolve, reject) {\n                _this._load(url, resolve, reject);\n            });\n        }\n    }, {\n        key: \"abort\",\n        value: function abort() {\n            if (this._request !== null && this._request.readyState > 0 && this._request.readyState < 4) {\n                this._request.abort();\n            }\n        }\n    }]);\n\n    return FileLoader;\n}();\n\nexports.default = FileLoader;\n\n},{\"./ErrorHandler\":5}],8:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* MAST parser. This class parses MAST file in XML format\n* and construct the corresponding MAST object according to MAST data model.\n*/\n\nvar _Mast = require('./model/Mast');\n\nvar _Mast2 = _interopRequireDefault(_Mast);\n\nvar _xmldom = require('../utils/xmldom');\n\nvar _xmldom2 = _interopRequireDefault(_xmldom);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MastParser = function () {\n    _createClass(MastParser, [{\n        key: '_getCondition',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _getCondition(conditionNode) {\n            var condition = new _Mast2.default.Condition(),\n                conditionNodes = void 0;\n\n            condition.type = conditionNode.getAttribute('type');\n            condition.name = conditionNode.getAttribute('name');\n            condition.value = conditionNode.getAttribute('value');\n            condition.operator = conditionNode.getAttribute('operator');\n            conditionNodes = conditionNode.getElementsByTagName('condition');\n            for (var i = 0; i < conditionNodes.length; i++) {\n                condition.conditions.push(this._getCondition(conditionNodes[i]));\n            }\n\n            return condition;\n        }\n    }, {\n        key: '_getSource',\n        value: function _getSource(sourceNode) {\n            var source = new _Mast2.default.Source(),\n                sourceNodes = void 0;\n\n            source.uri = sourceNode.getAttribute('uri');\n            source.altReference = sourceNode.getAttribute('altReference');\n            source.format = sourceNode.getAttribute('format');\n            sourceNodes = sourceNode.getElementsByTagName('source');\n            for (var i = 0; i < sourceNodes.length; i++) {\n                source.sources.push(this._getSource(sourceNodes[i]));\n            }\n\n            return source;\n        }\n    }, {\n        key: '_getTrigger',\n        value: function _getTrigger(triggerNode) {\n            var trigger = new _Mast2.default.Trigger(),\n                startConditionNodes = _xmldom2.default.getSubElements(triggerNode, 'startConditions', 'condition'),\n                endConditionNodes = _xmldom2.default.getSubElements(triggerNode, 'endConditions', 'condition'),\n                sourceNodes = _xmldom2.default.getSubElements(triggerNode, 'sources', 'source'),\n                i = void 0;\n\n            trigger.id = triggerNode.getAttribute('id');\n            trigger.description = triggerNode.getAttribute('description');\n\n            for (i = 0; i < startConditionNodes.length; i++) {\n                trigger.startConditions.push(this._getCondition(startConditionNodes[i]));\n            }\n\n            for (i = 0; i < endConditionNodes.length; i++) {\n                trigger.endConditions.push(this._getCondition(endConditionNodes[i]));\n            }\n\n            for (i = 0; i < sourceNodes.length; i++) {\n                trigger.sources.push(this._getSource(sourceNodes[i]));\n            }\n\n            return trigger;\n        }\n    }, {\n        key: '_getTriggers',\n        value: function _getTriggers(mastNode, mast) {\n            var triggerNodes = _xmldom2.default.getSubElements(mastNode, 'triggers', 'trigger');\n\n            for (var i = 0; i < triggerNodes.length; i++) {\n                mast.triggers.push(this._getTrigger(triggerNodes[i]));\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function MastParser() {\n        _classCallCheck(this, MastParser);\n    }\n\n    /**\n    * Parses the MAST xml file and get the triggers.\n    * @param {object} xmlDom - the XML DOM to parse\n    */\n\n\n    _createClass(MastParser, [{\n        key: 'parse',\n        value: function parse(xmlDom) {\n            var mast_ = new _Mast2.default.Mast(),\n                mastNode = _xmldom2.default.getElement(xmlDom, 'MAST');\n\n            if (mastNode === null) {\n                return mast_;\n            }\n\n            this._getTriggers(mastNode, mast_);\n\n            return mast_;\n        }\n    }]);\n\n    return MastParser;\n}();\n\nexports.default = MastParser;\n\n},{\"../utils/xmldom\":13,\"./model/Mast\":10}],9:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The TriggerManager manages the detection of the start and end of a trigger.\n* It takes as input a trigger object (as parsed from a MAST file) and tests the start and end conditions\n* to detect the activation and revocation of a trigger.\n*/\n\nvar _Mast = require('./model/Mast');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TriggerManager = function () {\n    _createClass(TriggerManager, [{\n        key: '_parseTime',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _parseTime(str) {\n            var timeParts,\n                SECONDS_IN_HOUR = 60 * 60,\n                SECONDS_IN_MIN = 60;\n\n            if (!str) {\n                return -1;\n            }\n\n            timeParts = str.split(':');\n\n            // Check time format, must be HH:MM:SS(.mmm)\n            if (timeParts.length !== 3) {\n                return -1;\n            }\n\n            return parseInt(timeParts[0]) * SECONDS_IN_HOUR + parseInt(timeParts[1]) * SECONDS_IN_MIN + parseFloat(timeParts[2]);\n        }\n    }, {\n        key: '_compareValues',\n        value: function _compareValues(value1, value2, operator) {\n            var res = false;\n\n            if (value1 < 0 || value2 < 0) {\n                return false;\n            }\n\n            switch (operator) {\n                case _Mast.Condition.OPERATOR.EQ:\n                    res = value1 === value2;\n                    break;\n                case _Mast.Condition.OPERATOR.NEQ:\n                    res = value1 !== value2;\n                    break;\n                case _Mast.Condition.OPERATOR.GTR:\n                    res = value1 > value2;\n                    break;\n                case _Mast.Condition.OPERATOR.GEQ:\n                    res = value1 >= value2;\n                    break;\n                case _Mast.Condition.OPERATOR.LT:\n                    res = value1 < value2;\n                    break;\n                case _Mast.Condition.OPERATOR.LEQ:\n                    res = value1 <= value2;\n                    break;\n                case _Mast.Condition.OPERATOR.MOD:\n                    res = value1 % value2 === 0;\n                    break;\n                default:\n                    break;\n            }\n            return res;\n        }\n    }, {\n        key: '_evaluateCondition',\n        value: function _evaluateCondition(condition, video) {\n            var res = false,\n                i;\n\n            // Check pre-roll condition for activation\n            if (video.currentTime === 0 && condition.type === _Mast.Condition.TYPE.EVENT && condition.name === _Mast.Condition.NAME.ON_ITEM_START) {\n                res = true;\n            }\n\n            // Check mid-roll condition for activation\n            if (condition.type === _Mast.Condition.TYPE.PROPERTY) {\n                switch (condition.name) {\n                    case _Mast.Condition.NAME.POSITION:\n                        res = this._compareValues(video.currentTime, this._parseTime(condition.value), condition.operator);\n                        break;\n                    case _Mast.Condition.NAME.DURATION:\n                        res = this._compareValues(video.duration, this._parseTime(condition.value), condition.operator);\n                        break;\n                    default:\n                        break;\n                }\n            }\n\n            // Check condition for revocation\n            if (video.ended && condition.type === _Mast.Condition.TYPE.EVENT && condition.name === _Mast.Condition.NAME.ON_ITEM_END) {\n                res = true;\n            }\n\n            // AND with sub-conditions\n            // MAST spec. : \"Child conditions are treated as an implicit AND, all children of a condition must evaluate true before a trigger will fire (or be revoked) from that condition.\"\n            for (i = 0; i < condition.conditions.length; i++) {\n                res &= this._evaluateCondition(condition.conditions[i], video);\n            }\n\n            return res;\n        }\n    }, {\n        key: '_evaluateConditions',\n        value: function _evaluateConditions(conditions, video) {\n            var res = false,\n                i;\n\n            // Evaluate each condition\n            // MAST spec. : \"Multiple condition elements are treated as an implicit OR, any one of them evaluating true will fire the trigger.\"\n            for (i = 0; i < conditions.length; i++) {\n                res |= this._evaluateCondition(conditions[i], video);\n            }\n\n            return res;\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function TriggerManager() {\n        _classCallCheck(this, TriggerManager);\n\n        this._trigger = null;\n    }\n\n    /**\n     * Initializes the TriggerManager.\n     * @method init\n     * @access public\n     * @memberof TriggerManager#\n     * @param {Object} trigger - the trigger to handle by this manager\n     */\n\n\n    _createClass(TriggerManager, [{\n        key: 'init',\n        value: function init(trigger) {\n            this._trigger = trigger;\n        }\n\n        /**\n         * Returns the trigger object managed by this TriggerManager.\n         * @method init\n         * @access public\n         * @memberof TriggerManager#\n         * @return {Object} the managed trigger object\n         */\n\n    }, {\n        key: 'getTrigger',\n        value: function getTrigger() {\n            return this._trigger;\n        }\n\n        /**\n         * Evaluates the trigger start conditions.\n         * @method checkStartConditions\n         * @access public\n         * @memberof TriggerManager#\n         * @param {Number} video - the main video element\n         */\n\n    }, {\n        key: 'checkStartConditions',\n        value: function checkStartConditions(video) {\n            if (this._trigger.activated) {\n                return false;\n            }\n            return this._evaluateConditions(this._trigger.startConditions, video);\n        }\n\n        /**\n         * Evaluates the trigger end conditions.\n         * @method checkEndConditions\n         * @access public\n         * @memberof TriggerManager#\n         * @param {Number} video - the main video element\n         */\n\n    }, {\n        key: 'checkEndConditions',\n        value: function checkEndConditions(video) {\n            return this._evaluateConditions(this._trigger.endConditions, video);\n        }\n    }]);\n\n    return TriggerManager;\n}();\n\nexports.default = TriggerManager;\n\n},{\"./model/Mast\":10}],10:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* @class Mast\n* @ignore\n*/\nvar Mast = function Mast() {\n    _classCallCheck(this, Mast);\n\n    this.baseUrl = '';\n    this.triggers = []; // pointer to any number of Ad objects\n};\n\n/**\n* @class Trigger\n* @ignore\n*/\n\n\nvar Trigger = function Trigger() {\n    _classCallCheck(this, Trigger);\n\n    this.id = '';\n    this.description = 0;\n    this.startConditions = []; // pointer to a list of start conditions to  : AdsPlayer.mast.model.Trigger.Condition\n    this.endConditions = []; // pointer to a list of end conditions : AdsPlayer.mast.model.Trigger.Condition\n    this.sources = []; // pointer to a list of sources : AdsPlayer.mast.model.Trigger.Source\n    this.alreadyProcessed = false; // mainly in the seeked case : do not replay trigger already played\n    this.vasts = [];\n    this.activated = false;\n};\n\n/**\n* @class Condition\n* @ignore\n*/\n\n\nvar Condition = function Condition() {\n    _classCallCheck(this, Condition);\n\n    this.type = '';\n    this.name = '';\n    this.value = '';\n    this.operator = '';\n    this.conditions = [];\n};\n\n// ConditionType\n\n\nCondition.TYPE = {\n    EVENT: 'event',\n    PROPERTY: 'property'\n\n};\n\n// ConditionName\nCondition.NAME = {\n    ON_ITEM_START: 'OnItemStart',\n    ON_ITEM_END: 'OnItemEnd',\n    POSITION: 'Position',\n    DURATION: 'Duration'\n};\n\n// ConditionOperator\nCondition.OPERATOR = {\n    EQ: 'EQ', // equal\n    NEQ: 'NEQ', // not equal\n    GTR: 'GTR', // greater\n    GEQ: 'GEQ', // greater or equal\n    LT: 'LT', // lower\n    LEQ: 'LEQ', // lower or equal\n    MOD: 'MOD' // modulo\n};\n\n/**\n* @class Source\n* @ignore\n*/\n\nvar Source = function Source() {\n    _classCallCheck(this, Source);\n\n    this.uri = '';\n    this.altReference = '';\n    this.format = '';\n    this.sources = [];\n    // this.targets = [];\n};\n\n// SourceFormat\n\n\nSource.FORMAT = {\n    VAST: 'vast',\n    UIF: 'uif'\n};\n\nvar mast = {};\n\nmast.Mast = Mast;\nmast.Trigger = Trigger;\nmast.Condition = Condition;\nmast.Source = Source;\n\nexports.default = mast;\nexports.Mast = Mast;\nexports.Trigger = Trigger;\nexports.Condition = Condition;\nexports.Source = Source;\n\n},{}],11:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The ImagePlayer is a MediaPlayer implementation for playing still images.\n*/\n\nvar _Debug = require('../Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ImagePlayer = function () {\n    _createClass(ImagePlayer, [{\n        key: '_getListeners',\n        value: function _getListeners(type) {\n            if (!(type in this._listeners)) {\n                this._listeners[type] = [];\n            }\n            return this._listeners[type];\n        }\n    }, {\n        key: '_addEventListener',\n        value: function _addEventListener(type, listener) {\n            var listeners = this._getListeners(type),\n                idx = listeners.indexOf(listener);\n\n            if (idx === -1) {\n                listeners.push(listener);\n            }\n        }\n    }, {\n        key: '_removeEventListener',\n        value: function _removeEventListener(type, listener) {\n            var listeners = this._getListeners(type),\n                idx = listeners.indexOf(listener);\n\n            if (idx !== -1) {\n                listeners.splice(idx, 1);\n            }\n        }\n    }, {\n        key: '_notifyEvent',\n        value: function _notifyEvent(type) {\n            var listeners = this._getListeners(type),\n                i = 0;\n\n            for (i = 0; i < listeners.length; i++) {\n                listeners[i].call(this);\n            }\n        }\n    }, {\n        key: '_updateCurrentTime',\n        value: function _updateCurrentTime() {\n            var time = new Date().getTime();\n\n            this._currentTime += (time - this._timerTime) / 1000;\n            //this._debug.log(\"Image timeupdate, time = \" + this._currentTime);\n            this._notifyEvent('timeupdate');\n\n            if (this._currentTime >= this._duration) {\n                this._stopTimer();\n                this._notifyEvent('ended');\n            }\n\n            this._timerTime = time;\n        }\n    }, {\n        key: '_startTimer',\n        value: function _startTimer() {\n            if (this._timerInterval !== null) {\n                return;\n            }\n            this._notifyEvent('play');\n            this._timerTime = new Date().getTime();\n            this._timerInterval = setInterval(this._updateCurrentTime.bind(this), 200);\n        }\n    }, {\n        key: '_stopTimer',\n        value: function _stopTimer() {\n            if (this._timerInterval === null) {\n                return;\n            }\n            this._notifyEvent('pause');\n            clearInterval(this._timerInterval);\n            this._timerInterval = null;\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function ImagePlayer() {\n        _classCallCheck(this, ImagePlayer);\n\n        this._uri = '';\n        this._image = null;\n        this._duration = 0;\n        this._currentTime = 0;\n        this._listeners = {};\n        this._timerInterval = null;\n        this._timerTime = -1;\n        this._events = ['play', 'pause', 'timeupdate', 'ended'];\n        this._debug = _Debug2.default.getInstance();\n    }\n\n    _createClass(ImagePlayer, [{\n        key: 'load',\n        value: function load(baseUrl, mediaFiles) {\n\n            var mediaFile = null,\n                type,\n                i;\n\n            // Load the first supported image format\n            // Support only jpeg, png and gif image formats\n            for (i = 0; i < mediaFiles.length; i++) {\n                type = mediaFiles[i].type;\n                if (type === \"image/jpeg\" || type === \"image/jpg\" || type === \"image/png\" || type === \"image/gif\") {\n                    mediaFile = mediaFiles[i];\n                    break;\n                }\n            }\n\n            if (mediaFile === null) {\n                return false;\n            }\n\n            // Get adsplayer-image element if already declared in DOM\n            this._image = document.getElementById('adsplayer-image');\n\n            if (!this._image) {\n                // Create the image element\n                this._image = document.createElement('img');\n                this._image.autoplay = false;\n                this._image.id = 'adsplayer-image';\n            }\n\n            // Add base URL\n            this._uri = mediaFile.uri;\n            this._uri = this._uri.indexOf('http://') === -1 ? baseUrl + this._uri : this._uri;\n\n            this._debug.log(\"Load image media, uri = \" + this._uri);\n            this._image.src = this._uri;\n\n            // Reset current time\n            this._currentTime = 0;\n\n            return true;\n        }\n    }, {\n        key: 'getType',\n        value: function getType() {\n            return \"image\";\n        }\n    }, {\n        key: 'getElement',\n        value: function getElement() {\n            return this._image;\n        }\n    }, {\n        key: 'addEventListener',\n        value: function addEventListener(type, listener) {\n            if (!this._image) {\n                return;\n            }\n            if (this._events.indexOf(type) !== -1) {\n                this._addEventListener(type, listener);\n            } else {\n                this._image.addEventListener(type, listener);\n            }\n        }\n    }, {\n        key: 'removeEventListener',\n        value: function removeEventListener(type, listener) {\n            if (!this._image) {\n                return;\n            }\n            if (this._events.indexOf(type) !== -1) {\n                this._removeEventListener(type, listener);\n            } else {\n                this._image.removeEventListener(type, listener);\n            }\n        }\n    }, {\n        key: 'setDuration',\n        value: function setDuration(duration) {\n            this._duration = duration;\n        }\n    }, {\n        key: 'getDuration',\n        value: function getDuration() {\n            return this._duration;\n        }\n    }, {\n        key: 'getCurrentTime',\n        value: function getCurrentTime() {\n            return this._currentTime;\n        }\n    }, {\n        key: 'setVolume',\n        value: function setVolume() /*volume*/{\n            // NA\n        }\n    }, {\n        key: 'getVolume',\n        value: function getVolume() {\n            return 0;\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            if (!this._image) {\n                return;\n            }\n            this._startTimer();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            if (!this._image) {\n                return;\n            }\n            this._stopTimer();\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            if (!this._image) {\n                return;\n            }\n            this._stopTimer();\n        }\n    }, {\n        key: 'reset',\n        value: function reset() {\n            if (!this._image) {\n                return;\n            }\n            this._image = null;\n            this._listeners = {};\n        }\n    }]);\n\n    return ImagePlayer;\n}();\n\nexports.default = ImagePlayer;\n\n},{\"../Debug\":4}],12:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The VideoPlayer is a MediaPlayer implementation for playing video files.\n*/\n\nvar _Debug = require(\"../Debug\");\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar VideoPlayer = function () {\n    _createClass(VideoPlayer, [{\n        key: \"isMediaSupported\",\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function isMediaSupported(mimeType) {\n            if (!this._video) {\n                throw \"isMediaSupported(): element not created\";\n            }\n            if (!(this._video instanceof HTMLMediaElement)) {\n                throw \"isMediaSupported(): element must be of type HTMLMediaElement\";\n            }\n\n            var canPlay = this._video.canPlayType(mimeType);\n            return canPlay === \"probably\" || canPlay === \"maybe\";\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function VideoPlayer() {\n        _classCallCheck(this, VideoPlayer);\n\n        this._uri = '';\n        this._video = null;\n        this._debug = _Debug2.default.getInstance();\n    }\n\n    _createClass(VideoPlayer, [{\n        key: \"load\",\n        value: function load(baseUrl, mediaFiles) {\n\n            // Get 'adsplayer-video' element if already declared in DOM\n            this._video = document.getElementById('adsplayer-video');\n\n            if (!this._video) {\n                // Create the video element\n                this._video = document.createElement('video');\n                this._video.autoplay = false;\n                this._video.id = 'adsplayer-video';\n            }\n\n            // Check if input format is supported\n            if (!this.isMediaSupported(mediaFiles[0].type)) {\n                return false;\n            }\n\n            // Sort the mediafiles in bitrate ascending order\n            mediaFiles.sort(function (a, b) {\n                if (a.bitrate && b.bitrate) {\n                    return a.bitrate - b.bitrate;\n                }\n                return -1;\n            });\n\n            // Play the media file with lowest bitrate\n            this._uri = mediaFiles[0].uri;\n\n            // Add base URL\n            this._uri = this._uri.indexOf('http://') === -1 ? baseUrl + this._uri : this._uri;\n\n            this._debug.log(\"Load video media, uri = \" + this._uri);\n\n            this._video.addEventListener('error', function (e) {\n                console.log(e);\n            });\n\n            this._video.src = this._uri;\n\n            return true;\n        }\n    }, {\n        key: \"getType\",\n        value: function getType() {\n            return \"video\";\n        }\n    }, {\n        key: \"getElement\",\n        value: function getElement() {\n            return this._video;\n        }\n    }, {\n        key: \"addEventListener\",\n        value: function addEventListener(type, listener) {\n            if (!this._video) {\n                return;\n            }\n            this._video.addEventListener(type, listener);\n        }\n    }, {\n        key: \"removeEventListener\",\n        value: function removeEventListener(type, listener) {\n            if (!this._video) {\n                return;\n            }\n            this._video.removeEventListener(type, listener);\n        }\n    }, {\n        key: \"setDuration\",\n        value: function setDuration() /*duration*/{\n            // duration is handled by the video element\n        }\n    }, {\n        key: \"getDuration\",\n        value: function getDuration() {\n            if (!this._video) {\n                return 0;\n            }\n            return this._video.duration;\n        }\n    }, {\n        key: \"getCurrentTime\",\n        value: function getCurrentTime() {\n            if (!this._video) {\n                return 0;\n            }\n            return this._video.currentTime;\n        }\n    }, {\n        key: \"getVolume\",\n        value: function getVolume() {\n            if (!this._video) {\n                return 0;\n            }\n            return this._video.muted ? 0 : this._video.volume;\n        }\n    }, {\n        key: \"setVolume\",\n        value: function setVolume(volume) {\n            if (!this._video) {\n                return;\n            }\n            this._video.volume = volume;\n        }\n    }, {\n        key: \"play\",\n        value: function play() {\n            if (!this._video) {\n                return;\n            }\n            this._video.play();\n        }\n    }, {\n        key: \"stop\",\n        value: function stop() {\n            if (!this._video) {\n                return;\n            }\n            this._video.pause();\n        }\n    }, {\n        key: \"pause\",\n        value: function pause() {\n            if (!this._video) {\n                return;\n            }\n            this._video.pause();\n        }\n    }, {\n        key: \"reset\",\n        value: function reset() {\n            if (!this._video) {\n                return;\n            }\n            this._video = null;\n        }\n    }]);\n\n    return VideoPlayer;\n}();\n\nexports.default = VideoPlayer;\n\n},{\"../Debug\":4}],13:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nvar xmldom = {};\n\nxmldom.getElementsByTagName = function (node, name) {\n    var elements = node.getElementsByTagName(name);\n    if (elements.length < 1) {\n        var child = node.firstElementChild || node.firstChild;\n        if (child) {\n            var namespaceURI = child.namespaceURI;\n            elements = node.getElementsByTagNameNS(namespaceURI, name);\n        }\n    }\n    return elements;\n};\n\nxmldom.getElement = function (node, name) {\n    var elements = this.getElementsByTagName(node, name);\n    if (elements.length < 1) {\n        return null;\n    }\n    return elements[0];\n};\n\nxmldom.getElements = function (node, name) {\n    return this.getElementsByTagName(node, name);\n};\n\nxmldom.getSubElements = function (node, name, subName) {\n    var element = this.getElement(node, name);\n    if (element === null) {\n        return [];\n    }\n    return this.getElements(element, subName);\n};\n\nxmldom.getChildNode = function (node, name) {\n    if (!node || !node.childNodes) {\n        return null;\n    }\n    for (var i = 0; i < node.childNodes.length; i++) {\n        if (node.childNodes[i].nodeName === name) {\n            return node.childNodes[i];\n        }\n    }\n    return null;\n};\n\nxmldom.getNodeTextValue = function (node) {\n    var cdataSection = this.getChildNode(node, '#cdata-section'),\n        textSection = this.getChildNode(node, '#text');\n    if (cdataSection) {\n        return cdataSection.nodeValue;\n    } else if (textSection) {\n        return textSection.nodeValue;\n    }\n    return '';\n};\n\nxmldom.getChildNodeTextValue = function (node, name) {\n    var element = this.getElement(node, name);\n    if (element === null) {\n        return '';\n    }\n    return this.getNodeTextValue(element);\n};\n\nexports.default = xmldom;\n\n},{}],14:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The CreativePlayer manages:\n* - the playing of media files within a Creative (with the help of a Image/VideoPlayer)\n* - the tracking events (with the help of a TrackingEventsManager)\n* - the display of the ad skipping component\n* - the user clicks\n*/\n\nvar _TrackingEventsManager = require('./TrackingEventsManager');\n\nvar _TrackingEventsManager2 = _interopRequireDefault(_TrackingEventsManager);\n\nvar _VideoPlayer = require('../media/VideoPlayer');\n\nvar _VideoPlayer2 = _interopRequireDefault(_VideoPlayer);\n\nvar _ImagePlayer = require('../media/ImagePlayer');\n\nvar _ImagePlayer2 = _interopRequireDefault(_ImagePlayer);\n\nvar _Debug = require('../Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _EventBus = require('../EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar CreativePlayer = function () {\n    _createClass(CreativePlayer, [{\n        key: '_parseTime',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _parseTime(str) {\n            var timeParts,\n                SECONDS_IN_HOUR = 60 * 60,\n                SECONDS_IN_MIN = 60;\n\n            if (!str) {\n                return -1;\n            }\n\n            timeParts = str.split(':');\n\n            // Check time format, must be HH:MM:SS(.mmm)\n            if (timeParts.length !== 3) {\n                return -1;\n            }\n\n            return parseInt(timeParts[0]) * SECONDS_IN_HOUR + parseInt(timeParts[1]) * SECONDS_IN_MIN + parseFloat(timeParts[2]);\n        }\n    }, {\n        key: '_onMediaPlay',\n        value: function _onMediaPlay() {\n\n            this._debug.log(\"Creative media play\");\n\n            // Notify the creative has ended\n            this._eventBus.dispatchEvent({\n                type: 'play',\n                data: {}\n            });\n        }\n    }, {\n        key: '_onMediaPause',\n        value: function _onMediaPause() {\n\n            this._debug.log(\"Creative media pause\");\n\n            // Notify the creative has ended\n            this._eventBus.dispatchEvent({\n                type: 'pause',\n                data: {}\n            });\n        }\n    }, {\n        key: '_onMediaError',\n        value: function _onMediaError() {\n\n            this._debug.log(\"Creative media error\");\n\n            // Notify the creative has ended\n            this._eventBus.dispatchEvent({\n                type: 'creativeEnd',\n                data: {}\n            });\n        }\n    }, {\n        key: '_onMediaEnded',\n        value: function _onMediaEnded() {\n\n            this._debug.log(\"creative media ended\");\n\n            // Notify the creative has ended\n            this._eventBus.dispatchEvent({\n                type: 'creativeEnd',\n                data: {}\n            });\n        }\n    }, {\n        key: '_onMediaTimeupdate',\n        value: function _onMediaTimeupdate() {\n\n            //this._debug.log(\"Media timeupdate: \" + this._mediaPlayer.getCurrentTime());\n        }\n    }, {\n        key: '_onAdClick',\n        value: function _onAdClick() {\n            // this = creative\n            if (!this.videoClicks) {\n                return;\n            }\n\n            this._debug.log(\"Creative Click\");\n\n            // ClickThrough : send an event for the application to open the web page\n            if (this.videoClicks.clickThrough) {\n                this._debug.log(\"Ad click, uri = \" + this.videoClicks.clickThrough);\n                this._eventBus.dispatchEvent({\n                    type: 'click',\n                    data: {\n                        uri: this.videoClicks.clickThrough\n                    }\n                });\n            }\n\n            // TODO\n            // ClickTracking\n            // if (this.videoClicks.clickTracking) {\n            // }\n        }\n    }, {\n        key: '_load',\n        value: function _load(creative, baseUrl) {\n            var mediaFile, isVideo, isImage;\n\n            if (!creative) {\n                return false;\n            }\n\n            if (creative.mediaFiles.length === 0) {\n                return false;\n            }\n\n            mediaFile = creative.mediaFiles[0];\n\n            // Video or image media ?\n            isVideo = mediaFile.type.indexOf('video') !== -1;\n            isImage = mediaFile.type.indexOf('image') !== -1;\n\n            if (isVideo) {\n                this._mediaPlayer = new _VideoPlayer2.default();\n            } else if (isImage) {\n                this._mediaPlayer = new _ImagePlayer2.default();\n            } else {\n                // Unknown/unsupported media type\n                return false;\n            }\n\n            // Load the media files\n            this._debug.log(\"Creative load\");\n            if (!this._mediaPlayer.load(baseUrl, creative.mediaFiles)) {\n                this._mediaPlayer = null;\n                return false;\n            }\n\n            this._mediaPlayer.setDuration(this._parseTime(creative.duration));\n            this._mediaPlayer.addEventListener('play', this._onMediaPlayListener);\n            this._mediaPlayer.addEventListener('pause', this._onMediaPauseListener);\n            this._mediaPlayer.addEventListener('error', this._onMediaErrorListener);\n            this._mediaPlayer.addEventListener('timeupdate', this._onMediaTimeupdateListener);\n            this._mediaPlayer.addEventListener('ended', this._onMediaEndedListener);\n\n            // Add tracking events\n            if (creative.trackingEvents) {\n                this._trackingEventsManager = new _TrackingEventsManager2.default();\n                this._trackingEventsManager.init(creative.trackingEvents, this._mediaPlayer);\n                this._trackingEventsManager.start();\n            }\n\n            // Notify a creative is starting to play\n            this._eventBus.dispatchEvent({\n                type: 'creativeStart',\n                data: {}\n            });\n\n            // Notify a media element has been created and appended into document\n            this._eventBus.dispatchEvent({\n                type: 'addElement',\n                data: {\n                    element: this._mediaPlayer.getElement(),\n                    type: this._mediaPlayer.getType()\n                }\n            });\n\n            // Add the media player DOM element\n            this._adPlayerContainer.appendChild(this._mediaPlayer.getElement());\n\n            // Listener for click\n            if (creative.videoClicks) {\n                if (creative.videoClicks.clickThrough) {\n                    this._mediaPlayer.getElement().style.cursor = 'pointer';\n                }\n                this._mediaPlayer.getElement().addEventListener('click', this._onAdClick.bind(creative).bind(this));\n            }\n\n            // Align media volume to main video volume\n            this._onMainVideoVolumeChange();\n\n            // Start playing the media\n            this._play();\n\n            return true;\n        }\n    }, {\n        key: '_play',\n        value: function _play() {\n\n            if (!this._mediaPlayer) {\n                return;\n            }\n\n            this._debug.log(\"Creative play\");\n\n            // Play the media player\n            this._mediaPlayer.play();\n        }\n    }, {\n        key: '_pause',\n        value: function _pause() {\n\n            if (!this._mediaPlayer) {\n                return;\n            }\n\n            this._debug.log(\"Creative pause\");\n\n            // Pause the media player\n            this._mediaPlayer.pause();\n        }\n    }, {\n        key: '_stop',\n        value: function _stop() {\n\n            if (!this._mediaPlayer) {\n                return;\n            }\n\n            this._debug.log(\"Creative stop\");\n\n            // Stop the media player\n            this._mediaPlayer.removeEventListener('play', this._onMediaPlayListener);\n            this._mediaPlayer.removeEventListener('pause', this._onMediaPauseListener);\n            this._mediaPlayer.removeEventListener('error', this._onMediaErrorListener);\n            this._mediaPlayer.removeEventListener('timeupdate', this._onMediaTimeupdateListener);\n            this._mediaPlayer.removeEventListener('ended', this._onMediaEndedListener);\n            this._mediaPlayer.stop();\n\n            // Notify a media element has been created and appended into document\n            this._eventBus.dispatchEvent({\n                type: 'removeElement',\n                data: {\n                    element: this._mediaPlayer.getElement(),\n                    type: this._mediaPlayer.getType()\n                }\n            });\n\n            // Remove the element from the DOM\n            this._adPlayerContainer.removeChild(this._mediaPlayer.getElement());\n\n            // Reset the media player\n            this._mediaPlayer.reset();\n            this._mediaPlayer = null;\n\n            // Stop the TrackingEvents manager\n            if (this._trackingEventsManager) {\n                this._trackingEventsManager.stop();\n                this._trackingEventsManager = null;\n            }\n        }\n    }, {\n        key: '_onMainVideoVolumeChange',\n        value: function _onMainVideoVolumeChange() {\n            if (!this._mediaPlayer) {\n                return;\n            }\n            this._mediaPlayer.setVolume(this._mainVideo.muted ? 0 : this._mainVideo.volume);\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function CreativePlayer() {\n        _classCallCheck(this, CreativePlayer);\n\n        this._adPlayerContainer = null;\n        this._mediaPlayer = null;\n        this._trackingEventsManager = null;\n        this._mainVideo = null;\n        this._debug = _Debug2.default.getInstance();\n        this._eventBus = _EventBus2.default.getInstance();\n\n        this._onMediaPlayListener = this._onMediaPlay.bind(this);\n        this._onMediaPauseListener = this._onMediaPause.bind(this);\n        this._onMediaErrorListener = this._onMediaError.bind(this);\n        this._onMediaTimeupdateListener = this._onMediaTimeupdate.bind(this);\n        this._onMediaEndedListener = this._onMediaEnded.bind(this);\n    }\n\n    /**\n     * Initializes the creative player.\n     * @method init\n     * @access public\n     * @memberof CreativePlayer#\n     * @param {Object} creative - the creative element to play\n     * @param {String} baseUrl - the base URL for media files\n     */\n\n\n    _createClass(CreativePlayer, [{\n        key: 'init',\n        value: function init(adPlayerContainer, mainVideo) {\n            this._adPlayerContainer = adPlayerContainer;\n            this._mainVideo = mainVideo;\n            this._mainVideo.addEventListener('volumechange', this._onMainVideoVolumeChange.bind(this));\n        }\n    }, {\n        key: 'load',\n        value: function load(creative, baseUrl) {\n            return this._load(creative, baseUrl);\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            this._play();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._pause();\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._stop();\n        }\n    }, {\n        key: 'reset',\n        value: function reset() {\n            this._mainVideo.removeEventListener('volumechange', this._onMainVideoVolumeChange);\n            this._mainVideo = null;\n        }\n    }]);\n\n    return CreativePlayer;\n}();\n\nexports.default = CreativePlayer;\n\n},{\"../Debug\":4,\"../EventBus\":6,\"../media/ImagePlayer\":11,\"../media/VideoPlayer\":12,\"./TrackingEventsManager\":15}],15:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The TrackingEventsManager manages the sending of the tracking events while a creative's media is playing.\n* It takes as input the list of tracking events to send.\n*/\n\nvar _Debug = require('../Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TrackingEventsManager = function () {\n    _createClass(TrackingEventsManager, [{\n        key: '_postEvent',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _postEvent(uri) {\n            var xhr = new XMLHttpRequest();\n            xhr.open('GET', uri, true);\n            xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n            xhr.send();\n        }\n    }, {\n        key: '_addEventListener',\n        value: function _addEventListener(element, eventType, trackingEvent) {\n\n            var self = this,\n                _listener = function _listener() /*event*/{\n                if (this.completed === true) {\n                    return;\n                }\n                if (this.uri === undefined || this.uri.length === 0) {\n                    return;\n                }\n                if (this.condition && !this.condition()) {\n                    return;\n                }\n                self._debug.log(\"Send tracking event \" + this.event + \", uri = \" + this.uri);\n                self._postEvent(this.uri);\n                if (this.oneShot === true) {\n                    this.completed = true;\n                }\n            },\n                _eventListener = {\n                type: eventType,\n                element: element,\n                listener: _listener.bind(trackingEvent)\n            };\n\n            element.addEventListener(eventType, _eventListener.listener);\n            this._eventListeners.push(_eventListener);\n        }\n    }, {\n        key: '_addPlayerEventListeners',\n        value: function _addPlayerEventListeners() {\n            var _this = this;\n\n            for (var i = 0; i < this._trackingEvents.length; i++) {\n                var trackingEvent = this._trackingEvents[i];\n                if (trackingEvent.uri && trackingEvent.uri.length > 0) {\n                    switch (trackingEvent.event) {\n                        case 'creativeView':\n                            trackingEvent.oneShot = true;\n                            this._addEventListener(this._adMediaPlayer, 'loadeddata', trackingEvent);\n                            break;\n                        case 'start':\n                            trackingEvent.oneShot = true;\n                            this._addEventListener(this._adMediaPlayer, 'playing', trackingEvent);\n                            break;\n                        case 'pause':\n                            trackingEvent.oneShot = false;\n                            this._addEventListener(this._adMediaPlayer, 'paused', trackingEvent);\n                            break;\n                        case 'resume':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                return _this._adMediaPlayer.getCurrentTime() > 0;\n                            };\n                            this._addEventListener(this._adMediaPlayer, 'play', trackingEvent);\n                            break;\n                        case 'firstQuartile':\n                            trackingEvent.oneShot = true;\n                            trackingEvent.condition = function () {\n                                //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                                return _this._adMediaPlayer.getCurrentTime() / _this._adMediaPlayer.getDuration() >= 0.25;\n                            };\n                            this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                            break;\n                        case 'midpoint':\n                            trackingEvent.oneShot = true;\n                            trackingEvent.condition = function () {\n                                //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                                return _this._adMediaPlayer.getCurrentTime() / _this._adMediaPlayer.getDuration() >= 0.50;\n                            };\n                            this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                            break;\n                        case 'thirdQuartile':\n                            trackingEvent.oneShot = true;\n                            trackingEvent.condition = function () {\n                                //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                                return _this._adMediaPlayer.getCurrentTime() / _this._adMediaPlayer.getDuration() >= 0.75;\n                            };\n                            this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                            break;\n                        case 'rewind':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                var res = _this._adMediaPlayer.getCurrentTime() < _this._currentTime;\n                                _this._currentTime = _this._adMediaPlayer.getCurrentTime();\n                                return res;\n                            };\n                            this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                            break;\n                        case 'complete':\n                            this._addEventListener(this._adMediaPlayer, 'ended', trackingEvent);\n                            break;\n                        case 'mute':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                var res = !_this._mute && _this._adMediaPlayer.getVolume() === 0;\n                                _this._mute = _this._adMediaPlayer.getVolume() === 0;\n                                return res;\n                            };\n                            this._addEventListener(this._adMediaPlayer, 'volumechange', trackingEvent);\n                            break;\n                        case 'unmute':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                var res = !_this._unmute && _this._adMediaPlayer.getVolume() > 0;\n                                _this._unmute = _this._adMediaPlayer.getVolume() > 0;\n                                return res;\n                            };\n                            this._addEventListener(this._adMediaPlayer, 'volumechange', trackingEvent);\n                            break;\n                        case 'fullscreen':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                return document.fullScreen || document.mozFullScreen || document.webkitIsFullScreen;\n                            };\n                            this._addEventListener(document, 'webkitfullscreenchange', trackingEvent);\n                            this._addEventListener(document, 'mozfullscreenchange', trackingEvent);\n                            this._addEventListener(document, 'MSFullscreenChange', trackingEvent);\n                            this._addEventListener(document, 'fullscreenChange', trackingEvent);\n                            break;\n                        default:\n                            break;\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_removePlayerEventListeners',\n        value: function _removePlayerEventListeners() {\n            for (var i = 0; i < this._eventListeners.length; i++) {\n                this._eventListeners[i].element.removeEventListener(this._eventListeners[i].type, this._eventListeners[i].listener);\n            }\n            this._eventListeners = [];\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function TrackingEventsManager() {\n        _classCallCheck(this, TrackingEventsManager);\n\n        this._trackingEvents = null;\n        this._adMediaPlayer = null;\n        this._currentTime = -1;\n        this._mute = -1;\n        this._unmute = -1;\n        this._debug = _Debug2.default.getInstance();\n        this._eventListeners = [];\n    }\n\n    /**\n     * Initializes the TrackingEventsManager.\n     * @method init\n     * @access public\n     * @memberof TrackingEventsManager#\n     * @param {Array} trackingEvents - the array of tracking events to manage\n     * @param {Object} adMediaPlayer - the ad media player\n     */\n\n\n    _createClass(TrackingEventsManager, [{\n        key: 'init',\n        value: function init(trackingEvents, adMediaPlayer) {\n            this._trackingEvents = trackingEvents;\n            this._adMediaPlayer = adMediaPlayer;\n            this._mute = this._adMediaPlayer.getVolume() === 0;\n            this._unmute = this._adMediaPlayer.getVolume() > 0;\n        }\n    }, {\n        key: 'start',\n        value: function start() {\n            if (this._trackingEvents.length === 0) {\n                return;\n            }\n            this._addPlayerEventListeners();\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._removePlayerEventListeners();\n        }\n    }]);\n\n    return TrackingEventsManager;\n}();\n\nexports.default = TrackingEventsManager;\n\n},{\"../Debug\":4}],16:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* VAST parser. This class parses VAST file in XML format\n* and construct the corresponding VAST object according to VAST data model.\n*/\n\nvar _Vast = require('./model/Vast');\n\nvar _Vast2 = _interopRequireDefault(_Vast);\n\nvar _xmldom = require('../utils/xmldom');\n\nvar _xmldom2 = _interopRequireDefault(_xmldom);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar VastParser = function () {\n    _createClass(VastParser, [{\n        key: '_getTrackingEvent',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _getTrackingEvent(trackingNode) {\n            var trackingEvent = new _Vast2.default.TrackingEvent();\n\n            trackingEvent.event = trackingNode.getAttribute('event');\n            trackingEvent.uri = _xmldom2.default.getNodeTextValue(trackingNode);\n\n            return trackingEvent;\n        }\n    }, {\n        key: '_getVideoClicks',\n        value: function _getVideoClicks(videoClicksNode) {\n            var videoClicks = new _Vast2.default.VideoClicks(),\n                nodeName = void 0,\n                nodeValue = void 0;\n\n            for (var i = 0; i < videoClicksNode.childNodes.length; i++) {\n                nodeName = videoClicksNode.childNodes[i].nodeName;\n                nodeValue = _xmldom2.default.getNodeTextValue(videoClicksNode.childNodes[i]);\n\n                switch (nodeName) {\n                    case \"ClickThrough\":\n                        videoClicks.clickThrough = nodeValue;\n                        break;\n                    case \"ClickTracking\":\n                        videoClicks.clickTracking = nodeValue;\n                        break;\n                    case \"CustomClick\":\n                        videoClicks.customClick = nodeValue;\n                        break;\n                }\n            }\n\n            return videoClicks;\n        }\n    }, {\n        key: '_getMediaFile',\n        value: function _getMediaFile(mediaFileNode) {\n            var mediaFile = new _Vast2.default.MediaFile();\n\n            mediaFile.id = mediaFileNode.getAttribute('id');\n            mediaFile.delivery = mediaFileNode.getAttribute('delivery');\n            mediaFile.type = mediaFileNode.getAttribute('type');\n            mediaFile.bitrate = mediaFileNode.getAttribute('bitrate');\n            mediaFile.width = mediaFileNode.getAttribute('width');\n            mediaFile.height = mediaFileNode.getAttribute('height');\n            mediaFile.scalable = mediaFileNode.getAttribute('scalable');\n            mediaFile.maintainAspectRatio = mediaFileNode.getAttribute('maintainAspectRatio');\n            mediaFile.apiFramework = mediaFileNode.getAttribute('apiFramework');\n            mediaFile.uri = _xmldom2.default.getNodeTextValue(mediaFileNode);\n\n            return mediaFile;\n        }\n    }, {\n        key: '_getLinear',\n        value: function _getLinear(linearNode) {\n            var linear = new _Vast2.default.Linear(),\n                trackingNodes = void 0,\n                videoClicksNode = void 0,\n                mediaFileNodes = void 0,\n                i = void 0;\n\n            linear.duration = _xmldom2.default.getChildNodeTextValue(linearNode, 'Duration');\n            linear.adParameters = _xmldom2.default.getChildNodeTextValue(linearNode, 'AdParameters');\n\n            trackingNodes = _xmldom2.default.getSubElements(linearNode, 'TrackingEvents', 'Tracking');\n            for (i = 0; i < trackingNodes.length; i++) {\n                linear.trackingEvents.push(this._getTrackingEvent(trackingNodes[i]));\n            }\n\n            videoClicksNode = _xmldom2.default.getElement(linearNode, 'VideoClicks');\n            if (videoClicksNode) {\n                linear.videoClicks = this._getVideoClicks(videoClicksNode);\n            }\n\n            mediaFileNodes = _xmldom2.default.getSubElements(linearNode, 'MediaFiles', 'MediaFile');\n            for (i = 0; i < mediaFileNodes.length; i++) {\n                linear.mediaFiles.push(this._getMediaFile(mediaFileNodes[i]));\n            }\n\n            return linear;\n        }\n    }, {\n        key: '_getCreative',\n        value: function _getCreative(creativeNode) {\n            var creative = new _Vast2.default.Creative(),\n                linearNode = void 0;\n\n            creative.id = creativeNode.getAttribute('id');\n            creative.adId = creativeNode.getAttribute('AdID');\n            creative.sequence = creativeNode.getAttribute('sequence');\n\n            linearNode = _xmldom2.default.getElement(creativeNode, 'Linear');\n            if (linearNode) {\n                creative.linear = this._getLinear(linearNode);\n            }\n\n            // TODO: get Companion and non-Linear elements\n\n            return creative;\n        }\n    }, {\n        key: '_getInLine',\n        value: function _getInLine(adNode) {\n            var inLine = new _Vast2.default.InLine(),\n                inLineNode = _xmldom2.default.getElement(adNode, 'InLine'),\n                impressionNodes = void 0,\n                creativeNodes = void 0,\n                i = void 0;\n\n            if (inLineNode === null) {\n                return null;\n            }\n\n            inLine.adSystem = _xmldom2.default.getChildNodeTextValue(inLineNode, 'AdSystem');\n            inLine.adTitle = _xmldom2.default.getChildNodeTextValue(inLineNode, 'AdTitle');\n            inLine.description = _xmldom2.default.getChildNodeTextValue(inLineNode, 'Description');\n            inLine.survey = _xmldom2.default.getChildNodeTextValue(inLineNode, 'Survey');\n            inLine.error = _xmldom2.default.getChildNodeTextValue(inLineNode, 'Error');\n\n            impressionNodes = _xmldom2.default.getElements(inLineNode, 'Impression');\n            for (i = 0; i < impressionNodes.length; i++) {\n                var impression = new _Vast2.default.Impression();\n                impression.id = impressionNodes[i].getAttribute('id');\n                impression.uri = _xmldom2.default.getNodeTextValue(impressionNodes[i]);\n                inLine.impressions.push(impression);\n            }\n\n            creativeNodes = _xmldom2.default.getSubElements(inLineNode, 'Creatives', 'Creative');\n            for (i = 0; i < creativeNodes.length; i++) {\n                inLine.creatives.push(this._getCreative(creativeNodes[i]));\n            }\n\n            return inLine;\n        }\n    }, {\n        key: '_getAd',\n        value: function _getAd(vastNode, vast_) {\n            var adNode = _xmldom2.default.getElement(vastNode, 'Ad');\n\n            if (adNode === null) {\n                return;\n            }\n\n            vast_.ad = new _Vast2.default.Ad();\n            vast_.ad.id = adNode.getAttribute('id');\n            vast_.ad.inLine = this._getInLine(adNode);\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function VastParser() {\n        _classCallCheck(this, VastParser);\n    }\n\n    /**\n    * Parses the VAST XML DOM and get the triggers.\n    * @param {object} xmlDom - the XML DOM to parse\n    */\n\n\n    _createClass(VastParser, [{\n        key: 'parse',\n        value: function parse(xmlDom) {\n            var vast_ = new _Vast2.default.Vast(),\n                vastNode = _xmldom2.default.getElement(xmlDom, 'VAST');\n\n            if (vastNode === null) {\n                return vast_;\n            }\n\n            vast_.version = vastNode.getAttribute('version');\n\n            this._getAd(vastNode, vast_);\n\n            return vast_;\n        }\n    }]);\n\n    return VastParser;\n}();\n\nexports.default = VastParser;\n\n},{\"../utils/xmldom\":13,\"./model/Vast\":18}],17:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The VastPlayerManager manages the sequencing of playing creatives of a single VAST.\n* It takes as input the list of Vast objects as returned by the VAST parser.\n* For each Vast, the VastPlayerManager plays sequentially all contained Creatives,\n* with the help of a CreativePlayer.\n*/\n\nvar _CreativePlayer = require('./CreativePlayer');\n\nvar _CreativePlayer2 = _interopRequireDefault(_CreativePlayer);\n\nvar _Debug = require('../Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _ErrorHandler = require('../ErrorHandler');\n\nvar _ErrorHandler2 = _interopRequireDefault(_ErrorHandler);\n\nvar _EventBus = require('../EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar VastPlayerManager = function () {\n    _createClass(VastPlayerManager, [{\n        key: '_sendImpressions',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _sendImpressions(impressions) {\n            var impression = void 0;\n\n            if (impressions.length === 0) {\n                return;\n            }\n\n            for (var i = 0; i < impressions.length; i++) {\n                impression = impressions[i];\n                if (impression.uri && impression.uri.length > 0) {\n                    this._debug.log(\"Send Impression, uri = \" + impression.uri);\n                    var http = new XMLHttpRequest();\n                    http.open(\"GET\", impression.uri, true);\n                    http.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n                    http.send();\n                }\n            }\n        }\n    }, {\n        key: '_onCreativeEnd',\n        value: function _onCreativeEnd() {\n\n            this._debug.log(\"Creative ended\");\n\n            // Stop the current creative media\n            this._stopCreative();\n\n            // Play next creative\n            this._playNextCreative();\n        }\n    }, {\n        key: '_pauseCreative',\n        value: function _pauseCreative() {\n            if (!this._creativePlayer) {\n                return;\n            }\n            this._creativePlayer.pause();\n        }\n    }, {\n        key: '_resumeCreative',\n        value: function _resumeCreative() {\n            if (!this._creativePlayer) {\n                return;\n            }\n            this._creativePlayer.play();\n        }\n    }, {\n        key: '_stopCreative',\n        value: function _stopCreative() {\n            if (!this._creativePlayer) {\n                return;\n            }\n            this._eventBus.removeEventListener('creativeEnd', this._onCreativeEndListener);\n            this._creativePlayer.stop();\n        }\n    }, {\n        key: '_playCreative',\n        value: function _playCreative(index) {\n            var creative = this._vasts[this._vastIndex].ad.inLine.creatives[index],\n                linear;\n\n            this._creativeIndex = index;\n            this._debug.log(\"Play Creative - index = \" + this._creativeIndex);\n\n            // Play Linear element\n            linear = creative.linear;\n\n            if (linear) {\n                this._debug.log(\"Play Linear Ad, duration = \" + linear.duration);\n                this._eventBus.addEventListener('creativeEnd', this._onCreativeEndListener);\n                if (!this._creativePlayer.load(creative.linear, this._vasts[this._vastIndex].baseUrl)) {\n                    this._playNextCreative();\n                }\n            } else {\n                this._playNextCreative();\n            }\n        }\n    }, {\n        key: '_playVast',\n        value: function _playVast(index) {\n            var vast = this._vasts[index],\n                ad = vast.ad;\n\n            if (ad === null) {\n                // Empty VAST\n                return;\n            }\n\n            this._vastIndex = index;\n            this._debug.log(\"Play Vast - index = \" + this._vastIndex + \", Ad id = \" + ad.id);\n\n            // Send Impressions tracking\n            this._sendImpressions(ad.inLine.impressions);\n\n            // Play first Creative\n            this._playCreative(0);\n        }\n    }, {\n        key: '_playNextVast',\n        value: function _playNextVast() {\n\n            this._vastIndex++;\n\n            if (this._vastIndex < this._vasts.length) {\n                this._playVast(this._vastIndex);\n            } else {\n                // Notify end of trigger\n                this._eventBus.dispatchEvent({\n                    type: 'triggerEnd',\n                    data: {}\n                });\n            }\n        }\n    }, {\n        key: '_playNextCreative',\n        value: function _playNextCreative() {\n            var ad = this._vasts[this._vastIndex].ad;\n\n            this._creativeIndex++;\n\n            if (this._creativeIndex < ad.inLine.creatives.length) {\n                this._playCreative(this._creativeIndex);\n            } else {\n                this._playNextVast();\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function VastPlayerManager() {\n        _classCallCheck(this, VastPlayerManager);\n\n        this._vasts = [];\n        this._adPlayerContainer = null;\n        this._vastIndex = -1;\n        this._creativeIndex = -1;\n        this._creativePlayer = new _CreativePlayer2.default();\n        this._errorHandler = _ErrorHandler2.default.getInstance();\n        this._debug = _Debug2.default.getInstance();\n        this._eventBus = _EventBus2.default.getInstance();\n        this._mediaPlayer = null;\n        this._onCreativeEndListener = this._onCreativeEnd.bind(this);\n    }\n\n    /**\n     * Initializes the VastPlayerManager.\n     * @method init\n     * @access public\n     * @memberof VastPlayerManager#\n     * @param {Array} vasts - the array of Vast components to play\n     * @param {Array} adPlayerContainer - the HTML DOM container for ads player components\n     */\n\n\n    _createClass(VastPlayerManager, [{\n        key: 'init',\n        value: function init(vasts, adPlayerContainer, mainVideo) {\n            this._vasts = vasts;\n            this._adPlayerContainer = adPlayerContainer;\n            this._creativePlayer.init(this._adPlayerContainer, mainVideo);\n        }\n    }, {\n        key: 'start',\n        value: function start() {\n            if (!this._vasts || this._vasts.length === 0) {\n                return;\n            }\n\n            // Notify a trigger is starting to play\n            this._eventBus.dispatchEvent({\n                type: 'triggerStart',\n                data: {}\n            });\n\n            this._playVast(0);\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            this._resumeCreative();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._pauseCreative();\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._stopCreative();\n        }\n    }, {\n        key: 'reset',\n        value: function reset() {\n            this._creativePlayer.reset();\n        }\n    }]);\n\n    return VastPlayerManager;\n}();\n\nexports.default = VastPlayerManager;\n\n},{\"../Debug\":4,\"../ErrorHandler\":5,\"../EventBus\":6,\"./CreativePlayer\":14}],18:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* @class Vast\n* @ignore\n*/\nvar Vast = function Vast() {\n    _classCallCheck(this, Vast);\n\n    this.version = '';\n    this.ad = null;\n};\n\n/**\n* @class Ad\n* @ignore\n*/\n\n\nvar Ad = function Ad() {\n    _classCallCheck(this, Ad);\n\n    this.id = '';\n    this.inLine = null;\n    this.wrapper = null;\n};\n\n/**\n* @class InLine\n* @ignore\n*/\n\n\nvar InLine = function InLine() {\n    _classCallCheck(this, InLine);\n\n    this.adSystem = ''; // [Required] Source ad server\n    this.adTitle = ''; // [Required] Title\n    this.description = ''; // [Optional] Description\n    this.survey = ''; // [Optional] URI of request to survey vendor\n    this.error = ''; // [Optional] URI to request if ad does not play due to error\n    this.impressions = []; // [Required] URIs to track impressions.\n    this.creatives = []; // [Required] Creative elements\n    this.extensions = []; // [Optional] Any valid XML may be included in the Extensions node\n};\n\n/**\n* @class Impression\n* @ignore\n*/\n\n\nvar Impression = function Impression() {\n    _classCallCheck(this, Impression);\n\n    this.uri = ''; // [Required] URI to track Impression\n    this.id = ''; // [Optional] Identifier\n};\n\n/**\n* @class Extensions\n* @ignore\n*/\n\n\nvar Extensions = function Extensions() {\n    _classCallCheck(this, Extensions);\n\n    this.uri = ''; //\n    this.other = ''; //\n};\n\n/**\n* @class Creative\n* @ignore\n*/\n\n\nvar Creative = function Creative() {\n    _classCallCheck(this, Creative);\n\n    this.id = ''; // [Optional] Identifier\n    this.adId = ''; // [Optional] Ad-ID for the creative (formerly ISCI)\n    this.sequence = 0; // [Optional] The preferred order in which multiple Creatives should be displayed\n    this.linear = null; // [Optional] Linear ad\n    this.CompanionAds = []; // [Optional] Companion ads\n    this.nonLinearAds = []; // [Optional] Non-linear ads\n};\n\n// Creative types\n\n\nCreative.TYPE = {\n    LINEAR: 'linear',\n    NON_LINEAR_ADS: 'NonLinearAds',\n    COMPANION_ADS: 'CompanionAds'\n};\n\n/**\n* @class Linear\n* @ignore\n*/\n\nvar Linear = function Linear() {\n    _classCallCheck(this, Linear);\n\n    this.duration = 0; // [Required] Duration in standard time format, hh:mm:ss\n    this.trackingEvents = []; // [Optional] Tracking events elements\n    this.adParameters = ''; // [Optional] Data to be passed into the video ad\n    this.videoClicks = null; // [Optional] Video clicks\n    this.mediaFiles = []; // [Required] Media file elements\n};\n\n/**\n* @class Companion\n* @ignore\n*/\n\n\nvar Companion = function Companion() {\n    _classCallCheck(this, Companion);\n\n    this.id = ''; // optional : identifier\n    this.width = 0; // width pixel dimension of companion\n    this.height = 0; // height pixel dimension of companion\n    this.staticResource = null; // optional : pointer to the static resource : AdsPlayer.vast.model.Ad.StaticResource\n    this.iFrameResource = ''; // optional : URI source for an IFrame to display the companion element\n    this.hTMLResource = ''; // optional : HTML to display the companion element : shall be CDATA value\n    this.trackingEvents = []; // optional : pointer to any number of tracking objects : AdsPlayer.vast.model.Ad.CompanionTracking\n    this.clickThrough = ''; // optional : URI to open as destination page when user clicks on the companion\n    this.altText = ''; // optional : alt text to be displayed when companion is rendered in HTML environment.\n    this.adParameters = ''; // optional : data to be passed into the companion ads\n};\n\n//\n//      Non Linear Ads\n//\n\n/**\n* @class Companion\n* @ignore\n*/\n\n\nvar NonLinear = function NonLinear() {\n    _classCallCheck(this, NonLinear);\n\n    this.id = ''; // optional : identifier\n    this.width = 0; // width pixel dimension of non linear\n    this.height = 0; // height pixel dimension of non linear\n    this.expandedWidth = 0; // optional : pixel dimensions of expanding nonlinear ad when in expanded state\n    this.expandedHeight = 0; // optional : pixel dimensions of expanding nonlinear ad when in expanded state\n    this.scalable = true; // optional : whether it is acceptable to scale the image\n    this.maintainAspectRatio = true; // optional : whether the ad must have its aspect ratio maintained when scaled\n    this.apiFramework = ''; // optional : defines the method to use for communication with the nonlinear element\n    this.staticResource = null; // optional : pointer to the static resource : AdsPlayer.vast.model.Ad.StaticResource\n    this.hTMLResource = ''; // optional : HTML to display the companion element : shall be CDATA value\n    this.trackingEvents = []; // optional : pointer to any number of tracking objects : AdsPlayer.vast.model.Ad.Tracking\n    this.clickThrough = ''; // optional : URI to open as destination page when user clicks on the non-linear ad unit\n    this.adParameters = ''; // optional : data to be passed into the video ad\n};\n\n/**\n* @class TrackingEvent\n* @ignore\n*/\n\n\nvar TrackingEvent = function TrackingEvent() {\n    _classCallCheck(this, TrackingEvent);\n\n    this.uri = ''; // [Optional] URI to track various events during playback\n    this.event = ''; // [Required] The name of the event to track for the Linear element\n};\n\n/**\n* [TrackingEvent description]\n* @type {Object}\n*/\n\n\nTrackingEvent.TYPE = {\n    CREATIVEVIEW: 'creativeView',\n    START: 'start',\n    MIDPOINT: 'midpoint',\n    FIRSTQUARTILE: 'firstQuartile',\n    THIRDQUARTILE: 'thirdQuartile',\n    COMPLETE: 'complete',\n    MUTE: 'mute',\n    UNMUTE: 'unmute',\n    PAUSE: 'pause',\n    REWIND: 'rewind',\n    RESUME: 'resume',\n    FULLSCREEN: 'fullscreen',\n    EXPAND: 'expand',\n    COLLAPSE: 'collapse',\n    ACCEPTINVITATION: 'acceptInvitation',\n    CLOSE: 'close'\n};\n\n/**\n* @class VideoClicks\n* @ignore\n*/\n\nvar VideoClicks = function VideoClicks() {\n    _classCallCheck(this, VideoClicks);\n\n    this.clickThrough = ''; // [Optional] URI to open as destination page when user clicks on the video\n    this.clickTracking = ''; // [Optional] URI to request for tracking purposes when user clicks on the video\n    this.customClick = ''; // [Optional] URI to request on custom events such as hotspotted video\n};\n\n/**\n* @class MediaFile\n* @ignore\n*/\n\n\nvar MediaFile = function MediaFile() {\n    _classCallCheck(this, MediaFile);\n\n    this.id = ''; // [Optional] Identifier\n    this.delivery = ''; // [Required] Method of delivery of ad ('streaming' or 'progressive')\n    this.type = ''; // [Required] MIME type\n    this.bitrate = 0; // [Optional] Bitrate of encoded video in Kbps\n    this.width = 0; // [Required] Pixel dimensions of video\n    this.height = 0; // [Required] Pixel dimensions of video\n    this.scalable = true; // [Optional] Whether it is acceptable to scale the image.\n    this.maintainAspectRatio = true; // [Optional] Whether the ad must have its aspect ratio maintained when scaled\n    this.apiFramework = ''; // [Optional] Defines the method to use for communication if the MediaFile is interactive.\n    this.uri = '';\n};\n\n// MediaFile delivery types\n\n\nMediaFile.DELIVERY = {\n    STREAMING: 'streaming',\n    PROGRESSIVE: 'progressive '\n};\n\n/**\n* @class StaticResource\n* @ignore\n*/\n\nvar StaticResource = function StaticResource() {\n    _classCallCheck(this, StaticResource);\n\n    this.uRI = ''; // optional : URI to a static file, such as an image or SWF file\n    this.creativeType = ''; // mime type of static resource\n};\n\nvar vast = {};\n\nvast.Vast = Vast;\nvast.Ad = Ad;\nvast.InLine = InLine;\nvast.Impression = Impression;\nvast.Extensions = Extensions;\nvast.Creative = Creative;\nvast.Linear = Linear;\nvast.Companion = Companion;\nvast.NonLinear = NonLinear;\nvast.TrackingEvent = TrackingEvent;\nvast.VideoClicks = VideoClicks;\nvast.MediaFile = MediaFile;\nvast.StaticResource = StaticResource;\n\nexports.default = vast;\nexports.Vast = Vast;\nexports.Ad = Ad;\nexports.InLine = InLine;\nexports.Impression = Impression;\nexports.Extensions = Extensions;\nexports.Creative = Creative;\nexports.Linear = Linear;\nexports.Companion = Companion;\nexports.NonLinear = NonLinear;\nexports.TrackingEvent = TrackingEvent;\nexports.VideoClicks = VideoClicks;\nexports.MediaFile = MediaFile;\nexports.StaticResource = StaticResource;\n\n},{}]},{},[1])\n\n","\nimport AdsPlayer from './src/AdsPlayer';\n\n// Shove both of these into the global scope\nvar context = (typeof window !== 'undefined' && window) || global;\n\nvar adsplayer = context.adsplayer;\nif (!adsplayer) {\n    adsplayer = context.adsplayer = {};\n}\n\nadsplayer.AdsPlayer = AdsPlayer;\n\nexport default adsplayer;\nexport { AdsPlayer };\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* AdsPlayer.\n* @constructor AdsPlayer\n* @param {Object} adsPlayerContainer - the DOM container in which &lt;video&gt; and &lt;img&gt; HTML components will be appended\n*/\n\nimport AdsPlayerController from './AdsPlayerController';\nimport EventBus from './EventBus';\n\nconst NAME = 'AdsPlayer';\nconst VERSION = '';\nconst GIT_TAG = '@@REVISION';\nconst BUILD_DATE = '@@TIMESTAMP';\n\n///////////////////////////////////////////////////////////////////////////////////////////////\n////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\nfunction _onError (e) {\n    this._error = e.data;\n}\n\nfunction _onWarning (e) {\n    this._warning = e.data;\n}\n\nclass AdsPlayer {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor (adsPlayerContainer) {\n\n        this._adsPlayerContainer = adsPlayerContainer;\n        this._error = null;\n        this._warning = null;\n        this._eventBus = EventBus.getInstance();\n        this._adsPlayerController = null;\n\n        this.onErrorListener = _onError.bind(this);\n        this.onWarningListener = _onWarning.bind(this);\n    }\n\n    // Plugin API\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * Returns the plugin name.\n    * @method getName\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {string} the plugin name\n    */\n    getName () {\n        return NAME;\n    }\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * Initializes the plugin.\n    * @method init\n    * @access public\n    * @memberof AdsPlayer#\n    * @param {Object} player - the MediaPlayer\n    * @param {function} callback - the callback function to invoke when initialization is done\n    */\n    init (player, callback) {\n        this._adsPlayerController = new AdsPlayerController();\n        this._adsPlayerController.init(player, this._adsPlayerContainer);\n        this._eventBus.addEventListener('error', this.onErrorListener);\n        this._eventBus.addEventListener('warning', this.onWarningListener);\n\n        callback();\n    }\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * This method is invoked when a new stream is to be loaded/opened.\n    * @method load\n    * @access public\n    * @memberof AdsPlayer#\n    * @param {object} stream - the stream contaning all stream informations (url, protData, adsUrl)\n    */\n    load (stream, callback) {\n        if (stream.adsUrl) {\n            this._adsPlayerController.load(stream.adsUrl).then(function () {\n                callback();\n            }).catch(function () {\n                callback();\n            });\n        } else {\n            callback();\n        }\n    }\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * This method is invoked when the current stream is to be stopped.\n    * @method stop\n    * @access public\n    * @memberof AdsPlayer#\n    */\n    stop () {\n        this._adsPlayerController.stop();\n    }\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * This method is invoked when the player is to be reset.\n    * @method reset\n    * @access public\n    * @memberof AdsPlayer#\n    */\n    reset () {\n        this._adsPlayerController.reset();\n    }\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * This method is invoked when this plugin is being removed/destroyed.\n    * @method destroy\n    * @access public\n    * @memberof AdsPlayer#\n    */\n    destroy () {\n        this._adsPlayerController.destroy();\n        this._eventBus.removeEventListener('error', this.onErrorListener);\n        this._eventBus.removeEventListener('warning', this.onWarningListener);\n    }\n\n    // AdsPlayer additionnal API\n\n    /**\n    * Returns the plugin version.\n    * @method getVersion\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {string} the plugin version\n    */\n    getVersion () {\n        return VERSION;\n    }\n\n    /**\n    * Returns the full plugin version, including git revision\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {string} the full plugin version, including git revision\n    */\n    getVersionFull  () {\n        if (GIT_TAG.indexOf(\"@@\") === -1) {\n            return VERSION + '_' + GIT_TAG;\n        } else {\n            return VERSION;\n        }\n    }\n\n    /**\n    * Returns the build date.\n    * @method getBuildDate\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {string} the build date\n    */\n    getBuildDate () {\n        if (BUILD_DATE.indexOf(\"@@\") === -1) {\n            return BUILD_DATE;\n        } else {\n            return 'Not a builded version';\n        }\n    }\n\n    /**\n    * Plays/resumes the playback of the current ad.\n    * @method pause\n    * @access public\n    * @memberof AdsPlayer#\n    */\n    play () {\n        this._adsPlayerController.play();\n    }\n\n    /**\n    * Pauses the playback of the current ad.\n    * @method pause\n    * @access public\n    * @memberof AdsPlayer#\n    */\n    pause () {\n        this._adsPlayerController.pause();\n    }\n\n    /**\n    * Registers a listener on the specified event.\n    * The possible event types are:\n    * <li>'error' (see [error]{@link AdsPlayer#event:error} event specification)\n    * <li>'warning' (see [warning]{@link AdsPlayer#event:warning} event specification)\n    * <li>'start' (see [start]{@link AdsPlayer#event:start} event specification)\n    * <li>'end' (see [end]{@link AdsPlayer#event:end} event specification)\n    * <li>'click' (see [click]{@link AdsPlayer#event:click} event specification)\n    * @method addEventListener\n    * @access public\n    * @memberof AdsPlayer#\n    * @param {string} type - the event type for listen to\n    * @param {callback} listener - the callback which is called when an event of the specified type occurs\n    * @param {boolean} useCapture - see HTML DOM addEventListener() method specification\n    */\n    addEventListener (type, listener, useCapture) {\n        this._eventBus.addEventListener(type, listener, useCapture);\n    }\n\n    /**\n    * Unregisters the listener previously registered with the addEventListener() method.\n    * @method removeEventListener\n    * @access public\n    * @memberof AdsPlayer#\n    * @see [addEventListener]{@link AdsPlayer#addEventListener}\n    * @param {string} type - the event type on which the listener was registered\n    * @param {callback} listener - the callback which was registered to the event type\n    */\n    removeEventListener (type, listener) {\n        this._eventBus.removeEventListener(type, listener);\n    }\n\n    /**\n    * Returns the Error object for the most recent error.\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {object} the Error object for the most recent error, or null if there has not been an error\n    */\n    getError () {\n        return this._error;\n    }\n\n    /**\n    * Returns the Warning object for the most recent warning.\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {object} the Warning object for the most recent warning, or null if there has not been a warning\n    */\n    getWarning () {\n        return this._warning;\n    }\n}\n\n// /**\n//  * @class\n//  * @classdesc AdsPlayer\n//  */\n// AdsPlayer.prototype = {\n//     constructor: AdsPlayer\n// };\n\n// AdsPlayer.mast = {};\n// AdsPlayer.mast.model = {};\n// AdsPlayer.mast.model.Trigger = {};\n// AdsPlayer.mast.model.Trigger.Condition = {};\n// AdsPlayer.vast = {};\n// AdsPlayer.vast.model = {};\n// AdsPlayer.vast.model.Vast = {};\n// AdsPlayer.media = {};\n// AdsPlayer.utils = {};\n\n\n\n/////////// EVENTS\n\n/**\n* The 'start' event is fired when the playback of ad(s) is starting.\n* When the 'start' event is fired, the application shall hide the main player component and\n* display the ads player container in which the ad media player component(s) will be created\n* and displayed.\n*\n* @event AdsPlayer#start\n* @param {object} event - the event\n* @param {object} event.type - the event type ('start')\n*/\n\n/**\n* The 'end' event is fired when the playback of ad(s) has ended.\n* When the 'end' event is fired, the application shall display the main player component and\n* hide the ads player container.\n*\n* @event AdsPlayer#end\n* @param {object} event - the event\n* @param {object} event.type - the event type ('end')\n*/\n\n/**\n* The 'addElement' event is fired when a DOM element for playing an ad has been created\n* and will be appended in the ads player container.\n* The element can be either a &lt;video&gt; or an &lt;img&gt; element.\n*\n* @event AdsPlayer#addElement\n* @param {object} event - the event\n* @param {object} event.type - the event type ('addElement')\n* @param {object} event.data - the event data\n* @param {string} event.data.element - the created element\n* @param {string} event.data.type - the type of the element, 'video' for &lt;video&gt; or 'image' for &lt;img&gt;\n*/\n\n/**\n* The 'removeElement' event is fired when the DOM element for playing an ad is being removed\n* from the ads player container and deleted.\n*\n* @event AdsPlayer#removeElement\n* @param {object} event - the event\n* @param {object} event.type - the event type ('removeElement')\n* @param {object} event.data - the event data\n* @param {string} event.data.element - the created element\n* @param {string} event.data.type - the type of the element, 'video' for &lt;video&gt; or 'image' for &lt;img&gt;\n*/\n\n/**\n* The 'play' event is fired when the playback of media ad is starting.\n*\n* @event AdsPlayer#play\n* @param {object} event - the event\n* @param {object} event.type - the event type ('play')\n*/\n\n/**\n* The 'pause' event is fired when the playback of an ad is paused.\n*\n* @event AdsPlayer#pause\n* @param {object} event - the event\n* @param {object} event.type - the event type ('pause')\n*/\n\n/**\n* The 'click' event is fired when a click has been performed on the ad component.\n* When the 'click' event is fired, the application shall open the web page with the provided URI.\n*\n* @event AdsPlayer#click\n* @param {object} event - the event\n* @param {object} event.type - the event type ('click')\n* @param {object} event.data - the event data\n* @param {string} event.data.uri - the web page uri\n*/\n\n/**\n* The error event is fired when an error occurs.\n* When the error event is fired, the application shall stop the player.\n*\n* @event AdsPlayer#error\n* @param {object} event - the event\n* @param {object} event.type - the event type ('error')\n* @param {object} event.data - the event data\n* @param {string} event.data.code - error code\n* @param {string} event.data.message - error message\n* @param {object} event.data.data - error additionnal data\n*/\n\n/**\n* The warning event is fired when a warning occurs.\n*\n* @event AdsPlayer#warning\n* @param {object} event - the event\n* @param {object} event.type - the event type ('warning')\n* @param {object} event.data - the event data\n* @param {string} event.data.code - warning code\n* @param {string} event.data.message - warning message\n* @param {object} event.data.data - warning additionnal data\n*/\n\nexport default AdsPlayer;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* AdsPlayerController is th main controller class for AdsPlayer module.\n* It is in charge of downloading the MAST/VAST files and orchestrates the\n* detection of triggers and playing of ad(s).\n*/\n\nimport Debug from './Debug';\nimport FileLoader from './FileLoader';\nimport ErrorHandler from './ErrorHandler';\nimport EventBus from './EventBus';\nimport MastParser from './mast/MastParser';\nimport TriggerManager from './mast/TriggerManager';\nimport VastParser from './vast/VastParser';\nimport VastPlayerManager from './vast/VastPlayerManager';\n\n\nclass AdsPlayerController {\n\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _loadVast (url) {\n        var fileLoader = new FileLoader(),\n            vast = null;\n\n        return new Promise((resolve/*, reject*/) => {\n            this._debug.log(\"Download VAST file: \" + url);\n            fileLoader.load(url).then(result => {\n                    this._debug.log(\"Parse VAST file\");\n                    vast = this._vastParser.parse(result.response);\n                    vast.baseUrl = result.baseUrl;\n                    resolve(vast);\n                }).catch(error => {\n                    if (error) {\n                        this._errorHandler.sendWarning(ErrorHandler.LOAD_VAST_FAILED, \"Failed to load VAST file\", error);\n                    }\n                    resolve(null);\n                }\n            );\n            this._fileLoaders.push(fileLoader);\n        });\n    }\n\n    _loadTriggerVasts (trigger) {\n        var loadVastPromises = [],\n            i,\n            uri;\n\n        for (i = 0; i < trigger.sources.length; i++) {\n            uri = trigger.sources[i].uri;\n            // Check for relative uri path\n            if (uri.indexOf('http://') === -1) {\n                uri = this._mast.baseUrl + uri;\n            }\n            loadVastPromises.push(this._loadVast(uri));\n        }\n\n        return new Promise((resolve, reject) => {\n            Promise.all(loadVastPromises).then(vasts => {\n                // Push vast objects in the trigger in the original order\n                // (this = promises returned objects)\n                for (var i = 0; i < vasts.length; i++) {\n                    if (vasts[i] && vasts[i].ad) {\n                        trigger.vasts.push(vasts[i]);\n                    }\n                }\n                resolve();\n            }).catch(() => {\n                reject();\n            });\n        });\n    }\n\n    _parseMastFile (mastContent, mastBaseUrl) {\n        var triggerManager,\n            i;\n\n        // Parse the MAST file\n        this._mast = this._mastParser.parse(mastContent);\n\n        if (!this._mast) {\n            return;\n        }\n\n        // Store base URL for subsequent VATS files download\n        this._mast.baseUrl = mastBaseUrl;\n\n        // Initialize the trigger managers\n        for (i = 0; i < this._mast.triggers.length; i++) {\n            triggerManager = new TriggerManager();\n            triggerManager.init(this._mast.triggers[i]);\n            this._triggerManagers.push(triggerManager);\n        }\n    }\n\n    _onVideoPlaying () {\n        if (this._vastPlayerManager) {\n            this._debug.log(\"Pause main video\");\n            this._mainVideo.pause();\n        }\n    }\n\n    _onVideoTimeupdate () {\n        var trigger = this._checkTriggersStart();\n        if (trigger !== null) {\n            this._activateTrigger(trigger);\n        }\n    }\n\n    _onVideoEnded () {\n        // Check for end-roll triggers\n        var trigger = this._checkTriggersStart();\n        if (trigger !== null) {\n            this._activateTrigger(trigger);\n        }\n\n        this._checkTriggersEnd();\n    }\n\n    _pauseVideo  () {\n        if (!this._mainVideo.paused) {\n            this._debug.log(\"Pause main video\");\n            this._mainVideo.pause();\n        }\n    }\n\n    _resumeVideo  () {\n        if (this._mainVideo.paused) {\n            this._debug.log(\"Resume main video\");\n            this._mainVideo.play();\n        }\n    }\n\n    _onTriggerEnd  () {\n        this._debug.log('End playing trigger');\n\n        // Delete VAST player manager\n        if (this._vastPlayerManager) {\n            this._vastPlayerManager.reset();\n            this._vastPlayerManager = null;\n        }\n\n        // Check if another trigger has to be activated\n        var trigger = this._checkTriggersStart();\n        if (trigger !== null) {\n            this._activateTrigger(trigger);\n        } else {\n            // Notifies the application ad(s) playback has ended\n            this._eventBus.dispatchEvent({type: 'end', data: null});\n\n            if (!this._mainVideo.ended) {\n                // Resume the main video element\n                this._resumeVideo();\n            }\n        }\n    }\n\n    _playTrigger  (trigger) {\n        if (trigger.vasts.length === 0) {\n            return;\n        }\n\n        // Pause the main video element\n        this._pauseVideo();\n\n        // Notifies the application ad(s) playback starts\n        this._eventBus.dispatchEvent({type: 'start', data: null});\n\n        // Play the trigger\n        this._debug.log('Start playing trigger ' + trigger.id);\n        this._vastPlayerManager = new VastPlayerManager();\n        this._vastPlayerManager.init(trigger.vasts, this._adsPlayerContainer, this._mainVideo);\n        this._vastPlayerManager.start();\n    }\n\n    _activateTrigger  (trigger) {\n\n        // Check if a trigger is not already activated\n        if (this._vastPlayerManager) {\n            return;\n        }\n\n        this._debug.log('Activate trigger ' + trigger.id);\n\n        trigger.activated = true;\n\n        if (trigger.vasts.length === 0) {\n            // Download VAST files\n            this._loadTriggerVasts(trigger).then(() => {\n                this._playTrigger(trigger);\n            });\n        } else {\n            this._playTrigger(trigger);\n        }\n    }\n\n    _checkTriggersStart () {\n        for (var i = 0; i < this._triggerManagers.length; i++) {\n            if (this._triggerManagers[i].checkStartConditions(this._mainVideo)) {\n                return this._triggerManagers[i].getTrigger();\n            }\n        }\n        return null;\n    }\n\n    _checkTriggersEnd () {\n        for (var i = 0; i < this._triggerManagers.length; i++) {\n            if (this._triggerManagers[i].checkEndConditions(this._mainVideo)) {\n                // Remove trigger manager => will not be activated anymore\n                this._triggerManagers.splice(0, 1);\n                i--;\n            }\n        }\n    }\n\n    _start () {\n        if (!this._mast) {\n            return;\n        }\n\n        if (this._mast.triggers.length === 0) {\n            this._debug.warn('No trigger in MAST');\n        }\n\n        // Check for pre-roll trigger\n        var trigger = this._checkTriggersStart();\n        if (trigger !== null) {\n            this._activateTrigger(trigger);\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor () {\n\n        this._mainPlayer = null;\n        this._mainVideo = null;\n        this._adsPlayerContainer = null;\n        this._mast = null;\n        this._fileLoaders = [];\n        this._triggerManagers = [];\n        this._vastPlayerManager = null;\n        this._mastParser = new MastParser();\n        this._vastParser = new VastParser();\n        this._errorHandler = ErrorHandler.getInstance();\n        this._debug = Debug.getInstance();\n        this._eventBus = EventBus.getInstance();\n\n        this._onVideoPlayingListener = this._onVideoPlaying.bind(this);\n        this._onVideoTimeupdateListener = this._onVideoTimeupdate.bind(this);\n        this._onVideoEndedListener = this._onVideoEnded.bind(this);\n        this._onTriggerEndListener = this._onTriggerEnd.bind(this);\n    }\n\n    /**\n     * Initialize the Ads Player Controller.\n     * @method init\n     * @access public\n     * @memberof AdsPlayerController#\n     * @param {Object} mainVideo - the HTML5 video element used by the main media player\n     * @param {Object} adsPlayerContainer - The container to create the HTML5 video/image elements used to play and render the ads media\n     */\n    init (player, adsPlayerContainer) {\n        this._mainPlayer = player;\n        this._mainVideo = player.getVideoModel().getElement();\n        this._adsPlayerContainer = adsPlayerContainer;\n\n        // Add <video> event listener\n        this._mainVideo.addEventListener('playing', this._onVideoPlayingListener);\n        this._mainVideo.addEventListener('timeupdate', this._onVideoTimeupdateListener);\n        this._mainVideo.addEventListener('seeking', this._onVideoTimeupdateListener);\n        this._mainVideo.addEventListener('ended', this._onVideoEndedListener);\n\n        // Add trigger end event listener\n        this._eventBus.addEventListener('triggerEnd', this._onTriggerEndListener);\n\n        this._debug.setLevel(4);\n    }\n\n\n    /**\n     * Load/open a MAST file.\n     * @method load\n     * @access public\n     * @memberof AdsPlayerController#\n     * @param {string} mastUrl - the MAST file url\n     */\n    load (url) {\n        let fileLoader = new FileLoader();\n\n        // Reset the MAST and trigger managers\n        this._mast = null;\n        this._triggerManagers = [];\n\n        // Download and parse MAST file\n        this._debug.log(\"Download MAST file: \" + url);\n\n        return new Promise((resolve, reject) => {\n            fileLoader.load(url).then(result => {\n                this._debug.log(\"Parse MAST file\");\n                this._parseMastFile(result.response, result.baseUrl);\n                // Start managing triggers and ads playing\n                this._debug.log(\"Start\");\n                this._start();\n                resolve();\n            }).catch(error => {\n                if (error) {\n                    this._errorHandler.sendError(error.name, error.message, error.data);\n                    reject(error);\n                } else {\n                    resolve();\n                }\n            });\n            this._fileLoaders.push(fileLoader);\n        });\n    }\n\n    /**\n     * Stops and resets the Ads player.\n     * @method reset\n     * @access public\n     * @memberof AdsPlayerController#\n     */\n    stop () {\n\n        this._debug.log(\"Stop\");\n\n        // Stop/abort the file loaders\n        for (var i = 0; i < this._fileLoaders.length; i++) {\n            this._fileLoaders[i].abort();\n        }\n        this._fileLoaders = [];\n\n        // Stop the ad player\n        if (this._vastPlayerManager) {\n            this._vastPlayerManager.stop();\n            this._vastPlayerManager.reset();\n            this._vastPlayerManager = null;\n\n            // Notifies the application ad(s) playback has ended\n            this._eventBus.dispatchEvent({type: 'end', data: null});\n        }\n    }\n\n    reset () {\n\n        this._debug.log(\"Reset\");\n\n        this.stop();\n\n        // Reset the trigger managers\n        this._triggerManagers = [];\n\n        // Reset the MAST\n        this._mast = null;\n    }\n\n    destroy () {\n\n        this._debug.log(\"Destroy\");\n\n        this.reset();\n\n        // Remove <video> event listener\n        this._mainVideo.removeEventListener('playing', this._onVideoPlayingListener);\n        this._mainVideo.removeEventListener('timeupdate', this._onVideoTimeupdateListener);\n        this._mainVideo.removeEventListener('seeking', this._onVideoTimeupdateListener);\n        this._mainVideo.removeEventListener('ended', this._onVideoEndedListener);\n\n        // Remove trigger end event listener\n        this._eventBus.removeEventListener('triggerEnd', this._onTriggerEndListener);\n    }\n\n    /**\n     * Plays/resumes the playback of the current ad.\n     * @method reset\n     * @access public\n     * @memberof AdsPlayerController#\n     */\n    play () {\n\n        this._debug.log(\"Play\");\n        // Play the ad player\n        if (this._vastPlayerManager) {\n            this._vastPlayerManager.play();\n        }\n    }\n\n    /**\n     * Pauses the playback of the current ad.\n     * @method reset\n     * @access public\n     * @memberof AdsPlayerController#\n     */\n    pause () {\n\n        this._debug.log(\"Pause\");\n        // Stop the ad player\n        if (this._vastPlayerManager) {\n            this._vastPlayerManager.pause();\n        }\n    }\n}\n\nexport default AdsPlayerController;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* Debug utility class.\n*/\nDate.prototype.HHMMSSmmm = function() {\n\n    var h = this.getHours().toString(),\n        m = this.getMinutes().toString(),\n        s = this.getSeconds().toString(),\n        ms = this.getMilliseconds().toString(),\n        HH = h[1] ? h : \"0\" + h[0],\n        MM = m[1] ? m : \"0\" + m[0],\n        SS = s[1] ? s : \"0\" + s[0],\n        mmm = ms[2] ? ms : \"0\" + (ms[1] ? ms : \"0\" + ms[0]);\n\n    return HH + \":\" + MM + \":\" + SS + \".\" + mmm;\n};\n\nDate.prototype.MMSSmmm = function() {\n\n    var m = this.getMinutes().toString(),\n        s = this.getSeconds().toString(),\n        ms = this.getMilliseconds().toString(),\n        MM = m[1] ? m : \"0\" + m[0],\n        SS = s[1] ? s : \"0\" + s[0],\n        mmm = ms[2] ? ms : \"0\" + (ms[1] ? ms : \"0\" + ms[0]);\n\n    return MM + \":\" + SS + \".\" + mmm;\n};\n\n// MemoryLogger definition\n\nvar MemoryLogger = function() {\n    // array to store logs\n    this.logArray = [];\n    // boolean to set leve in message\n    this.showLevel = true;\n};\n\nMemoryLogger.prototype.error =\n    MemoryLogger.prototype.warn =\n    MemoryLogger.prototype.info =\n    MemoryLogger.prototype.debug = function(message) {\n        this.logArray.push(message);\n};\n\nMemoryLogger.prototype.getLogs = function() {\n    return this.logArray;\n};\n\n\nconst NONE = 0;\nconst ERROR = 1;\nconst WARN = 2;\nconst INFO = 3;\nconst DEBUG = 4;\nconst ALL = 4;\n\n\nlet _instance = null;\n\nclass Debug {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _getStringLevel(level) {\n        switch (level) {\n            case NONE:\n                return \"\";\n            case ERROR:\n                return \"ERROR\";\n            case WARN:\n                return \"WARN\";\n            case INFO:\n                return \"INFO\";\n            case DEBUG:\n            case ALL:\n                return \"DEBUG\";\n            default:\n                return \"\";\n        }\n    }\n\n    _prepareLog(logLevel, args) {\n        let message = \"\",\n            logTime = null;\n\n        if (this.showTimestamp) {\n            logTime = new Date();\n            message += \"[\" + logTime.HHMMSSmmm() + \"]\";\n        }\n\n        if (this._logger && this._logger.showLevel) {\n            message += \"[\" + this._getStringLevel(logLevel) + \"]\";\n        }\n\n        if (this.showElapsedTime) {\n            message += \"[\" + new Date(logTime - this._startTime).MMSSmmm() + \"]\";\n        }\n\n        message += \"[AdsPlayer] \";\n\n        Array.apply(null, args).forEach(function(item) {\n            message += item + \" \";\n        });\n\n        return message;\n    }\n\n    _log (logLevel, args) {\n        if (logLevel <= this.getLevel()) {\n\n            let message = this._prepareLog(logLevel, args);\n\n            switch (logLevel) {\n                case ERROR:\n                    this._logger.error(message);\n                    break;\n                case WARN:\n                    this._logger.warn(message);\n                    break;\n                case INFO:\n                    this._logger.info(message);\n                    break;\n                case DEBUG:\n                    this._logger.debug(message);\n                    break;\n            }\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    static getInstance() {\n        if (_instance === null) {\n            _instance = new Debug();\n        }\n\n        return _instance;\n    }\n\n    constructor() {\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._level = 4;\n        this._showTimestamp = true;\n        this._showElapsedTime = false;\n        this._startTime = new Date();\n        this._logger = console;\n\n        _instance = this;\n        return _instance;\n    }\n\n    getLevel () {\n        return this._level;\n    }\n\n    setLevel (value) {\n        this._level = value;\n    }\n\n    getLogger () {\n        return this._logger;\n    }\n\n    setLogger (type) {\n        switch (type) {\n            case 'memory':\n                this._logger = new MemoryLogger();\n                break;\n\n            case 'console':\n                this._logger = console;\n                break;\n\n            default:\n                this._logger = null;\n        }\n    }\n\n    error() {\n        this._log(ERROR, arguments);\n    }\n\n    warn () {\n        this._log(WARN, arguments);\n    }\n\n    info () {\n        this._log(INFO, arguments);\n    }\n\n    // Keep this function for compatibility\n    log () {\n        this._log(DEBUG, arguments);\n    }\n}\n\nexport default Debug;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* Errors and warning notifications handler.\n*/\n\nimport Debug from './Debug';\nimport EventBus from './EventBus';\n\nlet _instance = null;\n\n\nclass ErrorHandler {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    static getInstance() {\n        if (_instance === null) {\n            _instance = new ErrorHandler();\n        }\n\n        return _instance;\n    }\n\n    constructor() {\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._eventBus = EventBus.getInstance();\n        this._debug = Debug.getInstance();\n\n        _instance = this;\n        return _instance;\n    }\n\n    /**\n     * [sendWarning description]\n     * @param  {[type]} code    [description]\n     * @param  {[type]} message [description]\n     * @param  {[type]} data    [description]\n     * @return {[type]}         [description]\n     */\n    sendWarning (code, message, data) {\n        this._eventBus.dispatchEvent({\n            type: 'warning',\n            data: {\n                code: code,\n                message: message,\n                data: data\n            }\n        });\n        this._debug.warn(\"[Warn] Code: \" + code + \", Message: \" + message + \", Data: \" + JSON.stringify(data, null, '\\t'));\n    }\n\n    /**\n     * [sendError description]\n     * @param  {[type]} code    [description]\n     * @param  {[type]} message [description]\n     * @param  {[type]} data    [description]\n     * @return {[type]}         [description]\n     */\n    sendError (code, message, data) {\n        this._eventBus.dispatchEvent({\n            type: 'error',\n            data: {\n                code: code,\n                message: message,\n                data: data\n            }\n        });\n        this._debug.error(\"[Error] Code: \" + code + \", Message: \" + message + \", Data: \" + JSON.stringify(data, null, '\\t'));\n    }\n}\n\n// File Loader errors\nErrorHandler.DOWNLOAD_ERR_FILES = \"DOWNLOAD_ERR_FILES\";\nErrorHandler.DOWNLOAD_ERR_NOT_XML = \"DOWNLOAD_ERR_NOT_XML\";\n\nErrorHandler.LOAD_VAST_FAILED = \"LOAD_VAST_FAILED\";\n\n// Media Player errors\nErrorHandler.NO_VALID_MEDIA_FOUND = \"NO_VALID_MEDIA_FOUND\";\nErrorHandler.LOAD_MEDIA_FAILED = \"LOAD_MEDIA_FAILED\";\nErrorHandler.UNSUPPORTED_MEDIA_FILE = \"UNSUPPORTED_MEDIA_FILE\";\nErrorHandler.UNAVAILABLE_LINK = \"UNAVAILABLE_LINK\";\n\nexport default ErrorHandler;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* Event bus utility class for events listening and notifying.\n*/\n\nimport Debug from './Debug';\n\nlet _instance = null;\n\nclass EventBus {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n\n    _getListeners (type, useCapture) {\n        if (useCapture === undefined) { // to provide a default parameter that works !!\n            useCapture = false;\n        }\n        var captype = (useCapture ? '1' : '0') + type;\n\n        if (!(captype in this._registrations)) {\n            this._registrations[captype] = [];\n        }\n\n        return this._registrations[captype];\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    static getInstance() {\n        if (_instance === null) {\n            _instance = new EventBus();\n        }\n\n        return _instance;\n    }\n\n    constructor() {\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._registrations = {};\n        this._debug = Debug.getInstance();\n\n        _instance = this;\n        return _instance;\n    }\n\n    /**\n     * [addEventListener description]\n     * @param {[type]} type       [description]\n     * @param {[type]} listener   [description]\n     * @param {[type]} useCapture [description]\n     */\n    addEventListener (type, listener, useCapture) {\n        var listeners = this._getListeners(type, useCapture),\n            idx = listeners.indexOf(listener);\n\n        if (idx === -1) {\n            listeners.push(listener);\n        }\n    }\n\n    /**\n     * [removeEventListener description]\n     * @param  {[type]} type       [description]\n     * @param  {[type]} listener   [description]\n     * @param  {[type]} useCapture [description]\n     * @return {[type]}            [description]\n     */\n    removeEventListener (type, listener, useCapture) {\n        var listeners = this._getListeners(type, useCapture),\n            idx = listeners.indexOf(listener);\n\n        if (idx !== -1) {\n            listeners.splice(idx, 1);\n        }\n    }\n\n    /**\n     * [dispatchEvent description]\n     * @param  {[type]} evt [description]\n     * @return {[type]}     [description]\n     */\n    dispatchEvent (evt) {\n        var listeners = this._getListeners(evt.type, false).slice(),\n            i = 0;\n\n        for (i = 0; i < listeners.length; i += 1) {\n            listeners[i].call(this, evt);\n        }\n        return !evt.defaultPrevented;\n    }\n}\n\nexport default EventBus;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* File downloader utility class.\n*/\n\nimport ErrorHandler from './ErrorHandler';\n\nclass FileLoader {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _parseBaseUrl (url) {\n        var base = null;\n\n        if (url.indexOf(\"/\") !== -1) {\n            if (url.indexOf(\"?\") !== -1) {\n                url = url.substring(0, url.indexOf(\"?\"));\n            }\n            base = url.substring(0, url.lastIndexOf(\"/\") + 1);\n        }\n\n        return base;\n    }\n\n    _parseXml (data) {\n\n        if (!window.DOMParser) {\n            return null;\n        }\n\n        try {\n            let parser = new window.DOMParser();\n\n            let xmlDoc = parser.parseFromString(data, \"text/xml\");\n            if (xmlDoc.getElementsByTagName('parsererror').length > 0) {\n                throw new Error('Error parsing XML');\n            }\n            return xmlDoc;\n        } catch (e) {\n            return null;\n        }\n    }\n\n    _abort () {\n        if (this._request !== null && this._request.readyState > 0 && this._request.readyState < 4) {\n            this._request.abort();\n        }\n    }\n\n    _load (url, resolve, reject) {\n        let baseUrl = this._parseBaseUrl(url),\n            needFailureReport = true,\n            onload = null,\n            report = null,\n            onabort = null,\n            self = this;\n\n        onabort = function() {\n            this.aborted = true;\n        };\n\n        onload = function() {\n            if (this.status < 200 || this.status > 299) {\n                return;\n            }\n\n            if (this.status === 200 && this.readyState === 4) {\n\n                // Parse responseText in case of wrong response Content-Type\n                let xmlDoc = this.responseXML || self._parseXml(this.responseText);\n\n                // Check if response is in XML format.\n                if (xmlDoc === null) {\n                    needFailureReport = true;\n                    return;\n                }\n\n                // Get the redirection URL and use it as base URL\n                if (this.responseURL) {\n                    baseUrl = self._parseBaseUrl(this.responseURL);\n                }\n\n                needFailureReport = false;\n\n                // Return XML DOM (as input to parsers)\n                resolve({\n                    response: xmlDoc,\n                    baseUrl: baseUrl\n                });\n\n            }\n        };\n\n        report = function() {\n            if (!needFailureReport) {\n                return;\n            }\n            needFailureReport = false;\n\n            if (this.aborted) {\n                // Request has been aborted => reject without error\n                reject();\n            } else if (this.status < 200 || this.status > 299) {\n                // Request has failed => reject with error\n                reject({\n                    name: ErrorHandler.DOWNLOAD_ERR_FILES,\n                    message: \"Failed to download file\",\n                    data: {\n                        url: url,\n                        status: this.status\n                    }\n                });\n            } else if (this.responseXML === null) {\n                // Response was not in XML format => reject with error\n                reject({\n                    name: ErrorHandler.DOWNLOAD_ERR_NOT_XML,\n                    message: \"The downloaded file format is not in xml format\",\n                    data: {\n                        url: url\n                    }\n                });\n            }\n        };\n\n        try {\n            this._request = new XMLHttpRequest();\n            this._request.onload = onload;\n            this._request.onloadend = report;\n            this._request.onerror = report;\n            this._request.onabort = onabort;\n            this._request.open(\"GET\", url, true);\n            this._request.timeout = 10000;\n            this._request.send();\n        } catch (e) {\n            this._request.onerror();\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._request = null;\n    }\n\n    load (url) {\n        return new Promise((resolve, reject) => {\n            this._load(url, resolve, reject);\n        });\n    }\n\n    abort () {\n        if (this._request !== null &&\n            this._request.readyState > 0 &&\n            this._request.readyState < 4) {\n            this._request.abort();\n        }\n    }\n}\n\nexport default FileLoader;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* MAST parser. This class parses MAST file in XML format\n* and construct the corresponding MAST object according to MAST data model.\n*/\n\nimport mast from './model/Mast';\nimport xmldom from '../utils/xmldom';\n\nclass MastParser {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _getCondition (conditionNode) {\n        let condition = new mast.Condition(),\n            conditionNodes;\n\n        condition.type = conditionNode.getAttribute('type');\n        condition.name = conditionNode.getAttribute('name');\n        condition.value = conditionNode.getAttribute('value');\n        condition.operator = conditionNode.getAttribute('operator');\n        conditionNodes = conditionNode.getElementsByTagName('condition');\n        for (let i = 0; i < conditionNodes.length; i++) {\n            condition.conditions.push(this._getCondition(conditionNodes[i]));\n        }\n\n        return condition;\n    }\n\n    _getSource (sourceNode) {\n        let source = new mast.Source(),\n            sourceNodes;\n\n        source.uri = sourceNode.getAttribute('uri');\n        source.altReference = sourceNode.getAttribute('altReference');\n        source.format = sourceNode.getAttribute('format');\n        sourceNodes = sourceNode.getElementsByTagName('source');\n        for (let i = 0; i < sourceNodes.length; i++) {\n            source.sources.push(this._getSource(sourceNodes[i]));\n        }\n\n        return source;\n    }\n\n    _getTrigger (triggerNode) {\n        let trigger = new mast.Trigger(),\n            startConditionNodes = xmldom.getSubElements(triggerNode, 'startConditions', 'condition'),\n            endConditionNodes = xmldom.getSubElements(triggerNode, 'endConditions', 'condition'),\n            sourceNodes = xmldom.getSubElements(triggerNode, 'sources', 'source'),\n            i;\n\n        trigger.id = triggerNode.getAttribute('id');\n        trigger.description = triggerNode.getAttribute('description');\n\n        for (i = 0; i < startConditionNodes.length; i++) {\n            trigger.startConditions.push(this._getCondition(startConditionNodes[i]));\n        }\n\n        for (i = 0; i < endConditionNodes.length; i++) {\n            trigger.endConditions.push(this._getCondition(endConditionNodes[i]));\n        }\n\n        for (i = 0; i < sourceNodes.length; i++) {\n            trigger.sources.push(this._getSource(sourceNodes[i]));\n        }\n\n        return trigger;\n    }\n\n    _getTriggers (mastNode, mast) {\n        let triggerNodes = xmldom.getSubElements(mastNode, 'triggers', 'trigger');\n\n        for (let i = 0; i < triggerNodes.length; i++) {\n            mast.triggers.push(this._getTrigger(triggerNodes[i]));\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n    }\n\n    /**\n    * Parses the MAST xml file and get the triggers.\n    * @param {object} xmlDom - the XML DOM to parse\n    */\n    parse (xmlDom) {\n        let mast_ = new mast.Mast(),\n            mastNode = xmldom.getElement(xmlDom, 'MAST');\n\n        if (mastNode === null) {\n            return mast_;\n        }\n\n        this._getTriggers(mastNode, mast_);\n\n        return mast_;\n    }\n}\n\n\nexport default MastParser;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The TriggerManager manages the detection of the start and end of a trigger.\n* It takes as input a trigger object (as parsed from a MAST file) and tests the start and end conditions\n* to detect the activation and revocation of a trigger.\n*/\n\nimport { Condition } from './model/Mast';\n\nclass TriggerManager {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _parseTime (str) {\n        var timeParts,\n            SECONDS_IN_HOUR = 60 * 60,\n            SECONDS_IN_MIN = 60;\n\n        if (!str) {\n            return -1;\n        }\n\n        timeParts = str.split(':');\n\n        // Check time format, must be HH:MM:SS(.mmm)\n        if (timeParts.length !== 3) {\n            return -1;\n        }\n\n        return  (parseInt(timeParts[0]) * SECONDS_IN_HOUR) +\n                (parseInt(timeParts[1]) * SECONDS_IN_MIN) +\n                (parseFloat(timeParts[2]));\n    }\n\n    _compareValues (value1, value2, operator) {\n        var res = false;\n\n        if (value1 < 0 || value2 < 0) {\n            return false;\n        }\n\n        switch (operator) {\n            case Condition.OPERATOR.EQ:\n                res = (value1 === value2);\n                break;\n            case Condition.OPERATOR.NEQ:\n                res = (value1 !== value2);\n                break;\n            case Condition.OPERATOR.GTR:\n                res = (value1 > value2);\n                break;\n            case Condition.OPERATOR.GEQ:\n                res = (value1 >= value2);\n                break;\n            case Condition.OPERATOR.LT:\n                res = (value1 < value2);\n                break;\n            case Condition.OPERATOR.LEQ:\n                res = (value1 <= value2);\n                break;\n            case Condition.OPERATOR.MOD:\n                res = ((value1 % value2) === 0);\n                break;\n            default:\n                break;\n        }\n        return res;\n    }\n\n    _evaluateCondition (condition, video) {\n        var res = false,\n            i;\n\n        // Check pre-roll condition for activation\n        if (video.currentTime === 0 && condition.type === Condition.TYPE.EVENT && condition.name === Condition.NAME.ON_ITEM_START) {\n            res = true;\n        }\n\n        // Check mid-roll condition for activation\n        if (condition.type === Condition.TYPE.PROPERTY) {\n            switch (condition.name) {\n                case Condition.NAME.POSITION:\n                    res = this._compareValues(video.currentTime, this._parseTime(condition.value), condition.operator);\n                    break;\n                case Condition.NAME.DURATION:\n                    res = this._compareValues(video.duration, this._parseTime(condition.value), condition.operator);\n                    break;\n                default:\n                    break;\n            }\n        }\n\n        // Check condition for revocation\n        if (video.ended && condition.type === Condition.TYPE.EVENT && condition.name === Condition.NAME.ON_ITEM_END) {\n            res = true;\n        }\n\n        // AND with sub-conditions\n        // MAST spec. : \"Child conditions are treated as an implicit AND, all children of a condition must evaluate true before a trigger will fire (or be revoked) from that condition.\"\n        for (i = 0; i < condition.conditions.length; i++) {\n            res &= this._evaluateCondition(condition.conditions[i], video);\n        }\n\n        return res;\n    }\n\n    _evaluateConditions (conditions, video) {\n        var res = false,\n            i;\n\n        // Evaluate each condition\n        // MAST spec. : \"Multiple condition elements are treated as an implicit OR, any one of them evaluating true will fire the trigger.\"\n        for (i = 0; i < conditions.length; i++) {\n            res |=  this._evaluateCondition(conditions[i], video);\n        }\n\n        return res;\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._trigger = null;\n    }\n\n    /**\n     * Initializes the TriggerManager.\n     * @method init\n     * @access public\n     * @memberof TriggerManager#\n     * @param {Object} trigger - the trigger to handle by this manager\n     */\n    init (trigger) {\n        this._trigger = trigger;\n    }\n\n    /**\n     * Returns the trigger object managed by this TriggerManager.\n     * @method init\n     * @access public\n     * @memberof TriggerManager#\n     * @return {Object} the managed trigger object\n     */\n    getTrigger () {\n        return this._trigger;\n    }\n\n    /**\n     * Evaluates the trigger start conditions.\n     * @method checkStartConditions\n     * @access public\n     * @memberof TriggerManager#\n     * @param {Number} video - the main video element\n     */\n    checkStartConditions (video) {\n        if (this._trigger.activated) {\n            return false;\n        }\n        return this._evaluateConditions(this._trigger.startConditions, video);\n    }\n\n    /**\n     * Evaluates the trigger end conditions.\n     * @method checkEndConditions\n     * @access public\n     * @memberof TriggerManager#\n     * @param {Number} video - the main video element\n     */\n    checkEndConditions (video) {\n        return this._evaluateConditions(this._trigger.endConditions, video);\n    }\n}\n\nexport default TriggerManager;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* @class Mast\n* @ignore\n*/\nclass Mast {\n    constructor () {\n        this.baseUrl = '';\n        this.triggers = [];     // pointer to any number of Ad objects\n    }\n}\n\n/**\n* @class Trigger\n* @ignore\n*/\nclass Trigger {\n    constructor () {\n        this.id = '';\n        this.description = 0;\n        this.startConditions = [];      // pointer to a list of start conditions to  : AdsPlayer.mast.model.Trigger.Condition\n        this.endConditions = [];        // pointer to a list of end conditions : AdsPlayer.mast.model.Trigger.Condition\n        this.sources = [];              // pointer to a list of sources : AdsPlayer.mast.model.Trigger.Source\n        this.alreadyProcessed = false;  // mainly in the seeked case : do not replay trigger already played\n        this.vasts = [];\n        this.activated = false;\n    }\n}\n\n/**\n* @class Condition\n* @ignore\n*/\nclass Condition {\n    constructor () {\n        this.type = '';\n        this.name = '';\n        this.value = '';\n        this.operator = '';\n        this.conditions = [];\n    }\n}\n\n// ConditionType\nCondition.TYPE = {\n    EVENT: 'event',\n    PROPERTY: 'property'\n\n};\n\n// ConditionName\nCondition.NAME = {\n    ON_ITEM_START: 'OnItemStart',\n    ON_ITEM_END: 'OnItemEnd',\n    POSITION: 'Position',\n    DURATION: 'Duration'\n};\n\n// ConditionOperator\nCondition.OPERATOR = {\n    EQ:  'EQ',  // equal\n    NEQ: 'NEQ', // not equal\n    GTR: 'GTR', // greater\n    GEQ: 'GEQ', // greater or equal\n    LT:  'LT',  // lower\n    LEQ: 'LEQ', // lower or equal\n    MOD: 'MOD'  // modulo\n};\n\n/**\n* @class Source\n* @ignore\n*/\nclass Source {\n    constructor () {\n        this.uri = '';\n        this.altReference = '';\n        this.format = '';\n        this.sources = [];\n        // this.targets = [];\n    }\n}\n\n// SourceFormat\nSource.FORMAT = {\n    VAST: 'vast',\n    UIF: 'uif'\n};\n\n\nvar mast = {};\n\nmast.Mast = Mast;\nmast.Trigger = Trigger;\nmast.Condition = Condition;\nmast.Source = Source;\n\nexport default mast;\nexport { Mast, Trigger, Condition, Source };","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The ImagePlayer is a MediaPlayer implementation for playing still images.\n*/\n\nimport Debug from '../Debug';\n\nclass ImagePlayer {\n\n    _getListeners (type) {\n        if (!(type in this._listeners)) {\n            this._listeners[type] = [];\n        }\n        return this._listeners[type];\n    }\n\n    _addEventListener (type, listener) {\n        var listeners = this._getListeners(type),\n            idx = listeners.indexOf(listener);\n\n        if (idx === -1) {\n            listeners.push(listener);\n        }\n    }\n\n    _removeEventListener (type, listener) {\n        var listeners = this._getListeners(type),\n            idx = listeners.indexOf(listener);\n\n        if (idx !== -1) {\n            listeners.splice(idx, 1);\n        }\n    }\n\n    _notifyEvent (type) {\n        var listeners = this._getListeners(type),\n            i = 0;\n\n        for (i = 0; i < listeners.length; i++) {\n            listeners[i].call(this);\n        }\n    }\n\n    _updateCurrentTime () {\n        var time = new Date().getTime();\n\n        this._currentTime += (time - this._timerTime) / 1000;\n        //this._debug.log(\"Image timeupdate, time = \" + this._currentTime);\n        this._notifyEvent('timeupdate');\n\n        if (this._currentTime >= this._duration) {\n            this._stopTimer();\n            this._notifyEvent('ended');\n        }\n\n        this._timerTime = time;\n    }\n\n    _startTimer () {\n        if (this._timerInterval !== null) {\n            return;\n        }\n        this._notifyEvent('play');\n        this._timerTime = new Date().getTime();\n        this._timerInterval = setInterval(this._updateCurrentTime.bind(this), 200);\n    }\n\n    _stopTimer () {\n        if (this._timerInterval === null) {\n            return;\n        }\n        this._notifyEvent('pause');\n        clearInterval(this._timerInterval);\n        this._timerInterval = null;\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n\n        this._uri = '';\n        this._image = null;\n        this._duration = 0;\n        this._currentTime = 0;\n        this._listeners = {};\n        this._timerInterval = null;\n        this._timerTime = -1;\n        this._events = ['play', 'pause', 'timeupdate', 'ended'];\n        this._debug = Debug.getInstance();\n    }\n\n    load (baseUrl, mediaFiles) {\n\n        var mediaFile = null,\n            type,\n            i;\n\n        // Load the first supported image format\n        // Support only jpeg, png and gif image formats\n        for (i = 0; i < mediaFiles.length; i++) {\n            type = mediaFiles[i].type;\n            if ((type === \"image/jpeg\") || (type === \"image/jpg\") || (type === \"image/png\") || (type === \"image/gif\")) {\n                mediaFile = mediaFiles[i];\n                break;\n            }\n        }\n\n        if (mediaFile === null) {\n            return false;\n        }\n\n        // Get adsplayer-image element if already declared in DOM\n        this._image = document.getElementById('adsplayer-image');\n\n        if (!this._image) {\n            // Create the image element\n            this._image = document.createElement('img');\n            this._image.autoplay = false;\n            this._image.id = 'adsplayer-image';\n        }\n\n        // Add base URL\n        this._uri = mediaFile.uri;\n        this._uri = (this._uri.indexOf('http://') === -1) ? (baseUrl + this._uri) : this._uri;\n\n        this._debug.log(\"Load image media, uri = \" + this._uri);\n        this._image.src = this._uri;\n\n        // Reset current time\n        this._currentTime = 0;\n\n        return true;\n    }\n\n    getType () {\n        return \"image\";\n    }\n\n    getElement () {\n        return this._image;\n    }\n\n    addEventListener (type, listener) {\n        if (!this._image) {\n            return;\n        }\n        if (this._events.indexOf(type) !== -1) {\n            this._addEventListener(type, listener);\n        } else {\n            this._image.addEventListener(type, listener);\n        }\n    }\n\n    removeEventListener (type, listener) {\n        if (!this._image) {\n            return;\n        }\n        if (this._events.indexOf(type) !== -1) {\n            this._removeEventListener(type, listener);\n        } else {\n            this._image.removeEventListener(type, listener);\n        }\n    }\n\n    setDuration (duration) {\n        this._duration = duration;\n    }\n\n    getDuration () {\n        return this._duration;\n    }\n\n    getCurrentTime () {\n        return this._currentTime;\n    }\n\n    setVolume (/*volume*/) {\n        // NA\n    }\n\n    getVolume () {\n        return 0;\n    }\n\n    play () {\n        if (!this._image) {\n            return;\n        }\n        this._startTimer();\n    }\n\n    pause () {\n        if (!this._image) {\n            return;\n        }\n        this._stopTimer();\n    }\n\n    stop () {\n        if (!this._image) {\n            return;\n        }\n        this._stopTimer();\n    }\n\n    reset () {\n        if (!this._image) {\n            return;\n        }\n        this._image = null;\n        this._listeners = {};\n    }\n}\n\nexport default ImagePlayer;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The VideoPlayer is a MediaPlayer implementation for playing video files.\n*/\n\nimport Debug from '../Debug';\n\nclass VideoPlayer {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    isMediaSupported (mimeType) {\n        if (!this._video) {\n            throw \"isMediaSupported(): element not created\";\n        }\n        if (!(this._video instanceof HTMLMediaElement)) {\n            throw \"isMediaSupported(): element must be of type HTMLMediaElement\";\n        }\n\n        var canPlay = this._video.canPlayType(mimeType);\n        return (canPlay === \"probably\" || canPlay === \"maybe\");\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._uri = '';\n        this._video = null;\n        this._debug = Debug.getInstance();\n    }\n\n    load (baseUrl, mediaFiles) {\n\n        // Get 'adsplayer-video' element if already declared in DOM\n        this._video = document.getElementById('adsplayer-video');\n\n        if (!this._video) {\n            // Create the video element\n            this._video = document.createElement('video');\n            this._video.autoplay = false;\n            this._video.id = 'adsplayer-video';\n        }\n\n        // Check if input format is supported\n        if (!this.isMediaSupported(mediaFiles[0].type)) {\n            return false;\n        }\n\n        // Sort the mediafiles in bitrate ascending order\n        mediaFiles.sort(function(a, b) {\n            if (a.bitrate && b.bitrate) {\n                return a.bitrate - b.bitrate;\n            }\n            return -1;\n        });\n\n        // Play the media file with lowest bitrate\n        this._uri = mediaFiles[0].uri;\n\n        // Add base URL\n        this._uri = (this._uri.indexOf('http://') === -1) ? (baseUrl + this._uri) : this._uri;\n\n        this._debug.log(\"Load video media, uri = \" + this._uri);\n\n        this._video.addEventListener('error', function(e) {\n            console.log(e);\n        });\n\n        this._video.src = this._uri;\n\n        return true;\n    }\n\n    getType () {\n        return \"video\";\n    }\n\n    getElement () {\n        return this._video;\n    }\n\n    addEventListener (type, listener) {\n        if (!this._video) {\n            return;\n        }\n        this._video.addEventListener(type, listener);\n    }\n\n    removeEventListener (type, listener) {\n        if (!this._video) {\n            return;\n        }\n        this._video.removeEventListener(type, listener);\n    }\n\n    setDuration (/*duration*/) {\n        // duration is handled by the video element\n    }\n\n    getDuration () {\n        if (!this._video) {\n            return 0;\n        }\n        return this._video.duration;\n    }\n\n    getCurrentTime () {\n        if (!this._video) {\n            return 0;\n        }\n        return this._video.currentTime;\n    }\n\n    getVolume () {\n        if (!this._video) {\n            return 0;\n        }\n        return this._video.muted ? 0 : this._video.volume;\n    }\n\n    setVolume (volume) {\n        if (!this._video) {\n            return;\n        }\n        this._video.volume = volume;\n    }\n\n    play () {\n        if (!this._video) {\n            return;\n        }\n        this._video.play();\n    }\n\n    stop () {\n        if (!this._video) {\n            return;\n        }\n        this._video.pause();\n    }\n\n    pause () {\n        if (!this._video) {\n            return;\n        }\n        this._video.pause();\n    }\n\n    reset () {\n        if (!this._video) {\n            return;\n        }\n        this._video = null;\n    }\n}\n\nexport default VideoPlayer;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nvar xmldom = {};\n\nxmldom.getElementsByTagName = function(node, name) {\n    var elements = node.getElementsByTagName(name);\n    if (elements.length < 1) {\n        var child = node.firstElementChild || node.firstChild;\n        if (child) {\n            var namespaceURI = child.namespaceURI;\n            elements = node.getElementsByTagNameNS(namespaceURI, name);\n        }\n    }\n    return elements;\n};\n\nxmldom.getElement = function(node, name) {\n    var elements = this.getElementsByTagName(node, name);\n    if (elements.length < 1) {\n        return null;\n    }\n    return elements[0];\n};\n\nxmldom.getElements = function(node, name) {\n    return this.getElementsByTagName(node, name);\n};\n\nxmldom.getSubElements = function(node, name, subName) {\n    var element = this.getElement(node, name);\n    if (element === null) {\n        return [];\n    }\n    return this.getElements(element, subName);\n};\n\nxmldom.getChildNode = function (node, name) {\n    if (!node || !node.childNodes) {\n        return null;\n    }\n    for (var i = 0; i < node.childNodes.length; i++) {\n        if (node.childNodes[i].nodeName === name) {\n            return node.childNodes[i];\n        }\n    }\n    return null;\n};\n\nxmldom.getNodeTextValue = function (node) {\n    var cdataSection = this.getChildNode(node, '#cdata-section'),\n        textSection = this.getChildNode(node, '#text');\n    if (cdataSection) {\n        return cdataSection.nodeValue;\n    } else if (textSection) {\n        return textSection.nodeValue;\n    }\n    return '';\n};\n\nxmldom.getChildNodeTextValue = function (node, name) {\n    var element = this.getElement(node, name);\n    if (element === null) {\n        return '';\n    }\n    return this.getNodeTextValue(element);\n};\n\n\nexport default xmldom;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The CreativePlayer manages:\n* - the playing of media files within a Creative (with the help of a Image/VideoPlayer)\n* - the tracking events (with the help of a TrackingEventsManager)\n* - the display of the ad skipping component\n* - the user clicks\n*/\n\nimport TrackingEventsManager from './TrackingEventsManager';\nimport VideoPlayer from '../media/VideoPlayer';\nimport ImagePlayer from '../media/ImagePlayer';\nimport Debug from '../Debug';\nimport EventBus from '../EventBus';\n\nclass CreativePlayer {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _parseTime (str) {\n        var timeParts,\n            SECONDS_IN_HOUR = 60 * 60,\n            SECONDS_IN_MIN = 60;\n\n        if (!str) {\n            return -1;\n        }\n\n        timeParts = str.split(':');\n\n        // Check time format, must be HH:MM:SS(.mmm)\n        if (timeParts.length !== 3) {\n            return -1;\n        }\n\n        return  (parseInt(timeParts[0]) * SECONDS_IN_HOUR) +\n                (parseInt(timeParts[1]) * SECONDS_IN_MIN) +\n                (parseFloat(timeParts[2]));\n    }\n\n    _onMediaPlay () {\n\n        this._debug.log(\"Creative media play\");\n\n        // Notify the creative has ended\n        this._eventBus.dispatchEvent({\n            type: 'play',\n            data: {}\n        });\n    }\n\n    _onMediaPause () {\n\n        this._debug.log(\"Creative media pause\");\n\n        // Notify the creative has ended\n        this._eventBus.dispatchEvent({\n            type: 'pause',\n            data: {}\n        });\n    }\n\n    _onMediaError () {\n\n        this._debug.log(\"Creative media error\");\n\n        // Notify the creative has ended\n        this._eventBus.dispatchEvent({\n            type: 'creativeEnd',\n            data: {}\n        });\n    }\n\n    _onMediaEnded () {\n\n        this._debug.log(\"creative media ended\");\n\n        // Notify the creative has ended\n        this._eventBus.dispatchEvent({\n            type: 'creativeEnd',\n            data: {}\n        });\n    }\n\n    _onMediaTimeupdate () {\n\n        //this._debug.log(\"Media timeupdate: \" + this._mediaPlayer.getCurrentTime());\n    }\n\n    _onAdClick () {\n        // this = creative\n        if (!this.videoClicks) {\n            return;\n        }\n\n        this._debug.log(\"Creative Click\");\n\n        // ClickThrough : send an event for the application to open the web page\n        if (this.videoClicks.clickThrough) {\n            this._debug.log(\"Ad click, uri = \" + this.videoClicks.clickThrough);\n            this._eventBus.dispatchEvent({\n                type: 'click',\n                data: {\n                    uri: this.videoClicks.clickThrough\n                }\n            });\n        }\n\n        // TODO\n        // ClickTracking\n        // if (this.videoClicks.clickTracking) {\n        // }\n    }\n\n    _load (creative, baseUrl) {\n        var mediaFile,\n            isVideo,\n            isImage;\n\n        if (!creative) {\n            return false;\n        }\n\n        if (creative.mediaFiles.length === 0) {\n            return false;\n        }\n\n        mediaFile = creative.mediaFiles[0];\n\n        // Video or image media ?\n        isVideo = mediaFile.type.indexOf('video') !== -1;\n        isImage = mediaFile.type.indexOf('image') !== -1;\n\n        if (isVideo) {\n            this._mediaPlayer = new VideoPlayer();\n        }\n        else if (isImage) {\n            this._mediaPlayer = new ImagePlayer();\n        } else {\n            // Unknown/unsupported media type\n            return false;\n        }\n\n        // Load the media files\n        this._debug.log(\"Creative load\");\n        if (!this._mediaPlayer.load(baseUrl, creative.mediaFiles)) {\n            this._mediaPlayer = null;\n            return false;\n        }\n\n        this._mediaPlayer.setDuration(this._parseTime(creative.duration));\n        this._mediaPlayer.addEventListener('play', this._onMediaPlayListener);\n        this._mediaPlayer.addEventListener('pause', this._onMediaPauseListener);\n        this._mediaPlayer.addEventListener('error', this._onMediaErrorListener);\n        this._mediaPlayer.addEventListener('timeupdate', this._onMediaTimeupdateListener);\n        this._mediaPlayer.addEventListener('ended', this. _onMediaEndedListener);\n\n        // Add tracking events\n        if (creative.trackingEvents) {\n            this._trackingEventsManager = new TrackingEventsManager();\n            this._trackingEventsManager.init(creative.trackingEvents, this._mediaPlayer);\n            this._trackingEventsManager.start();\n        }\n\n        // Notify a creative is starting to play\n        this._eventBus.dispatchEvent({\n            type: 'creativeStart',\n            data: {}\n        });\n\n        // Notify a media element has been created and appended into document\n        this._eventBus.dispatchEvent({\n            type: 'addElement',\n            data: {\n                element: this._mediaPlayer.getElement(),\n                type: this._mediaPlayer.getType()\n            }\n        });\n\n        // Add the media player DOM element\n        this._adPlayerContainer.appendChild(this._mediaPlayer.getElement());\n\n        // Listener for click\n        if (creative.videoClicks) {\n            if (creative.videoClicks.clickThrough) {\n                this._mediaPlayer.getElement().style.cursor = 'pointer';\n            }\n            this._mediaPlayer.getElement().addEventListener('click', this._onAdClick.bind(creative).bind(this));\n        }\n\n        // Align media volume to main video volume\n        this._onMainVideoVolumeChange();\n\n        // Start playing the media\n        this._play();\n\n        return true;\n    }\n\n    _play () {\n\n        if (!this._mediaPlayer) {\n            return;\n        }\n\n        this._debug.log(\"Creative play\");\n\n        // Play the media player\n        this._mediaPlayer.play();\n    }\n\n    _pause () {\n\n        if (!this._mediaPlayer) {\n            return;\n        }\n\n        this._debug.log(\"Creative pause\");\n\n        // Pause the media player\n        this._mediaPlayer.pause();\n    }\n\n    _stop () {\n\n        if (!this._mediaPlayer) {\n            return;\n        }\n\n        this._debug.log(\"Creative stop\");\n\n        // Stop the media player\n        this._mediaPlayer.removeEventListener('play', this._onMediaPlayListener);\n        this._mediaPlayer.removeEventListener('pause', this._onMediaPauseListener);\n        this._mediaPlayer.removeEventListener('error', this._onMediaErrorListener);\n        this._mediaPlayer.removeEventListener('timeupdate', this._onMediaTimeupdateListener);\n        this._mediaPlayer.removeEventListener('ended', this._onMediaEndedListener);\n        this._mediaPlayer.stop();\n\n        // Notify a media element has been created and appended into document\n        this._eventBus.dispatchEvent({\n            type: 'removeElement',\n            data: {\n                element: this._mediaPlayer.getElement(),\n                type: this._mediaPlayer.getType()\n            }\n        });\n\n        // Remove the element from the DOM\n        this._adPlayerContainer.removeChild(this._mediaPlayer.getElement());\n\n        // Reset the media player\n        this._mediaPlayer.reset();\n        this._mediaPlayer = null;\n\n        // Stop the TrackingEvents manager\n        if (this._trackingEventsManager) {\n            this._trackingEventsManager.stop();\n            this._trackingEventsManager = null;\n        }\n    }\n\n    _onMainVideoVolumeChange () {\n        if (!this._mediaPlayer) {\n            return;\n        }\n        this._mediaPlayer.setVolume(this._mainVideo.muted ? 0 : this._mainVideo.volume);\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._adPlayerContainer = null;\n        this._mediaPlayer = null;\n        this._trackingEventsManager = null;\n        this._mainVideo = null;\n        this._debug = Debug.getInstance();\n        this._eventBus = EventBus.getInstance();\n\n        this._onMediaPlayListener = this._onMediaPlay.bind(this);\n        this._onMediaPauseListener = this._onMediaPause.bind(this);\n        this._onMediaErrorListener = this._onMediaError.bind(this);\n        this._onMediaTimeupdateListener = this._onMediaTimeupdate.bind(this);\n        this._onMediaEndedListener = this._onMediaEnded.bind(this);\n    }\n\n    /**\n     * Initializes the creative player.\n     * @method init\n     * @access public\n     * @memberof CreativePlayer#\n     * @param {Object} creative - the creative element to play\n     * @param {String} baseUrl - the base URL for media files\n     */\n    init (adPlayerContainer, mainVideo) {\n        this._adPlayerContainer = adPlayerContainer;\n        this._mainVideo = mainVideo;\n        this._mainVideo.addEventListener('volumechange', this._onMainVideoVolumeChange.bind(this));\n    }\n\n    load (creative, baseUrl) {\n        return this._load(creative, baseUrl);\n    }\n\n    play () {\n        this._play();\n    }\n\n    pause () {\n        this._pause();\n    }\n\n    stop () {\n        this._stop();\n    }\n\n    reset () {\n        this._mainVideo.removeEventListener('volumechange', this._onMainVideoVolumeChange);\n        this._mainVideo = null;\n    }\n}\n\nexport default CreativePlayer;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The TrackingEventsManager manages the sending of the tracking events while a creative's media is playing.\n* It takes as input the list of tracking events to send.\n*/\n\nimport Debug from '../Debug';\n\nclass TrackingEventsManager {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _postEvent (uri) {\n        let xhr = new XMLHttpRequest();\n        xhr.open('GET', uri, true);\n        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n        xhr.send();\n    }\n\n    _addEventListener (element, eventType, trackingEvent) {\n\n        let self = this,\n            _listener = function(/*event*/) {\n                if (this.completed === true) {\n                    return;\n                }\n                if (this.uri === undefined || this.uri.length === 0) {\n                    return;\n                }\n                if (this.condition && !this.condition()) {\n                    return;\n                }\n                self._debug.log(\"Send tracking event \" + this.event + \", uri = \" + this.uri);\n                self._postEvent(this.uri);\n                if (this.oneShot === true) {\n                    this.completed = true;\n                }\n            },\n            _eventListener = {\n                type: eventType,\n                element: element,\n                listener: _listener.bind(trackingEvent)\n            };\n\n        element.addEventListener(eventType, _eventListener.listener);\n        this._eventListeners.push(_eventListener);\n    }\n\n    _addPlayerEventListeners () {\n\n        for (let i = 0; i < this._trackingEvents.length; i++) {\n            let trackingEvent = this._trackingEvents[i];\n            if (trackingEvent.uri && trackingEvent.uri.length > 0) {\n                switch (trackingEvent.event) {\n                    case 'creativeView':\n                        trackingEvent.oneShot = true;\n                        this._addEventListener(this._adMediaPlayer, 'loadeddata', trackingEvent);\n                        break;\n                    case 'start':\n                        trackingEvent.oneShot = true;\n                        this._addEventListener(this._adMediaPlayer, 'playing', trackingEvent);\n                        break;\n                    case 'pause':\n                        trackingEvent.oneShot = false;\n                        this._addEventListener(this._adMediaPlayer, 'paused', trackingEvent);\n                        break;\n                    case 'resume':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = () => {\n                            return (this._adMediaPlayer.getCurrentTime() > 0);\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'play', trackingEvent);\n                        break;\n                    case 'firstQuartile':\n                        trackingEvent.oneShot = true;\n                        trackingEvent.condition = () => {\n                            //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                            return ((this._adMediaPlayer.getCurrentTime() / this._adMediaPlayer.getDuration()) >= 0.25);\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                        break;\n                    case 'midpoint':\n                        trackingEvent.oneShot = true;\n                        trackingEvent.condition = () => {\n                            //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                            return ((this._adMediaPlayer.getCurrentTime() / this._adMediaPlayer.getDuration()) >= 0.50);\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                        break;\n                    case 'thirdQuartile':\n                        trackingEvent.oneShot = true;\n                        trackingEvent.condition = () => {\n                            //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                            return ((this._adMediaPlayer.getCurrentTime() / this._adMediaPlayer.getDuration()) >= 0.75);\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                        break;\n                    case 'rewind':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = () => {\n                            let res = (this._adMediaPlayer.getCurrentTime() < this._currentTime);\n                            this._currentTime = this._adMediaPlayer.getCurrentTime();\n                            return res;\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                        break;\n                    case 'complete':\n                        this._addEventListener(this._adMediaPlayer, 'ended', trackingEvent);\n                        break;\n                    case 'mute':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = () => {\n                            let res = !this._mute && (this._adMediaPlayer.getVolume() === 0);\n                            this._mute = (this._adMediaPlayer.getVolume() === 0);\n                            return res;\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'volumechange', trackingEvent);\n                        break;\n                    case 'unmute':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = () => {\n                            let res = !this._unmute && (this._adMediaPlayer.getVolume() > 0);\n                            this._unmute = (this._adMediaPlayer.getVolume() > 0);\n                            return res;\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'volumechange', trackingEvent);\n                        break;\n                    case 'fullscreen':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = () => {\n                            return (document.fullScreen || document.mozFullScreen || document.webkitIsFullScreen);\n                        };\n                        this._addEventListener(document, 'webkitfullscreenchange', trackingEvent);\n                        this._addEventListener(document, 'mozfullscreenchange', trackingEvent);\n                        this._addEventListener(document, 'MSFullscreenChange', trackingEvent);\n                        this._addEventListener(document, 'fullscreenChange', trackingEvent);\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n    }\n\n    _removePlayerEventListeners () {\n        for (let i = 0; i < this._eventListeners.length; i++) {\n            this._eventListeners[i].element.removeEventListener(this._eventListeners[i].type, this._eventListeners[i].listener);\n        }\n        this._eventListeners = [];\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._trackingEvents = null;\n        this._adMediaPlayer = null;\n        this._currentTime = -1;\n        this._mute = -1;\n        this._unmute = -1;\n        this._debug = Debug.getInstance();\n        this._eventListeners = [];\n    }\n\n    /**\n     * Initializes the TrackingEventsManager.\n     * @method init\n     * @access public\n     * @memberof TrackingEventsManager#\n     * @param {Array} trackingEvents - the array of tracking events to manage\n     * @param {Object} adMediaPlayer - the ad media player\n     */\n    init (trackingEvents, adMediaPlayer) {\n        this._trackingEvents = trackingEvents;\n        this._adMediaPlayer = adMediaPlayer;\n        this._mute = (this._adMediaPlayer.getVolume() === 0);\n        this._unmute = (this._adMediaPlayer.getVolume() > 0);\n    }\n\n    start () {\n        if (this._trackingEvents.length === 0) {\n            return;\n        }\n        this._addPlayerEventListeners();\n    }\n\n    stop () {\n        this._removePlayerEventListeners();\n    }\n}\n\nexport default TrackingEventsManager;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* VAST parser. This class parses VAST file in XML format\n* and construct the corresponding VAST object according to VAST data model.\n*/\n\nimport vast from './model/Vast';\nimport xmldom from '../utils/xmldom';\n\nclass VastParser {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _getTrackingEvent (trackingNode) {\n        let trackingEvent = new vast.TrackingEvent();\n\n        trackingEvent.event = trackingNode.getAttribute('event');\n        trackingEvent.uri = xmldom.getNodeTextValue(trackingNode);\n\n        return trackingEvent;\n    }\n\n    _getVideoClicks (videoClicksNode) {\n        let videoClicks = new vast.VideoClicks(),\n            nodeName,\n            nodeValue;\n\n        for (let i = 0; i < videoClicksNode.childNodes.length; i++) {\n            nodeName = videoClicksNode.childNodes[i].nodeName;\n            nodeValue = xmldom.getNodeTextValue(videoClicksNode.childNodes[i]);\n\n            switch (nodeName) {\n                case \"ClickThrough\":\n                    videoClicks.clickThrough = nodeValue;\n                    break;\n                case \"ClickTracking\":\n                    videoClicks.clickTracking = nodeValue;\n                    break;\n                case \"CustomClick\":\n                    videoClicks.customClick = nodeValue;\n                    break;\n            }\n        }\n\n        return videoClicks;\n    }\n\n    _getMediaFile (mediaFileNode) {\n        let mediaFile = new vast.MediaFile();\n\n        mediaFile.id = mediaFileNode.getAttribute('id');\n        mediaFile.delivery = mediaFileNode.getAttribute('delivery');\n        mediaFile.type = mediaFileNode.getAttribute('type');\n        mediaFile.bitrate = mediaFileNode.getAttribute('bitrate');\n        mediaFile.width = mediaFileNode.getAttribute('width');\n        mediaFile.height = mediaFileNode.getAttribute('height');\n        mediaFile.scalable = mediaFileNode.getAttribute('scalable');\n        mediaFile.maintainAspectRatio = mediaFileNode.getAttribute('maintainAspectRatio');\n        mediaFile.apiFramework = mediaFileNode.getAttribute('apiFramework');\n        mediaFile.uri = xmldom.getNodeTextValue(mediaFileNode);\n\n        return mediaFile;\n    }\n\n    _getLinear (linearNode) {\n        let linear = new vast.Linear(),\n            trackingNodes,\n            videoClicksNode,\n            mediaFileNodes,\n            i;\n\n        linear.duration = xmldom.getChildNodeTextValue(linearNode, 'Duration');\n        linear.adParameters = xmldom.getChildNodeTextValue(linearNode, 'AdParameters');\n\n        trackingNodes = xmldom.getSubElements(linearNode, 'TrackingEvents', 'Tracking');\n        for (i = 0; i < trackingNodes.length; i++) {\n            linear.trackingEvents.push(this._getTrackingEvent(trackingNodes[i]));\n        }\n\n        videoClicksNode = xmldom.getElement(linearNode, 'VideoClicks');\n        if (videoClicksNode) {\n            linear.videoClicks = this._getVideoClicks(videoClicksNode);\n        }\n\n        mediaFileNodes = xmldom.getSubElements(linearNode, 'MediaFiles', 'MediaFile');\n        for (i = 0; i < mediaFileNodes.length; i++) {\n            linear.mediaFiles.push(this._getMediaFile(mediaFileNodes[i]));\n        }\n\n        return linear;\n    }\n\n    _getCreative (creativeNode) {\n        let creative = new vast.Creative(),\n            linearNode;\n\n        creative.id = creativeNode.getAttribute('id');\n        creative.adId = creativeNode.getAttribute('AdID');\n        creative.sequence = creativeNode.getAttribute('sequence');\n\n        linearNode = xmldom.getElement(creativeNode, 'Linear');\n        if (linearNode) {\n            creative.linear = this._getLinear(linearNode);\n        }\n\n        // TODO: get Companion and non-Linear elements\n\n        return creative;\n    }\n\n    _getInLine (adNode) {\n        let inLine = new vast.InLine(),\n            inLineNode = xmldom.getElement(adNode, 'InLine'),\n            impressionNodes,\n            creativeNodes,\n            i;\n\n        if (inLineNode === null) {\n            return null;\n        }\n\n        inLine.adSystem = xmldom.getChildNodeTextValue(inLineNode, 'AdSystem');\n        inLine.adTitle = xmldom.getChildNodeTextValue(inLineNode, 'AdTitle');\n        inLine.description = xmldom.getChildNodeTextValue(inLineNode, 'Description');\n        inLine.survey = xmldom.getChildNodeTextValue(inLineNode, 'Survey');\n        inLine.error = xmldom.getChildNodeTextValue(inLineNode, 'Error');\n\n        impressionNodes = xmldom.getElements(inLineNode, 'Impression');\n        for (i = 0; i < impressionNodes.length; i++) {\n            var impression = new vast.Impression();\n            impression.id = impressionNodes[i].getAttribute('id');\n            impression.uri = xmldom.getNodeTextValue(impressionNodes[i]);\n            inLine.impressions.push(impression);\n\n        }\n\n        creativeNodes = xmldom.getSubElements(inLineNode, 'Creatives', 'Creative');\n        for (i = 0; i < creativeNodes.length; i++) {\n            inLine.creatives.push(this._getCreative(creativeNodes[i]));\n        }\n\n        return inLine;\n    }\n\n    _getAd (vastNode, vast_) {\n        let adNode = xmldom.getElement(vastNode, 'Ad');\n\n        if (adNode === null) {\n            return;\n        }\n\n        vast_.ad = new vast.Ad();\n        vast_.ad.id = adNode.getAttribute('id');\n        vast_.ad.inLine = this._getInLine(adNode);\n    }\n\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n    }\n\n    /**\n    * Parses the VAST XML DOM and get the triggers.\n    * @param {object} xmlDom - the XML DOM to parse\n    */\n    parse (xmlDom) {\n        let vast_ = new vast.Vast(),\n            vastNode = xmldom.getElement(xmlDom, 'VAST');\n\n        if (vastNode === null) {\n            return vast_;\n        }\n\n        vast_.version = vastNode.getAttribute('version');\n\n        this._getAd(vastNode, vast_);\n\n        return vast_;\n    }\n}\n\nexport default VastParser;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The VastPlayerManager manages the sequencing of playing creatives of a single VAST.\n* It takes as input the list of Vast objects as returned by the VAST parser.\n* For each Vast, the VastPlayerManager plays sequentially all contained Creatives,\n* with the help of a CreativePlayer.\n*/\n\n\nimport CreativePlayer from './CreativePlayer';\nimport Debug from '../Debug';\nimport ErrorHandler from '../ErrorHandler';\nimport EventBus from '../EventBus';\n\nclass VastPlayerManager {\n\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _sendImpressions (impressions) {\n        let impression;\n\n        if (impressions.length === 0) {\n            return;\n        }\n\n        for (let i = 0; i < impressions.length; i++) {\n            impression = impressions[i];\n            if (impression.uri && impression.uri.length > 0) {\n                this._debug.log(\"Send Impression, uri = \" + impression.uri);\n                let http = new XMLHttpRequest();\n                http.open(\"GET\", impression.uri, true);\n                http.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n                http.send();\n            }\n        }\n    }\n\n    _onCreativeEnd () {\n\n        this._debug.log(\"Creative ended\");\n\n        // Stop the current creative media\n        this._stopCreative();\n\n        // Play next creative\n        this._playNextCreative();\n    }\n\n    _pauseCreative () {\n        if (!this._creativePlayer) {\n            return;\n        }\n        this._creativePlayer.pause();\n    }\n\n    _resumeCreative () {\n        if (!this._creativePlayer) {\n            return;\n        }\n        this._creativePlayer.play();\n    }\n\n    _stopCreative () {\n        if (!this._creativePlayer) {\n            return;\n        }\n        this._eventBus.removeEventListener('creativeEnd', this._onCreativeEndListener);\n        this._creativePlayer.stop();\n    }\n\n    _playCreative (index) {\n        var creative = this._vasts[this._vastIndex].ad.inLine.creatives[index],\n            linear;\n\n        this._creativeIndex = index;\n        this._debug.log(\"Play Creative - index = \" + this._creativeIndex);\n\n        // Play Linear element\n        linear = creative.linear;\n\n        if (linear) {\n            this._debug.log(\"Play Linear Ad, duration = \" + linear.duration);\n            this._eventBus.addEventListener('creativeEnd', this._onCreativeEndListener);\n            if (!this._creativePlayer.load(creative.linear, this._vasts[this._vastIndex].baseUrl)) {\n                this._playNextCreative();\n            }\n        } else {\n            this._playNextCreative();\n        }\n    }\n\n    _playVast (index) {\n        var vast = this._vasts[index],\n            ad = vast.ad;\n\n        if (ad === null) {\n            // Empty VAST\n            return;\n        }\n\n        this._vastIndex = index;\n        this._debug.log(\"Play Vast - index = \" + this._vastIndex + \", Ad id = \" + ad.id);\n\n        // Send Impressions tracking\n        this._sendImpressions(ad.inLine.impressions);\n\n        // Play first Creative\n        this._playCreative(0);\n    }\n\n    _playNextVast () {\n\n        this._vastIndex++;\n\n        if (this._vastIndex < this._vasts.length) {\n            this._playVast(this._vastIndex);\n        } else {\n            // Notify end of trigger\n            this._eventBus.dispatchEvent({\n                type: 'triggerEnd',\n                data: {}\n            });\n        }\n    }\n\n    _playNextCreative () {\n        var ad = this._vasts[this._vastIndex].ad;\n\n        this._creativeIndex++;\n\n        if (this._creativeIndex < ad.inLine.creatives.length) {\n            this._playCreative(this._creativeIndex);\n        } else {\n            this._playNextVast();\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._vasts = [];\n        this._adPlayerContainer = null;\n        this._vastIndex = -1;\n        this._creativeIndex = -1;\n        this._creativePlayer = new CreativePlayer();\n        this._errorHandler = ErrorHandler.getInstance();\n        this._debug = Debug.getInstance();\n        this._eventBus = EventBus.getInstance();\n        this._mediaPlayer = null;\n        this._onCreativeEndListener = this._onCreativeEnd.bind(this);\n    }\n\n    /**\n     * Initializes the VastPlayerManager.\n     * @method init\n     * @access public\n     * @memberof VastPlayerManager#\n     * @param {Array} vasts - the array of Vast components to play\n     * @param {Array} adPlayerContainer - the HTML DOM container for ads player components\n     */\n    init (vasts, adPlayerContainer, mainVideo) {\n        this._vasts = vasts;\n        this._adPlayerContainer = adPlayerContainer;\n        this._creativePlayer.init(this._adPlayerContainer, mainVideo);\n    }\n\n    start () {\n        if (!this._vasts || this._vasts.length === 0) {\n            return;\n        }\n\n        // Notify a trigger is starting to play\n        this._eventBus.dispatchEvent({\n            type: 'triggerStart',\n            data: {}\n        });\n\n        this._playVast(0);\n    }\n\n    play () {\n        this._resumeCreative();\n    }\n\n    pause () {\n        this._pauseCreative();\n    }\n\n    stop () {\n        this._stopCreative();\n    }\n\n    reset () {\n        this._creativePlayer.reset();\n    }\n}\n\nexport default VastPlayerManager;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* @class Vast\n* @ignore\n*/\nclass Vast {\n    constructor () {\n        this.version = '';\n        this.ad = null;\n    }\n}\n\n/**\n* @class Ad\n* @ignore\n*/\nclass Ad {\n    constructor () {\n        this.id = '';\n        this.inLine = null;\n        this.wrapper = null;\n    }\n}\n\n/**\n* @class InLine\n* @ignore\n*/\nclass InLine {\n    constructor () {\n        this.adSystem = '';                 // [Required] Source ad server\n        this.adTitle = '';                  // [Required] Title\n        this.description = '';              // [Optional] Description\n        this.survey = '';                   // [Optional] URI of request to survey vendor\n        this.error = '';                    // [Optional] URI to request if ad does not play due to error\n        this.impressions = [];              // [Required] URIs to track impressions.\n        this.creatives = [];                // [Required] Creative elements\n        this.extensions = [];               // [Optional] Any valid XML may be included in the Extensions node\n    }\n}\n\n/**\n* @class Impression\n* @ignore\n*/\nclass Impression {\n    constructor () {\n        this.uri = '';                      // [Required] URI to track Impression\n        this.id = '';                       // [Optional] Identifier\n    }\n}\n\n/**\n* @class Extensions\n* @ignore\n*/\nclass Extensions {\n    constructor () {\n        this.uri = '';                      //\n        this.other = '';                    //\n    }\n}\n\n/**\n* @class Creative\n* @ignore\n*/\nclass Creative {\n    constructor () {\n        this.id = '';                       // [Optional] Identifier\n        this.adId = '';                     // [Optional] Ad-ID for the creative (formerly ISCI)\n        this.sequence = 0;                  // [Optional] The preferred order in which multiple Creatives should be displayed\n        this.linear = null;                 // [Optional] Linear ad\n        this.CompanionAds = [];             // [Optional] Companion ads\n        this.nonLinearAds = [];             // [Optional] Non-linear ads\n    }\n}\n\n// Creative types\nCreative.TYPE = {\n    LINEAR: 'linear',\n    NON_LINEAR_ADS: 'NonLinearAds',\n    COMPANION_ADS : 'CompanionAds'\n};\n\n/**\n* @class Linear\n* @ignore\n*/\nclass Linear {\n    constructor () {\n        this.duration = 0;                  // [Required] Duration in standard time format, hh:mm:ss\n        this.trackingEvents = [];           // [Optional] Tracking events elements\n        this.adParameters = '';             // [Optional] Data to be passed into the video ad\n        this.videoClicks = null;            // [Optional] Video clicks\n        this.mediaFiles = [];               // [Required] Media file elements\n    }\n}\n\n/**\n* @class Companion\n* @ignore\n*/\nclass Companion {\n    constructor () {\n        this.id = '';                       // optional : identifier\n        this.width = 0;                     // width pixel dimension of companion\n        this.height = 0;                    // height pixel dimension of companion\n        this.staticResource = null;         // optional : pointer to the static resource : AdsPlayer.vast.model.Ad.StaticResource\n        this.iFrameResource = '';           // optional : URI source for an IFrame to display the companion element\n        this.hTMLResource = '';             // optional : HTML to display the companion element : shall be CDATA value\n        this.trackingEvents = [];           // optional : pointer to any number of tracking objects : AdsPlayer.vast.model.Ad.CompanionTracking\n        this.clickThrough = '';             // optional : URI to open as destination page when user clicks on the companion\n        this.altText = '';                  // optional : alt text to be displayed when companion is rendered in HTML environment.\n        this.adParameters = '';             // optional : data to be passed into the companion ads\n    }\n}\n\n//\n//      Non Linear Ads\n//\n\n/**\n* @class Companion\n* @ignore\n*/\nclass NonLinear {\n    constructor () {\n        this.id = '';                       // optional : identifier\n        this.width = 0;                     // width pixel dimension of non linear\n        this.height = 0;                    // height pixel dimension of non linear\n        this.expandedWidth = 0;             // optional : pixel dimensions of expanding nonlinear ad when in expanded state\n        this.expandedHeight  = 0;           // optional : pixel dimensions of expanding nonlinear ad when in expanded state\n        this.scalable = true;               // optional : whether it is acceptable to scale the image\n        this.maintainAspectRatio = true;    // optional : whether the ad must have its aspect ratio maintained when scaled\n        this.apiFramework = '';             // optional : defines the method to use for communication with the nonlinear element\n        this.staticResource = null;         // optional : pointer to the static resource : AdsPlayer.vast.model.Ad.StaticResource\n        this.hTMLResource = '';             // optional : HTML to display the companion element : shall be CDATA value\n        this.trackingEvents = [];           // optional : pointer to any number of tracking objects : AdsPlayer.vast.model.Ad.Tracking\n        this.clickThrough = '';             // optional : URI to open as destination page when user clicks on the non-linear ad unit\n        this.adParameters = '';             // optional : data to be passed into the video ad\n    }\n}\n\n/**\n* @class TrackingEvent\n* @ignore\n*/\nclass TrackingEvent {\n    constructor () {\n        this.uri = '';                      // [Optional] URI to track various events during playback\n        this.event = '';                    // [Required] The name of the event to track for the Linear element\n    }\n}\n\n\n/**\n* [TrackingEvent description]\n* @type {Object}\n*/\nTrackingEvent.TYPE = {\n    CREATIVEVIEW:'creativeView',\n    START:'start',\n    MIDPOINT: 'midpoint',\n    FIRSTQUARTILE: 'firstQuartile',\n    THIRDQUARTILE: 'thirdQuartile',\n    COMPLETE: 'complete',\n    MUTE: 'mute',\n    UNMUTE: 'unmute',\n    PAUSE: 'pause',\n    REWIND: 'rewind',\n    RESUME: 'resume',\n    FULLSCREEN: 'fullscreen',\n    EXPAND: 'expand',\n    COLLAPSE: 'collapse',\n    ACCEPTINVITATION: 'acceptInvitation',\n    CLOSE: 'close'\n};\n\n/**\n* @class VideoClicks\n* @ignore\n*/\nclass VideoClicks {\n    constructor () {\n        this.clickThrough = '';             // [Optional] URI to open as destination page when user clicks on the video\n        this.clickTracking = '';            // [Optional] URI to request for tracking purposes when user clicks on the video\n        this.customClick = '';              // [Optional] URI to request on custom events such as hotspotted video\n    }\n}\n\n/**\n* @class MediaFile\n* @ignore\n*/\nclass MediaFile {\n    constructor () {\n        this.id = '';                       // [Optional] Identifier\n        this.delivery = '';                 // [Required] Method of delivery of ad ('streaming' or 'progressive')\n        this.type = '';                     // [Required] MIME type\n        this.bitrate = 0;                   // [Optional] Bitrate of encoded video in Kbps\n        this.width = 0;                     // [Required] Pixel dimensions of video\n        this.height = 0;                    // [Required] Pixel dimensions of video\n        this.scalable = true;               // [Optional] Whether it is acceptable to scale the image.\n        this.maintainAspectRatio = true;    // [Optional] Whether the ad must have its aspect ratio maintained when scaled\n        this.apiFramework = '';             // [Optional] Defines the method to use for communication if the MediaFile is interactive.\n        this.uri = '';\n    }\n}\n\n// MediaFile delivery types\nMediaFile.DELIVERY = {\n    STREAMING: 'streaming',\n    PROGRESSIVE: 'progressive '\n};\n\n/**\n* @class StaticResource\n* @ignore\n*/\nclass StaticResource {\n    constructor () {\n        this.uRI = '';              // optional : URI to a static file, such as an image or SWF file\n        this.creativeType  ='';     // mime type of static resource\n    }\n}\n\n\nvar vast = {};\n\nvast.Vast = Vast;\nvast.Ad = Ad;\nvast.InLine = InLine;\nvast.Impression = Impression;\nvast.Extensions = Extensions;\nvast.Creative = Creative;\nvast.Linear = Linear;\nvast.Companion = Companion;\nvast.NonLinear = NonLinear;\nvast.TrackingEvent = TrackingEvent;\nvast.VideoClicks = VideoClicks;\nvast.MediaFile = MediaFile;\nvast.StaticResource = StaticResource;\n\nexport default vast;\n\nexport { Vast, Ad, InLine, Impression, Extensions, Creative, Linear, Companion, NonLinear, TrackingEvent, VideoClicks, MediaFile, StaticResource };"]}