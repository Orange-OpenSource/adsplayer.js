!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("adsplayer",[],t):"object"==typeof exports?exports.adsplayer=t():e.adsplayer=t()}(window,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=21)}([function(e,t,i){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),Date.prototype.HHMMSSmmm=function(){var e=this.getHours().toString(),t=this.getMinutes().toString(),i=this.getSeconds().toString(),n=this.getMilliseconds().toString();return(e[1]?e:"0"+e[0])+":"+(t[1]?t:"0"+t[0])+":"+(i[1]?i:"0"+i[0])+"."+(n[2]?n:"0"+(n[1]?n:"0"+n[0]))},Date.prototype.MMSSmmm=function(){var e=this.getMinutes().toString(),t=this.getSeconds().toString(),i=this.getMilliseconds().toString();return(e[1]?e:"0"+e[0])+":"+(t[1]?t:"0"+t[0])+"."+(i[2]?i:"0"+(i[1]?i:"0"+i[0]))},function(e){e[e.NONE=0]="NONE",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e[e.ALL=4]="ALL"}(n=t.LOG_LEVEL||(t.LOG_LEVEL={}));var r=function(){function e(){this.level=n.ALL,this.showTimestamp=!0,this.showElapsedTime=!1,this.startTime=new Date,this.logger=console}return e.getInstance=function(){return null===this.instance&&(this.instance=new e),this.instance},e.prototype.getLevel=function(){return this.level},e.prototype.setLevel=function(e){this.level=e},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(n.ERROR,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(n.WARN,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(n.INFO,e)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(n.DEBUG,e)},e.prototype.getStringLevel=function(e){switch(e){case n.NONE:return"";case n.ERROR:return"ERROR";case n.WARN:return"WARN";case n.INFO:return"INFO";case n.DEBUG:case n.ALL:return"DEBUG";default:return""}},e.prototype.prepareLog=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n="",r=new Date;return this.showTimestamp&&(n+="["+r.HHMMSSmmm()+"]"),this.logger&&this.logger.showLevel&&(n+="["+this.getStringLevel(e)+"]"),this.showElapsedTime&&(n+="["+new Date(r.getTime()-this.startTime.getTime()).MMSSmmm()+"]"),n+="[AdsPlayer] ",Array.apply(null,t).forEach(function(e){n+=e+" "}),n},e.prototype.log=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(!(e>this.getLevel())){var r=this.prepareLog(e,t);switch(e){case n.ERROR:this.logger.error(r);break;case n.WARN:this.logger.warn(r);break;case n.INFO:this.logger.info(r);break;case n.DEBUG:this.logger.debug(r)}}},e.instance=null,e}();t.Logger=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0);!function(e){e.TRIGGER_START="triggerStart",e.TRIGGER_END="triggerEnd",e.AD_START="adStart",e.AD_END="adEnd",e.CREATIVE_START="creativeStart",e.CREATIVE_END="creativeEnd",e.PLAY="play",e.PAUSE="pause",e.CLICK="click"}(t.AdEvents||(t.AdEvents={}));var r=function(){function e(){this.registrations={},this.logger=n.Logger.getInstance()}return e.getInstance=function(){return null===this.instance&&(this.instance=new e),this.instance},e.prototype.addEventListener=function(e,t){var i=this.getListeners(e);-1===i.indexOf(t)&&i.push(t)},e.prototype.removeEventListener=function(e,t){var i=this.getListeners(e),n=i.indexOf(t);-1!==n&&i.splice(n,1)},e.prototype.dispatchEvent=function(e,t){var i=this.getListeners(e).slice(),n={type:e,data:t||{}};this.logger.debug("# Event: "+e);for(var r=0;r<i.length;r+=1)i[r].call(this,n)},e.prototype.getListeners=function(e){return e in this.registrations||(this.registrations[e]=[]),this.registrations[e]},e.instance=null,e}();t.EventBus=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.START="start",e.END="end",e.ADD_ELEMENT="addElement",e.REMOVE_ELEMENT="removeElement",e.PLAY="play",e.PAUSE="pause",e.CLICK="click",e.ERROR="error"}(t.EventTypes||(t.EventTypes={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.isAbsoluteURI=function(e){return e.toLowerCase().indexOf("http://")>=0||e.toLowerCase().indexOf("https://")>=0},e}();t.Utils=n},function(e,t,i){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.DOWNLOAD_ERR_FILE=1]="DOWNLOAD_ERR_FILE",e[e.DOWNLOAD_ERR_NOT_XML=2]="DOWNLOAD_ERR_NOT_XML"}(n=t.ErrorCodes||(t.ErrorCodes={})),t.ErrorMessages={},t.ErrorMessages[n.DOWNLOAD_ERR_FILE]="Failed to download file",t.ErrorMessages[n.DOWNLOAD_ERR_NOT_XML]="The downloaded file format is not in xml format"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.getElementsByTagName=function(e,t){var i=e.getElementsByTagName(t);if(i.length>0)return i;var n=e.firstElementChild||e.firstChild;if(n){var r=n.namespaceURI;return e.getElementsByTagNameNS(r,t)}},e.getElement=function(e,t){var i=this.getElementsByTagName(e,t);return i.length<1?null:i[0]},e.getElements=function(e,t){return this.getElementsByTagName(e,t)},e.getSubElements=function(e,t,i){var n=this.getElement(e,t);return null===n?[]:this.getElements(n,i)},e.getChildNode=function(e,t){if(!e||!e.childNodes)return null;for(var i=0;i<e.childNodes.length;i++)if(e.childNodes[i].nodeName===t)return e.childNodes[i];return null},e.getNodeTextValue=function(e){var t=this.getChildNode(e,"#cdata-section"),i=this.getChildNode(e,"#text");return t?t.nodeValue:i?i.nodeValue:""},e.getChildNodeTextValue=function(e,t){var i=this.getElement(e,t);return null===i?"":this.getNodeTextValue(i)},e}();t.XmlDom=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(){this.baseUrl="",this.triggers=[]}}();t.Mast=n;var r=function(){return function(){this.id="",this.description=0,this.startConditions=[],this.endConditions=[],this.sources=[],this.alreadyProcessed=!1,this.vasts=[],this.activated=!1}}();t.Trigger=r;var s=function(){return function(){this.type="",this.name="",this.value="",this.operator="",this.conditions=[]}}();t.Condition=s,function(e){e.EVENT="event",e.PROPERTY="property"}(t.CONDITION_TYPE||(t.CONDITION_TYPE={})),function(e){e.ON_ITEM_START="OnItemStart",e.ON_ITEM_END="OnItemEnd",e.POSITION="Position",e.DURATION="Duration"}(t.CONDITION_NAME||(t.CONDITION_NAME={})),function(e){e.EQ="EQ",e.NEQ="NEQ",e.GTR="GTR",e.GEQ="GEQ",e.LT="LT",e.LEQ="LEQ",e.MOD="MOD"}(t.CONDITION_OPERATOR||(t.CONDITION_OPERATOR={}));var o=function(){return function(){this.uri="",this.altReference="",this.format="",this.sources=[]}}();t.Source=o,function(e){e.VAST="vast",e.UIF="uif"}(t.SOURCE_FORMAT||(t.SOURCE_FORMAT={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(3),s=function(){function e(){this.listeners={},this.uri="",this.image=null,this.duration=0,this.currentTime=0,this.ended=!1,this.listeners={},this.timerInterval=null,this.timerTime=-1,this.events=["play","pause","timeupdate","ended"],this.logger=n.Logger.getInstance()}return e.prototype.load=function(e,t){for(var i=null,n=0;n<t.length;n++){var s=t[n].type;if("image/jpeg"===s||"image/jpg"===s||"image/png"===s||"image/gif"===s){i=t[n];break}}return null!==i&&(this.image=document.getElementById("adsplayer-image"),this.image||(this.image=document.createElement("img"),this.image.id="adsplayer-image"),this.uri=i.uri,this.uri=r.Utils.isAbsoluteURI(this.uri)?this.uri:e+this.uri,this.logger.debug("Load image media, uri = "+this.uri),this.image.setAttribute("src",this.uri),this.currentTime=0,this.ended=!1,!0)},e.prototype.getType=function(){return"image"},e.prototype.getElement=function(){return this.image},e.prototype.addEventListener=function(e,t){this.image&&(-1!==this.events.indexOf(e)?this.addEventListener_(e,t):this.image.addEventListener(e,t))},e.prototype.removeEventListener=function(e,t){this.image&&(-1!==this.events.indexOf(e)?this.removeEventListener_(e,t):this.image.removeEventListener(e,t))},e.prototype.setDuration=function(e){this.duration=e},e.prototype.getDuration=function(){return this.duration},e.prototype.getCurrentTime=function(){return this.currentTime},e.prototype.setVolume=function(e){},e.prototype.getVolume=function(){return 0},e.prototype.play=function(){this.image&&this.startTimer()},e.prototype.pause=function(){this.image&&this.stopTimer()},e.prototype.stop=function(){this.image&&this.stopTimer()},e.prototype.reset=function(){this.image&&(this.image=null,this.listeners={})},e.prototype.isEnded=function(){return this.ended},e.prototype.getListeners=function(e){return e in this.listeners||(this.listeners[e]=[]),this.listeners[e]},e.prototype.addEventListener_=function(e,t){var i=this.getListeners(e);-1===i.indexOf(t)&&i.push(t)},e.prototype.removeEventListener_=function(e,t){var i=this.getListeners(e),n=i.indexOf(t);-1!==n&&i.splice(n,1)},e.prototype.notifyEvent=function(e){for(var t=this.getListeners(e),i=0;i<t.length;i++)t[i].call(this)},e.prototype.updateCurrentTime=function(){var e=(new Date).getTime();this.currentTime+=(e-this.timerTime)/1e3,this.notifyEvent("timeupdate"),this.currentTime>=this.duration&&(this.stopTimer(),this.ended=!0,this.notifyEvent("ended")),this.timerTime=e},e.prototype.startTimer=function(){null===this.timerInterval&&(this.notifyEvent("play"),this.timerTime=(new Date).getTime(),this.timerInterval=setInterval(this.updateCurrentTime.bind(this),200))},e.prototype.stopTimer=function(){null!==this.timerInterval&&(this.notifyEvent("pause"),clearInterval(this.timerInterval),this.timerInterval=null)},e}();t.ImagePlayer=s,t.default=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(3),s=function(){function e(){this.uri="",this.video=null,this.logger=n.Logger.getInstance()}return e.prototype.load=function(e,t){return this.video=document.getElementById("adsplayer-video"),this.video||(this.video=document.createElement("video"),this.video.autoplay=!1,this.video.id="adsplayer-video"),!!this.isMediaSupported(t[0].type)&&(t.sort(function(e,t){return e.bitrate&&t.bitrate?e.bitrate-t.bitrate:-1}),this.uri=t[0].uri,this.uri=r.Utils.isAbsoluteURI(this.uri)?this.uri:e+this.uri,this.logger.debug("Load video media, uri = "+this.uri),this.video.addEventListener("error",function(e){console.log(e)}),this.video.src=this.uri,!0)},e.prototype.getType=function(){return"video"},e.prototype.getElement=function(){return this.video},e.prototype.addEventListener=function(e,t){this.video&&this.video.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.video&&this.video.removeEventListener(e,t)},e.prototype.setDuration=function(e){},e.prototype.getDuration=function(){return this.video?this.video.duration:0},e.prototype.getCurrentTime=function(){return this.video?this.video.currentTime:0},e.prototype.getVolume=function(){return this.video?this.video.muted?0:this.video.volume:0},e.prototype.setVolume=function(e){this.video&&(this.video.volume=e)},e.prototype.play=function(){this.video&&this.video.play()},e.prototype.stop=function(){this.video&&(this.video.pause(),this.video.removeAttribute("src"),this.video.load())},e.prototype.pause=function(){this.video&&this.video.pause()},e.prototype.reset=function(){this.video&&(this.video=null)},e.prototype.isEnded=function(){return this.video.ended},e.prototype.isMediaSupported=function(e){if(!this.video)throw"isMediaSupported(): element not created";if(!(this.video instanceof HTMLMediaElement))throw"isMediaSupported(): element must be of type HTMLMediaElement";var t=this.video.canPlayType(e);return"probably"===t||"maybe"===t},e}();t.VideoPlayer=s,t.default=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=function(){function e(){this.trackingEvents=null,this.adMediaPlayer=null,this.currentTime=-1,this.mute=!1,this.unmute=!1,this.debug=n.Logger.getInstance(),this.eventListeners=[]}return e.prototype.init=function(e,t){this.trackingEvents=e,this.adMediaPlayer=t,this.mute=0===this.adMediaPlayer.getVolume(),this.unmute=this.adMediaPlayer.getVolume()>0},e.prototype.start=function(){0!==this.trackingEvents.length&&this.addPlayerEventListeners()},e.prototype.stop=function(){this.removePlayerEventListeners()},e.prototype.postEvent=function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.setRequestHeader("Content-Type","application/json; charset=UTF-8"),t.send()},e.prototype.addEventListener=function(e,t,i){var n=this,r={type:t,element:e,listener:function(){this.completed||void 0!==this.uri&&0!==this.uri.length&&(this.condition&&!this.condition()||(n.debug.log("Send tracking event "+this.event+", uri = "+this.uri),n.postEvent(this.uri),this.oneShot&&(this.completed=!0)))}.bind(i)};e.addEventListener(t,r.listener),this.eventListeners.push(r)},e.prototype.addPlayerEventListeners=function(){for(var e=this,t=function(t){var n=i.trackingEvents[t];if(n.uri&&n.uri.length>0)switch(n.event){case"creativeView":n.oneShot=!0,i.addEventListener(i.adMediaPlayer,"loadeddata",n);break;case"start":n.oneShot=!0,i.addEventListener(i.adMediaPlayer,"playing",n);break;case"pause":n.oneShot=!1,n.condition=function(){return!1===e.adMediaPlayer.isEnded()},i.addEventListener(i.adMediaPlayer,"pause",n);break;case"resume":n.oneShot=!1,n.condition=function(){return e.adMediaPlayer.getCurrentTime()>0},i.addEventListener(i.adMediaPlayer,"play",n);break;case"firstQuartile":n.oneShot=!0,n.condition=function(){return e.adMediaPlayer.getCurrentTime()/e.adMediaPlayer.getDuration()>=.25},i.addEventListener(i.adMediaPlayer,"timeupdate",n);break;case"midpoint":n.oneShot=!0,n.condition=function(){return e.adMediaPlayer.getCurrentTime()/e.adMediaPlayer.getDuration()>=.5},i.addEventListener(i.adMediaPlayer,"timeupdate",n);break;case"thirdQuartile":n.oneShot=!0,n.condition=function(){return e.adMediaPlayer.getCurrentTime()/e.adMediaPlayer.getDuration()>=.75},i.addEventListener(i.adMediaPlayer,"timeupdate",n);break;case"rewind":n.oneShot=!1,n.condition=function(){var t=e.adMediaPlayer.getCurrentTime()<e.currentTime&&!1===e.adMediaPlayer.isEnded();return e.currentTime=e.adMediaPlayer.getCurrentTime(),t},i.addEventListener(i.adMediaPlayer,"timeupdate",n);break;case"complete":i.addEventListener(i.adMediaPlayer,"ended",n);break;case"mute":n.oneShot=!1,n.condition=function(){var t=!e.mute&&0===e.adMediaPlayer.getVolume();return e.mute=0===e.adMediaPlayer.getVolume(),t},i.addEventListener(i.adMediaPlayer,"volumechange",n);break;case"unmute":n.oneShot=!1,n.condition=function(){var t=!e.unmute&&e.adMediaPlayer.getVolume()>0;return e.unmute=e.adMediaPlayer.getVolume()>0,t},i.addEventListener(i.adMediaPlayer,"volumechange",n);break;case"fullscreen":case"exitFullscreen":n.oneShot=!1,n.condition=function(e){void 0===e&&(e=n.event);var t="fullscreen"===e;return document.fullscreen===t||document.mozFullScreen===t||document.webkitIsFullScreen===t},i.addEventListener(document,"webkitfullscreenchange",n),i.addEventListener(document,"mozfullscreenchange",n),i.addEventListener(document,"MSFullscreenChange",n),i.addEventListener(document,"fullscreenChange",n);break;case"progress":n.oneShot=!0,n.condition=function(){return n.offsetPercent?e.adMediaPlayer.getCurrentTime()>=n.offsetPercent*e.adMediaPlayer.getDuration():e.adMediaPlayer.getCurrentTime()>=n.offsetInSeconds},i.addEventListener(i.adMediaPlayer,"timeupdate",n);break;case"acceptInvitationLinear":n.oneShot=!1,i.addEventListener(i.adMediaPlayer,"click",n);break;case"closeLinear":n.oneShot=!1,i.addEventListener(window,"beforeunload",n)}},i=this,n=0;n<this.trackingEvents.length;n++)t(n)},e.prototype.removePlayerEventListeners=function(){for(var e=0;e<this.eventListeners.length;e++)this.eventListeners[e].element.removeEventListener(this.eventListeners[e].type,this.eventListeners[e].listener);this.eventListeners=[]},e}();t.TrackingEventsManager=r,t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(9),r=i(8),s=i(7),o=i(0),a=i(1),u=i(2),d=function(){function e(){this.adPlayerContainer=null,this.mediaPlayer=null,this.trackingEventsManager=null,this.mainVideo=null,this.logger=o.Logger.getInstance(),this.eventBus=a.EventBus.getInstance(),this.onMediaPlayListener=this.onMediaPlay.bind(this),this.onMediaPauseListener=this.onMediaPause.bind(this),this.onMediaErrorListener=this.onMediaError.bind(this),this.onMediaTimeupdateListener=this.onMediaTimeupdate.bind(this),this.onMediaEndedListener=this.onMediaEnded.bind(this)}return e.prototype.init=function(e,t,i,n){return this.adPlayerContainer=t,this.mainVideo=i,this.load(e,n)},e.prototype.play=function(){this.play_()},e.prototype.pause=function(){this.pause_()},e.prototype.stop=function(){this.stop_()},e.prototype.parseTime=function(e){var t;return e?3!==(t=e.split(":")).length?-1:3600*parseInt(t[0])+60*parseInt(t[1])+parseFloat(t[2]):-1},e.prototype.onMediaPlay=function(){this.logger.debug("Creative media play"),this.eventBus.dispatchEvent(a.AdEvents.PLAY)},e.prototype.onMediaPause=function(){this.logger.debug("Creative media pause"),this.eventBus.dispatchEvent(a.AdEvents.PAUSE)},e.prototype.onMediaError=function(){this.logger.debug("Creative media error"),this.eventBus.dispatchEvent(a.AdEvents.CREATIVE_END)},e.prototype.onMediaEnded=function(){this.logger.debug("creative media ended"),this.eventBus.dispatchEvent(a.AdEvents.CREATIVE_END)},e.prototype.onMediaTimeupdate=function(){},e.prototype.onMainVideoVolumeChange=function(){this.mediaPlayer&&this.mediaPlayer.setVolume(this.mainVideo.muted?0:this.mainVideo.volume)},e.prototype.onAdClick=function(e){e.videoClicks&&(this.logger.debug("Creative Click"),e.videoClicks.clickThrough&&(this.logger.debug("Ad click, uri = "+e.videoClicks.clickThrough),this.eventBus.dispatchEvent(a.AdEvents.CLICK,{uri:e.videoClicks.clickThrough})))},e.prototype.load=function(e,t){var i,o,d;if(!e)return!1;if(0===e.mediaFiles.length)return!1;if(o=-1!==(i=e.mediaFiles[0]).type.indexOf("video"),d=-1!==i.type.indexOf("image"),o)this.mediaPlayer=new r.VideoPlayer;else{if(!d)return!1;this.mediaPlayer=new s.ImagePlayer}return this.logger.debug("Creative load"),this.mediaPlayer.load(t,e.mediaFiles)?(this.mediaPlayer.setDuration(this.parseTime(e.duration)),this.mediaPlayer.addEventListener("play",this.onMediaPlayListener),this.mediaPlayer.addEventListener("pause",this.onMediaPauseListener),this.mediaPlayer.addEventListener("error",this.onMediaErrorListener),this.mediaPlayer.addEventListener("timeupdate",this.onMediaTimeupdateListener),this.mediaPlayer.addEventListener("ended",this.onMediaEndedListener),e.trackingEvents&&(this.trackingEventsManager=new n.TrackingEventsManager,this.trackingEventsManager.init(e.trackingEvents,this.mediaPlayer),this.trackingEventsManager.start()),this.eventBus.dispatchEvent(a.AdEvents.CREATIVE_START),this.eventBus.dispatchEvent(u.EventTypes.ADD_ELEMENT,{element:this.mediaPlayer.getElement(),type:this.mediaPlayer.getType()}),this.adPlayerContainer.appendChild(this.mediaPlayer.getElement()),e.videoClicks&&(e.videoClicks.clickThrough&&(this.mediaPlayer.getElement().style.cursor="pointer"),this.mediaPlayer.getElement().addEventListener("click",this.onAdClick.bind(this,e))),this.onMainVideoVolumeChange(),this.mainVideo.addEventListener("volumechange",this.onMainVideoVolumeChange.bind(this)),this.play(),!0):(this.mediaPlayer=null,!1)},e.prototype.play_=function(){this.mediaPlayer&&(this.logger.debug("Creative play"),this.mediaPlayer.play())},e.prototype.pause_=function(){this.mediaPlayer&&(this.logger.debug("Creative pause"),this.mediaPlayer.pause())},e.prototype.stop_=function(){this.mediaPlayer&&(this.logger.debug("Creative stop"),this.mainVideo.removeEventListener("volumechange",this.onMainVideoVolumeChange),this.mainVideo=null,this.mediaPlayer.removeEventListener("play",this.onMediaPlayListener),this.mediaPlayer.removeEventListener("pause",this.onMediaPauseListener),this.mediaPlayer.removeEventListener("error",this.onMediaErrorListener),this.mediaPlayer.removeEventListener("timeupdate",this.onMediaTimeupdateListener),this.mediaPlayer.removeEventListener("ended",this.onMediaEndedListener),this.mediaPlayer.stop(),this.eventBus.dispatchEvent(u.EventTypes.REMOVE_ELEMENT,{element:this.mediaPlayer.getElement(),type:this.mediaPlayer.getType()}),this.adPlayerContainer.removeChild(this.mediaPlayer.getElement()),this.trackingEventsManager&&(this.trackingEventsManager.stop(),this.trackingEventsManager=null),this.mediaPlayer.reset(),this.mediaPlayer=null)},e}();t.CreativePlayer=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(10),r=i(0),s=i(1),o=function(){function e(){this.ad=null,this.adPlayerContainer=null,this.mainVideo=null,this.baseUrl="",this.creativeIndex=-1,this.creativePlayer=null,this.logger=r.Logger.getInstance(),this.eventBus=s.EventBus.getInstance(),this.onCreativeEndListener=this.onCreativeEnd.bind(this)}return e.prototype.init=function(e,t,i,n){this.ad=e,this.adPlayerContainer=t,this.mainVideo=i,this.baseUrl=n},e.prototype.start=function(){this.eventBus.dispatchEvent(s.AdEvents.AD_START),this.sendImpressions(this.ad.inLine.impressions),this.playCreative(0)},e.prototype.play=function(){this.resumeCreative()},e.prototype.pause=function(){this.pauseCreative()},e.prototype.stop=function(){this.stopCreative()},e.prototype.sendImpressions=function(e){var t;if(0!==e.length)for(var i=0;i<e.length;i++)if((t=e[i]).uri&&t.uri.length>0){this.logger.debug("Send Impression, uri = "+t.uri);var n=new XMLHttpRequest;n.open("GET",t.uri,!0),n.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n.send()}},e.prototype.onCreativeEnd=function(){this.logger.debug("Creative ended"),this.stopCreative(),this.playNextCreative()},e.prototype.pauseCreative=function(){this.creativePlayer&&this.creativePlayer.pause()},e.prototype.resumeCreative=function(){this.creativePlayer&&this.creativePlayer.play()},e.prototype.stopCreative=function(){this.creativePlayer&&(this.eventBus.removeEventListener("creativeEnd",this.onCreativeEndListener),this.creativePlayer.stop(),this.creativePlayer=null)},e.prototype.playCreative=function(e){var t,i=this.ad.inLine.creatives[e];this.creativeIndex=e,this.logger.debug("Play Creative - index = "+this.creativeIndex),(t=i.linear)?(this.logger.debug("Play Linear Ad, duration = "+t.duration),this.eventBus.addEventListener(s.AdEvents.CREATIVE_END,this.onCreativeEndListener),this.creativePlayer=new n.CreativePlayer,this.creativePlayer.init(i.linear,this.adPlayerContainer,this.mainVideo,this.baseUrl)||this.playNextCreative()):this.playNextCreative()},e.prototype.playNextCreative=function(){this.creativeIndex++,this.creativeIndex<this.ad.inLine.creatives.length?this.playCreative(this.creativeIndex):this.eventBus.dispatchEvent(s.AdEvents.AD_END)},e}();t.AdPlayer=o,t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(11),r=i(0),s=i(1),o=function(){function e(){this.vasts=[],this.adPlayerContainer=null,this.mainVideo=null,this.vastIndex=-1,this.adIndex=-1,this.adPlayer=null,this.logger=r.Logger.getInstance(),this.eventBus=s.EventBus.getInstance(),this.onAdEndListener=this.onAdEnd.bind(this)}return e.prototype.init=function(e,t,i){this.vasts=e,this.adPlayerContainer=t,this.mainVideo=i},e.prototype.start=function(){this.vasts&&0!==this.vasts.length&&(this.eventBus.dispatchEvent(s.AdEvents.TRIGGER_START),this.playVast(0))},e.prototype.play=function(){this.resumeAd()},e.prototype.pause=function(){this.pauseAd()},e.prototype.stop=function(){this.stopAd()},e.prototype.onAdEnd=function(){this.logger.debug("Ad ended"),this.stopAd(),this.playNextAd()},e.prototype.pauseAd=function(){this.adPlayer&&this.adPlayer.pause()},e.prototype.resumeAd=function(){this.adPlayer&&this.adPlayer.play()},e.prototype.stopAd=function(){this.adPlayer&&(this.eventBus.removeEventListener("adEnd",this.onAdEndListener),this.adPlayer.stop(),this.adPlayer=null)},e.prototype.playAd=function(e){var t=this.vasts[this.vastIndex],i=t.ads[e];this.adIndex=e,this.logger.debug("Play Ad - index = "+this.adIndex),this.eventBus.addEventListener(s.AdEvents.AD_END,this.onAdEndListener),this.adPlayer=new n.AdPlayer,this.adPlayer.init(i,this.adPlayerContainer,this.mainVideo,t.baseUrl),this.adPlayer.start()},e.prototype.playNextAd=function(){var e=this.vasts[this.vastIndex];this.adIndex++,this.adIndex<e.ads.length?this.playAd(this.adIndex):this.playNextVast()},e.prototype.playVast=function(e){0!==this.vasts[e].ads.length&&(this.vastIndex=e,this.logger.debug("Play Vast - index = "+this.vastIndex),this.playAd(0))},e.prototype.playNextVast=function(){this.vastIndex++,this.vastIndex<this.vasts.length?this.playVast(this.vastIndex):this.eventBus.dispatchEvent(s.AdEvents.TRIGGER_END)},e}();t.VastPlayerManager=o,t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(){this.version="",this.ads=[],this.baseUrl=""}}();t.Vast=n;var r=function(){return function(){this.id="",this.sequence=0,this.inLine=null,this.wrapper=null}}();t.Ad=r;var s=function(){return function(){this.adSystem="",this.adTitle="",this.description="",this.survey="",this.error="",this.impressions=[],this.creatives=[],this.extensions=[]}}();t.InLine=s;var o=function(){return function(){this.uri="",this.id=""}}();t.Impression=o;var a=function(){return function(){this.uri="",this.other=""}}();t.Extensions=a;var u=function(){return function(){this.id="",this.adId="",this.sequence=0,this.linear=null,this.CompanionAds=[],this.nonLinearAds=[]}}();t.Creative=u,function(e){e.LINEAR="linear",e.NON_LINEAR_ADS="NonLinearAds",e.COMPANION_ADS="CompanionAds"}(t.CREATIVE_TYPE||(t.CREATIVE_TYPE={}));var d=function(){return function(){this.duration="",this.trackingEvents=[],this.adParameters="",this.videoClicks=null,this.mediaFiles=[]}}();t.Linear=d;var l=function(){return function(){this.id="",this.width=0,this.height=0,this.staticResource=null,this.iFrameResource="",this.hTMLResource="",this.trackingEvents=[],this.clickThrough="",this.altText="",this.adParameters=""}}();t.Companion=l;var h=function(){return function(){this.id="",this.width=0,this.height=0,this.expandedWidth=0,this.expandedHeight=0,this.scalable=!0,this.maintainAspectRatio=!0,this.apiFramework="",this.staticResource=null,this.hTMLResource="",this.trackingEvents=[],this.clickThrough="",this.adParameters=""}}();t.NonLinear=h;var c=function(){return function(){this.uri="",this.event="",this.offsetInSeconds=0,this.offsetPercent=0,this.oneShot=!0,this.completed=!0}}();t.TrackingEvent=c,function(e){e.CREATIVEVIEW="creativeView",e.START="start",e.MIDPOINT="midpoint",e.FIRSTQUARTILE="firstQuartile",e.THIRDQUARTILE="thirdQuartile",e.COMPLETE="complete",e.MUTE="mute",e.UNMUTE="unmute",e.PAUSE="pause",e.REWIND="rewind",e.RESUME="resume",e.FULLSCREEN="fullscreen",e.EXPAND="expand",e.COLLAPSE="collapse",e.ACCEPTINVITATION="acceptInvitation",e.CLOSE="close"}(t.TRACKINGEVENT_TYPE||(t.TRACKINGEVENT_TYPE={}));var p=function(){return function(){this.clickThrough="",this.clickTracking="",this.customClick=""}}();t.VideoClicks=p;var g=function(){return function(){this.id="",this.delivery="",this.type="",this.bitrate=0,this.width=0,this.height=0,this.scalable=!0,this.maintainAspectRatio=!0,this.apiFramework="",this.uri=""}}();t.MediaFile=g,function(e){e.STREAMING="streaming",e.PROGRESSIVE="progressive "}(t.MEIAFILE_DELIVERY||(t.MEIAFILE_DELIVERY={}));var v=function(){return function(){this.uRI="",this.creativeType=""}}();t.StaticResource=v},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(13),r=i(5),s=function(){function e(){}return e.prototype.parse=function(e){var t=new n.Vast,i=r.XmlDom.getElement(e,"VAST");return null===i?t:(t.version=i.getAttribute("version"),this.getAds(i,t),t)},e.prototype.getTrackingEvent=function(e){var t=new n.TrackingEvent;if(t.event=e.getAttribute("event"),t.uri=r.XmlDom.getNodeTextValue(e),"progress"==t.event){var i=e.getAttribute("offset");-1==i.indexOf("%")?t.offsetInSeconds=new Date("1970-01-01T"+i+"Z").getTime()/1e3:t.offsetPercent=i.substring(0,i.indexOf("%"))/100}return t},e.prototype.getVideoClicks=function(e){for(var t,i,s=new n.VideoClicks,o=0;o<e.childNodes.length;o++)switch(t=e.childNodes[o].nodeName,i=r.XmlDom.getNodeTextValue(e.childNodes[o]),t){case"ClickThrough":s.clickThrough=i;break;case"ClickTracking":s.clickTracking=i;break;case"CustomClick":s.customClick=i}return s},e.prototype.getMediaFile=function(e){var t=new n.MediaFile;return t.id=e.getAttribute("id"),t.delivery=e.getAttribute("delivery"),t.type=e.getAttribute("type"),t.bitrate=e.getAttribute("bitrate"),t.width=e.getAttribute("width"),t.height=e.getAttribute("height"),t.scalable=e.getAttribute("scalable"),t.maintainAspectRatio=e.getAttribute("maintainAspectRatio"),t.apiFramework=e.getAttribute("apiFramework"),t.uri=r.XmlDom.getNodeTextValue(e),t},e.prototype.getLinear=function(e){var t,i,s,o=new n.Linear;o.duration=r.XmlDom.getChildNodeTextValue(e,"Duration"),o.adParameters=r.XmlDom.getChildNodeTextValue(e,"AdParameters"),t=r.XmlDom.getSubElements(e,"TrackingEvents","Tracking");for(var a=0;a<t.length;a++)o.trackingEvents.push(this.getTrackingEvent(t[a]));(i=r.XmlDom.getElement(e,"VideoClicks"))&&(o.videoClicks=this.getVideoClicks(i)),s=r.XmlDom.getSubElements(e,"MediaFiles","MediaFile");for(a=0;a<s.length;a++)o.mediaFiles.push(this.getMediaFile(s[a]));return o},e.prototype.getCreative=function(e){var t,i=new n.Creative;return i.id=e.getAttribute("id"),i.adId=e.getAttribute("AdID"),i.sequence=e.getAttribute("sequence"),(t=r.XmlDom.getElement(e,"Linear"))&&(i.linear=this.getLinear(t)),i},e.prototype.getInLine=function(e){var t,i,s=new n.InLine,o=r.XmlDom.getElement(e,"InLine");if(null===o)return null;s.adSystem=r.XmlDom.getChildNodeTextValue(o,"AdSystem"),s.adTitle=r.XmlDom.getChildNodeTextValue(o,"AdTitle"),s.description=r.XmlDom.getChildNodeTextValue(o,"Description"),s.survey=r.XmlDom.getChildNodeTextValue(o,"Survey"),s.error=r.XmlDom.getChildNodeTextValue(o,"Error"),t=r.XmlDom.getElements(o,"Impression");for(var a=0;a<t.length;a++){var u=new n.Impression;u.id=t[a].getAttribute("id"),u.uri=r.XmlDom.getNodeTextValue(t[a]),s.impressions.push(u)}i=r.XmlDom.getSubElements(o,"Creatives","Creative");for(a=0;a<i.length;a++)s.creatives.push(this.getCreative(i[a]));return s},e.prototype.getAd=function(e){var t=new n.Ad;return t.id=e.getAttribute("id"),t.sequence=e.getAttribute("sequence"),t.inLine=this.getInLine(e),t},e.prototype.getAds=function(e,t){for(var i=r.XmlDom.getElements(e,"Ad"),n=0;n<i.length;n++)t.ads.push(this.getAd(i[n]))},e}();t.VastParser=s,t.default=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(6),r=function(){function e(){this.trigger=null}return e.prototype.init=function(e){this.trigger=e},e.prototype.getTrigger=function(){return this.trigger},e.prototype.checkStartConditions=function(e){return!this.trigger.activated&&this.evaluateConditions(this.trigger.startConditions,e)},e.prototype.checkEndConditions=function(e){return this.evaluateConditions(this.trigger.endConditions,e)},e.prototype.parseTime=function(e){var t;return e?3!==(t=e.split(":")).length?-1:3600*parseInt(t[0])+60*parseInt(t[1])+parseFloat(t[2]):-1},e.prototype.compareValues=function(e,t,i){if(e<0||t<0)return!1;var r=!1;switch(i){case n.CONDITION_OPERATOR.EQ:r=e===t;break;case n.CONDITION_OPERATOR.NEQ:r=e!==t;break;case n.CONDITION_OPERATOR.GTR:r=e>t;break;case n.CONDITION_OPERATOR.GEQ:r=e>=t;break;case n.CONDITION_OPERATOR.LT:r=e<t;break;case n.CONDITION_OPERATOR.LEQ:r=e<=t;break;case n.CONDITION_OPERATOR.MOD:r=e%t==0}return r},e.prototype.evaluateCondition=function(e,t){var i=!1;if(0===t.currentTime&&e.type===n.CONDITION_TYPE.EVENT&&e.name===n.CONDITION_NAME.ON_ITEM_START&&(i=!0),e.type===n.CONDITION_TYPE.PROPERTY)switch(e.name){case n.CONDITION_NAME.POSITION:i=this.compareValues(t.currentTime,this.parseTime(e.value),e.operator);break;case n.CONDITION_NAME.DURATION:i=this.compareValues(t.duration,this.parseTime(e.value),e.operator)}t.ended&&e.type===n.CONDITION_TYPE.EVENT&&e.name===n.CONDITION_NAME.ON_ITEM_END&&(i=!0);for(var r=0;r<e.conditions.length;r++)i=i&&this.evaluateCondition(e.conditions[r],t);return i},e.prototype.evaluateConditions=function(e,t){for(var i=!1,n=0;n<e.length;n++)i=i||this.evaluateCondition(e[n],t);return i},e}();t.TriggerManager=r,t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(6),r=i(5),s=function(){function e(){}return e.prototype.parse=function(e){var t=new n.Mast,i=r.XmlDom.getElement(e,"MAST");return null===i?t:(this.getTriggers(i,t),t)},e.prototype.getCondition=function(e){var t,i=new n.Condition;i.type=e.getAttribute("type"),i.name=e.getAttribute("name"),i.value=e.getAttribute("value"),i.operator=e.getAttribute("operator"),t=e.getElementsByTagName("condition");for(var r=0;r<t.length;r++)i.conditions.push(this.getCondition(t[r]));return i},e.prototype.getSource=function(e){var t,i=new n.Source;i.uri=e.getAttribute("uri"),i.altReference=e.getAttribute("altReference"),i.format=e.getAttribute("format"),t=e.getElementsByTagName("source");for(var r=0;r<t.length;r++)i.sources.push(this.getSource(t[r]));return i},e.prototype.getTrigger=function(e){var t=new n.Trigger,i=r.XmlDom.getSubElements(e,"startConditions","condition"),s=r.XmlDom.getSubElements(e,"endConditions","condition"),o=r.XmlDom.getSubElements(e,"sources","source");t.id=e.getAttribute("id"),t.description=e.getAttribute("description");for(var a=0;a<i.length;a++)t.startConditions.push(this.getCondition(i[a]));for(a=0;a<s.length;a++)t.endConditions.push(this.getCondition(s[a]));for(a=0;a<o.length;a++)t.sources.push(this.getSource(o[a]));return t},e.prototype.getTriggers=function(e,t){for(var i=r.XmlDom.getSubElements(e,"triggers","trigger"),n=0;n<i.length;n++)t.triggers.push(this.getTrigger(i[n]))},e}();t.MastParser=s,t.default=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(1),s=i(4),o=i(2),a=function(){function e(){this.logger=n.Logger.getInstance(),this.eventBus=r.EventBus.getInstance()}return e.getInstance=function(){return null===this.instance&&(this.instance=new e),this.instance},e.prototype.sendError=function(e,t){var i=s.ErrorMessages[e];this.logger.error("[Error] Code: "+e+", Message: "+i+", Data: "+JSON.stringify(t,null,"\t")),this.eventBus.dispatchEvent(o.EventTypes.ERROR,{code:e,message:i,data:t})},e.instance=null,e}();t.ErrorHandler=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(4),r=function(){function e(){this.request=null,this.url="",this.baseUrl="",this.aborted=!1,this.needFailureReport=!0}return e.prototype.load=function(e){var t=this;return new Promise(function(i,n){t.load_(e,i,n)})},e.prototype.abort=function(){this.abort_()},e.prototype.parseBaseUrl=function(e){var t=null;return-1!==e.indexOf("/")&&(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),t=e.substring(0,e.lastIndexOf("/")+1)),t},e.prototype.parseXml=function(e){if(!DOMParser)return null;try{var t=(new DOMParser).parseFromString(e,"text/xml");if(t.getElementsByTagName("parsererror").length>0)throw new Error("Error parsing XML");return t}catch(e){return null}},e.prototype.load_=function(e,t,i){var n=this;this.url=e,this.baseUrl=this.parseBaseUrl(e),this.request=new XMLHttpRequest,this.request.onload=function(e){n.onLoad(t,i)},this.request.onloadend=function(e){n.onLoadend(t,i)},this.request.onerror=function(e){n.onLoadend(t,i)},this.request.onabort=function(e){n.onAbort()},this.request.open("GET",e,!0),this.request.timeout=1e4,this.request.send()},e.prototype.onAbort=function(){this.aborted=!0},e.prototype.onLoad=function(e,t){if(!(this.request.status<200||this.request.status>299)&&200===this.request.status&&4===this.request.readyState){var i=this.request.responseXML||this.parseXml(this.request.responseText);if(null===i)return void(this.needFailureReport=!0);this.request.responseURL&&(this.baseUrl=this.parseBaseUrl(this.request.responseURL)),this.needFailureReport=!1,e({dom:i,baseUrl:this.baseUrl})}},e.prototype.onLoadend=function(e,t){this.needFailureReport&&(this.needFailureReport=!1,this.aborted?t():this.request.status<200||this.request.status>299?t({name:n.ErrorCodes.DOWNLOAD_ERR_FILE,data:{url:this.url,status:this.request.status}}):null===this.request.responseXML&&t({name:n.ErrorCodes.DOWNLOAD_ERR_NOT_XML,data:{url:this.url}}))},e.prototype.abort_=function(){null!==this.request&&this.request.readyState>0&&this.request.readyState<4&&this.request.abort()},e}();t.FileLoader=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(18),s=i(17),o=i(1),a=i(16),u=i(15),d=i(14),l=i(12),h=i(3),c=i(2),p=function(){function e(){this.mainVideo=null,this.adsPlayerContainer=null,this.mast=null,this.fileLoaders=[],this.triggerManagers=[],this.vastPlayerManager=null,this.mastParser=new a.MastParser,this.vastParser=new d.VastParser,this.errorHandler=s.ErrorHandler.getInstance(),this.logger=n.Logger.getInstance(),this.eventBus=o.EventBus.getInstance(),this.handleMainPlayerPlayback=!0,this.onVideoPlayingListener=this.onVideoPlaying.bind(this),this.onVideoTimeupdateListener=this.onVideoTimeupdate.bind(this),this.onVideoEndedListener=this.onVideoEnded.bind(this),this.onTriggerEndListener=this.onTriggerEnd.bind(this)}return e.prototype.init=function(e,t,i){void 0===i&&(i=!1),this.mainVideo=e,this.adsPlayerContainer=t,this.handleMainPlayerPlayback=i,this.mainVideo.addEventListener("playing",this.onVideoPlayingListener),this.mainVideo.addEventListener("timeupdate",this.onVideoTimeupdateListener),this.mainVideo.addEventListener("seeking",this.onVideoTimeupdateListener),this.mainVideo.addEventListener("ended",this.onVideoEndedListener),this.eventBus.addEventListener(o.AdEvents.TRIGGER_END,this.onTriggerEndListener)},e.prototype.load=function(e){var t=this,i=new r.FileLoader;return this.mast=null,this.triggerManagers=[],this.logger.debug("Download MAST file: "+e),new Promise(function(n,r){i.load(e).then(function(e){t.logger.debug("Parse MAST file"),t.parseMastFile(e.dom,e.baseUrl),n(t.start())}).catch(function(e){e?(t.errorHandler.sendError(e.name,e.data),r(e)):n(!1)}),t.fileLoaders.push(i)})},e.prototype.stop=function(){this.logger.debug("Stop");for(var e=0;e<this.fileLoaders.length;e++)this.fileLoaders[e].abort();this.fileLoaders=[],this.vastPlayerManager&&(this.vastPlayerManager.stop(),this.vastPlayerManager=null)},e.prototype.reset=function(){this.logger.debug("Reset"),this.stop(),this.triggerManagers=[],this.mast=null},e.prototype.destroy=function(){this.logger.debug("Destroy"),this.reset(),this.mainVideo.removeEventListener("playing",this.onVideoPlayingListener),this.mainVideo.removeEventListener("timeupdate",this.onVideoTimeupdateListener),this.mainVideo.removeEventListener("seeking",this.onVideoTimeupdateListener),this.mainVideo.removeEventListener("ended",this.onVideoEndedListener),this.eventBus.removeEventListener("triggerEnd",this.onTriggerEndListener)},e.prototype.play=function(){this.logger.debug("Play"),this.vastPlayerManager&&this.vastPlayerManager.play()},e.prototype.pause=function(){this.logger.debug("Pause"),this.vastPlayerManager&&this.vastPlayerManager.pause()},e.prototype.loadVast=function(e){var t=this,i=new r.FileLoader,n=null;return new Promise(function(r){t.logger.debug("Download VAST file: "+e),i.load(e).then(function(e){t.logger.debug("Parse VAST file"),(n=t.vastParser.parse(e.dom)).baseUrl=e.baseUrl,r(n)}).catch(function(e){e&&t.errorHandler.sendError(e.name,e.data),r(null)}),t.fileLoaders.push(i)})},e.prototype.loadTriggerVasts=function(e){for(var t=[],i=0;i<e.sources.length;i++){var n=e.sources[i].uri;n=h.Utils.isAbsoluteURI(n)?n:this.mast.baseUrl+n,t.push(this.loadVast(n))}return new Promise(function(i,n){Promise.all(t).then(function(t){for(var n=0;n<t.length;n++)t[n]&&t[n].ads&&t[n].ads.length>0&&e.vasts.push(t[n]);i()}).catch(function(){n()})})},e.prototype.parseMastFile=function(e,t){var i;if(this.mast=this.mastParser.parse(e),this.mast){this.mast.baseUrl=t;for(var n=0;n<this.mast.triggers.length;n++)(i=new u.TriggerManager).init(this.mast.triggers[n]),this.triggerManagers.push(i)}},e.prototype.onVideoPlaying=function(){this.handleMainPlayerPlayback&&this.vastPlayerManager&&(this.logger.debug("Pause main video"),this.mainVideo.pause())},e.prototype.onVideoTimeupdate=function(){var e=this.checkTriggersStart();null!==e&&this.activateTrigger(e,!0)},e.prototype.onVideoEnded=function(){var e=this.checkTriggersStart();null!==e&&this.activateTrigger(e,!0),this.checkTriggersEnd()},e.prototype.pauseVideo=function(){this.handleMainPlayerPlayback&&this.mainVideo&&!this.mainVideo.paused&&(this.logger.debug("Pause main video"),this.mainVideo.pause())},e.prototype.resumeVideo=function(){this.handleMainPlayerPlayback&&this.mainVideo&&this.mainVideo.paused&&(this.logger.debug("Resume main video"),this.mainVideo.play())},e.prototype.onTriggerEnd=function(){this.logger.debug("End playing trigger"),this.vastPlayerManager&&(this.vastPlayerManager=null);var e=this.checkTriggersStart();null!==e?this.activateTrigger(e,!1):(this.eventBus.dispatchEvent(c.EventTypes.END),this.mainVideo.ended||this.resumeVideo())},e.prototype.playTrigger=function(e){0!==e.vasts.length?(this.pauseVideo(),this.logger.debug("Start playing trigger "+e.id),this.vastPlayerManager=new l.VastPlayerManager,this.vastPlayerManager.init(e.vasts,this.adsPlayerContainer,this.mainVideo),this.vastPlayerManager.start()):this.onTriggerEnd()},e.prototype.activateTrigger=function(e,t){var i=this;this.vastPlayerManager||(t&&this.eventBus.dispatchEvent(c.EventTypes.START,{currentTime:this.mainVideo.currentTime,ended:this.mainVideo.ended}),this.logger.debug("Activate trigger "+e.id),e.activated=!0,0===e.vasts.length?this.loadTriggerVasts(e).then(function(){i.playTrigger(e)}):this.playTrigger(e))},e.prototype.checkTriggersStart=function(){for(var e=0;e<this.triggerManagers.length;e++)if(this.triggerManagers[e].checkStartConditions(this.mainVideo))return this.triggerManagers[e].getTrigger();return null},e.prototype.checkTriggersEnd=function(){for(var e=0;e<this.triggerManagers.length;e++)this.triggerManagers[e].checkEndConditions(this.mainVideo)&&(this.triggerManagers.splice(0,1),e--)},e.prototype.start=function(){if(this.mast){this.logger.debug("Start"),0===this.mast.triggers.length&&this.logger.warn("No trigger in MAST");var e=this.checkTriggersStart();return null!==e&&(this.activateTrigger(e,!0),!0)}},e}();t.AdsPlayerController=p,t.default=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(19),r=i(1),s=i(0),o=i(2),a=function(){function e(){this.adsPlayerController=null,this.eventBus=r.EventBus.getInstance(),this.logger=s.Logger.getInstance(),this.error=null,this.onErrorListener=this.onError.bind(this)}return e.prototype.getName=function(){return"AdsPlayer"},e.prototype.init=function(e,t,i){void 0===i&&(i=!0),this.adsPlayerController=new n.AdsPlayerController,this.adsPlayerController.init(e,t,i),this.eventBus.addEventListener(o.EventTypes.ERROR,this.onErrorListener)},e.prototype.load=function(e){var t=this;return new Promise(function(i,n){e.hasOwnProperty("adsUrl")?t.adsPlayerController.load(e.adsUrl).then(function(e){i(e)}).catch(function(e){n(e)}):i(!1)})},e.prototype.stop=function(){this.adsPlayerController.stop()},e.prototype.reset=function(){this.adsPlayerController.reset()},e.prototype.destroy=function(){this.adsPlayerController.destroy(),this.eventBus.removeEventListener(o.EventTypes.ERROR,this.onErrorListener)},e.prototype.getVersion=function(){return"1.4.0"},e.prototype.getVersionFull=function(){return"1.4.0"},e.prototype.getBuildDate=function(){return"2019-1-4"},e.prototype.play=function(){this.adsPlayerController.play()},e.prototype.pause=function(){this.adsPlayerController.pause()},e.prototype.addEventListener=function(e,t){this.eventBus.addEventListener(e,t)},e.prototype.removeEventListener=function(e,t){this.eventBus.removeEventListener(e,t)},e.prototype.getError=function(){return this.error},e.prototype.enableLogs=function(e){this.logger.setLevel(e?4:0)},e.prototype.onError=function(e){this.error=e.data},e}();t.AdsPlayer=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(20);t.AdsPlayer=n.AdsPlayer;var r=i(2);t.EventTypes=r.EventTypes;var s=i(4);t.ErrorCodes=s.ErrorCodes}])});
//# sourceMappingURL=adsplayer.js.map