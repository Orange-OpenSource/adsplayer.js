{"version":3,"sources":["node_modules/browser-pack/_prelude.js","adsplayer.js","index.js","src/AdsPlayer.js","src/AdsPlayerController.js","src/Debug.js","src/ErrorHandler.js","src/EventBus.js","src/FileLoader.js","src/mast/MastParser.js","src/mast/TriggerManager.js","src/mast/model/Mast.js","src/media/ImagePlayer.js","src/media/VideoPlayer.js","src/utils/utils.js","src/utils/xmldom.js","src/vast/AdPlayer.js","src/vast/CreativePlayer.js","src/vast/TrackingEventsManager.js","src/vast/VastParser.js","src/vast/VastPlayerManager.js","src/vast/model/Vast.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","adsplayer","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","1","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","AdsPlayer","undefined","_AdsPlayer","_AdsPlayer2","context","./src/AdsPlayer","2","_classCallCheck","instance","Constructor","TypeError","_onError","_error","data","_onWarning","_warning","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","_AdsPlayerController","_AdsPlayerController2","_EventBus","_EventBus2","NAME","VERSION","GIT_TAG","BUILD_DATE","adsPlayerContainer","_adsPlayerContainer","_eventBus","getInstance","_adsPlayerController","onErrorListener","bind","onWarningListener","player","callback","init","addEventListener","stream","adsUrl","load","then","stop","reset","destroy","removeEventListener","indexOf","play","pause","type","listener","useCapture","./AdsPlayerController","./EventBus","3","_Debug","_Debug2","_FileLoader","_FileLoader2","_ErrorHandler","_ErrorHandler2","_MastParser","_MastParser2","_TriggerManager","_TriggerManager2","_VastParser","_VastParser2","_VastPlayerManager","_VastPlayerManager2","_utils","_utils2","AdsPlayerController","_mainPlayer","_mainVideo","_mast","_fileLoaders","_triggerManagers","_vastPlayerManager","_mastParser","_vastParser","_errorHandler","_debug","_onVideoPlayingListener","_onVideoPlaying","_onVideoTimeupdateListener","_onVideoTimeupdate","_onVideoEndedListener","_onVideoEnded","_onTriggerEndListener","_onTriggerEnd","url","_this","fileLoader","vast","Promise","resolve","log","result","parse","response","baseUrl","error","sendWarning","LOAD_VAST_FAILED","push","trigger","uri","loadVastPromises","sources","isAbsoluteURI","_loadVast","reject","all","vasts","ads","mastContent","mastBaseUrl","triggerManager","triggers","_checkTriggersStart","_activateTrigger","_checkTriggersEnd","paused","dispatchEvent","ended","_resumeVideo","_pauseVideo","id","start","firstTrigger","_this2","activated","_loadTriggerVasts","_playTrigger","checkStartConditions","getTrigger","checkEndConditions","splice","warn","getVideoModel","getElement","setLevel","_this3","_parseMastFile","_start","sendError","name","message","abort","./Debug","./ErrorHandler","./FileLoader","./mast/MastParser","./mast/TriggerManager","./utils/utils","./vast/VastParser","./vast/VastPlayerManager","4","Date","HHMMSSmmm","h","getHours","toString","m","getMinutes","getSeconds","ms","getMilliseconds","HH","MM","SS","mmm","MMSSmmm","MemoryLogger","logArray","showLevel","info","debug","getLogs","NONE","ERROR","WARN","INFO","DEBUG","ALL","_instance","Debug","_level","_showTimestamp","_showElapsedTime","_startTime","_logger","console","level","logLevel","args","logTime","_getStringLevel","Array","apply","forEach","item","getLevel","_prepareLog","_log","arguments","5","ErrorHandler","JSON","stringify","DOWNLOAD_ERR_FILES","DOWNLOAD_ERR_NOT_XML","NO_VALID_MEDIA_FOUND","LOAD_MEDIA_FAILED","UNSUPPORTED_MEDIA_FILE","UNAVAILABLE_LINK","6","EventBus","_registrations","captype","listeners","_getListeners","idx","evt","slice","defaultPrevented","7","FileLoader","_request","base","substring","lastIndexOf","DOMParser","parser","xmlDoc","parseFromString","getElementsByTagName","readyState","_parseBaseUrl","needFailureReport","onload","report","onabort","aborted","status","responseXML","_parseXml","responseText","responseURL","XMLHttpRequest","onloadend","onerror","open","timeout","send","_load","8","_Mast","_Mast2","_xmldom","_xmldom2","MastParser","conditionNode","condition","Condition","conditionNodes","getAttribute","operator","conditions","_getCondition","sourceNode","source","Source","sourceNodes","altReference","format","_getSource","triggerNode","Trigger","startConditionNodes","getSubElements","endConditionNodes","description","startConditions","endConditions","mastNode","mast","triggerNodes","_getTrigger","xmlDom","mast_","Mast","_getTriggers","../utils/xmldom","./model/Mast","9","TriggerManager","_trigger","str","timeParts","SECONDS_IN_HOUR","SECONDS_IN_MIN","split","parseInt","parseFloat","value1","value2","res","OPERATOR","EQ","NEQ","GTR","GEQ","LT","LEQ","MOD","video","currentTime","TYPE","EVENT","ON_ITEM_START","PROPERTY","POSITION","_compareValues","_parseTime","DURATION","duration","ON_ITEM_END","_evaluateCondition","_evaluateConditions","10","alreadyProcessed","FORMAT","VAST","UIF","11","ImagePlayer","_uri","_image","_duration","_currentTime","_ended","_listeners","_timerInterval","_timerTime","_events","time","getTime","_notifyEvent","_stopTimer","setInterval","_updateCurrentTime","clearInterval","mediaFiles","mediaFile","document","getElementById","createElement","autoplay","src","_addEventListener","_removeEventListener","_startTimer","../Debug","../utils/utils","12","VideoPlayer","_video","mimeType","HTMLMediaElement","canPlay","canPlayType","isMediaSupported","sort","b","bitrate","muted","volume","13","utils","toLowerCase","14","xmldom","node","elements","child","firstElementChild","firstChild","namespaceURI","getElementsByTagNameNS","getElements","subName","element","getChildNode","childNodes","nodeName","getNodeTextValue","cdataSection","textSection","nodeValue","getChildNodeTextValue","15","_CreativePlayer","_CreativePlayer2","AdPlayer","_ad","_adPlayerContainer","_baseUrl","_creativeIndex","_creativePlayer","_onCreativeEndListener","_onCreativeEnd","impressions","impression","http","setRequestHeader","_stopCreative","_playNextCreative","index","linear","creative","inLine","creatives","_playCreative","ad","adPlayerContainer","mainVideo","_sendImpressions","_resumeCreative","_pauseCreative","../EventBus","./CreativePlayer","16","_TrackingEventsManager","_TrackingEventsManager2","_VideoPlayer","_VideoPlayer2","_ImagePlayer","_ImagePlayer2","CreativePlayer","_mediaPlayer","_trackingEventsManager","_onMediaPlayListener","_onMediaPlay","_onMediaPauseListener","_onMediaPause","_onMediaErrorListener","_onMediaError","_onMediaTimeupdateListener","_onMediaTimeupdate","_onMediaEndedListener","_onMediaEnded","setVolume","videoClicks","clickThrough","isVideo","isImage","setDuration","trackingEvents","getType","appendChild","style","cursor","_onAdClick","_onMainVideoVolumeChange","_play","removeChild","_pause","_stop","../media/ImagePlayer","../media/VideoPlayer","./TrackingEventsManager","17","TrackingEventsManager","_trackingEvents","_adMediaPlayer","_mute","_unmute","_eventListeners","xhr","eventType","trackingEvent","_listener","completed","event","_postEvent","oneShot","_eventListener","_loop","isEnded","getCurrentTime","getDuration","getVolume","state","fullScreen","mozFullScreen","webkitIsFullScreen","offsetPercent","offsetInSeconds","adMediaPlayer","_addPlayerEventListeners","_removePlayerEventListeners","18","_Vast","_Vast2","VastParser","trackingNode","TrackingEvent","offsetValue","videoClicksNode","VideoClicks","clickTracking","customClick","mediaFileNode","MediaFile","delivery","width","height","scalable","maintainAspectRatio","apiFramework","linearNode","Linear","trackingNodes","mediaFileNodes","adParameters","_getTrackingEvent","_getVideoClicks","_getMediaFile","creativeNode","Creative","adId","sequence","_getLinear","adNode","InLine","inLineNode","impressionNodes","creativeNodes","adSystem","adTitle","survey","Impression","_getCreative","Ad","_getInLine","vastNode","vast_","adNodes","_getAd","Vast","version","_getAds","./model/Vast","19","_AdPlayer","_AdPlayer2","VastPlayerManager","_vasts","_adIndex","_adPlayer","_onAdEndListener","_onAdEnd","_stopAd","_playNextAd","_vastIndex","_playAd","_playNextVast","_playVast","_resumeAd","_pauseAd","./AdPlayer","20","wrapper","extensions","Extensions","other","CompanionAds","nonLinearAds","LINEAR","NON_LINEAR_ADS","COMPANION_ADS","Companion","staticResource","iFrameResource","hTMLResource","altText","NonLinear","expandedWidth","expandedHeight","CREATIVEVIEW","START","MIDPOINT","FIRSTQUARTILE","THIRDQUARTILE","COMPLETE","MUTE","UNMUTE","PAUSE","REWIND","RESUME","FULLSCREEN","EXPAND","COLLAPSE","ACCEPTINVITATION","CLOSE","DELIVERY","STREAMING","PROGRESSIVE","StaticResource","uRI","creativeType"],"mappings":"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","file":"adsplayer.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.adsplayer = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function (global){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.AdsPlayer = undefined;\n\nvar _AdsPlayer = require('./src/AdsPlayer');\n\nvar _AdsPlayer2 = _interopRequireDefault(_AdsPlayer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Shove both of these into the global scope\nvar context = typeof window !== 'undefined' && window || global;\n\nvar adsplayer = context.adsplayer;\nif (!adsplayer) {\n    adsplayer = context.adsplayer = {};\n}\n\nadsplayer.AdsPlayer = _AdsPlayer2.default;\n\nexports.default = adsplayer;\nexports.AdsPlayer = _AdsPlayer2.default;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{\"./src/AdsPlayer\":2}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* AdsPlayer.\n* @constructor AdsPlayer\n* @param {Object} adsPlayerContainer - the DOM container in which &lt;video&gt; and &lt;img&gt; HTML components will be appended\n*/\n\nvar _AdsPlayerController = require('./AdsPlayerController');\n\nvar _AdsPlayerController2 = _interopRequireDefault(_AdsPlayerController);\n\nvar _EventBus = require('./EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar NAME = 'AdsPlayer';\nvar VERSION = '1.2.0-dev';\nvar GIT_TAG = '5a99c76';\nvar BUILD_DATE = '2017-6-12_9:26:19';\n\n///////////////////////////////////////////////////////////////////////////////////////////////\n////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\nfunction _onError(e) {\n    this._error = e.data;\n}\n\nfunction _onWarning(e) {\n    this._warning = e.data;\n}\n\nvar AdsPlayer = function () {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    function AdsPlayer(adsPlayerContainer) {\n        _classCallCheck(this, AdsPlayer);\n\n        this._adsPlayerContainer = adsPlayerContainer;\n        this._error = null;\n        this._warning = null;\n        this._eventBus = _EventBus2.default.getInstance();\n        this._adsPlayerController = null;\n\n        this.onErrorListener = _onError.bind(this);\n        this.onWarningListener = _onWarning.bind(this);\n    }\n\n    // Plugin API\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * Returns the plugin name.\n    * @method getName\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {string} the plugin name\n    */\n\n\n    _createClass(AdsPlayer, [{\n        key: 'getName',\n        value: function getName() {\n            return NAME;\n        }\n\n        /**\n        * [Plugin API, invoked by hasplayer.js]\n        * Initializes the plugin.\n        * @method init\n        * @access public\n        * @memberof AdsPlayer#\n        * @param {Object} player - the MediaPlayer\n        * @param {function} callback - the callback function to invoke when initialization is done\n        */\n\n    }, {\n        key: 'init',\n        value: function init(player, callback) {\n            this._adsPlayerController = new _AdsPlayerController2.default();\n            this._adsPlayerController.init(player, this._adsPlayerContainer);\n            this._eventBus.addEventListener('error', this.onErrorListener);\n            this._eventBus.addEventListener('warning', this.onWarningListener);\n\n            callback();\n        }\n\n        /**\n        * [Plugin API, invoked by hasplayer.js]\n        * This method is invoked when a new stream is to be loaded/opened.\n        * @method load\n        * @access public\n        * @memberof AdsPlayer#\n        * @param {object} stream - the stream contaning all stream informations (url, protData, adsUrl)\n        */\n\n    }, {\n        key: 'load',\n        value: function load(stream, callback) {\n            if (stream.adsUrl) {\n                this._adsPlayerController.load(stream.adsUrl).then(function () {\n                    callback();\n                }).catch(function () {\n                    callback();\n                });\n            } else {\n                callback();\n            }\n        }\n\n        /**\n        * [Plugin API, invoked by hasplayer.js]\n        * This method is invoked when the current stream is to be stopped.\n        * @method stop\n        * @access public\n        * @memberof AdsPlayer#\n        */\n\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._adsPlayerController.stop();\n        }\n\n        /**\n        * [Plugin API, invoked by hasplayer.js]\n        * This method is invoked when the player is to be reset.\n        * @method reset\n        * @access public\n        * @memberof AdsPlayer#\n        */\n\n    }, {\n        key: 'reset',\n        value: function reset() {\n            this._adsPlayerController.reset();\n        }\n\n        /**\n        * [Plugin API, invoked by hasplayer.js]\n        * This method is invoked when this plugin is being removed/destroyed.\n        * @method destroy\n        * @access public\n        * @memberof AdsPlayer#\n        */\n\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n            this._adsPlayerController.destroy();\n            this._eventBus.removeEventListener('error', this.onErrorListener);\n            this._eventBus.removeEventListener('warning', this.onWarningListener);\n        }\n\n        // AdsPlayer additionnal API\n\n        /**\n        * Returns the plugin version.\n        * @method getVersion\n        * @access public\n        * @memberof AdsPlayer#\n        * @return {string} the plugin version\n        */\n\n    }, {\n        key: 'getVersion',\n        value: function getVersion() {\n            return VERSION;\n        }\n\n        /**\n        * Returns the full plugin version, including git revision\n        * @access public\n        * @memberof AdsPlayer#\n        * @return {string} the full plugin version, including git revision\n        */\n\n    }, {\n        key: 'getVersionFull',\n        value: function getVersionFull() {\n            if (GIT_TAG.indexOf(\"@@\") === -1) {\n                return VERSION + '_' + GIT_TAG;\n            } else {\n                return VERSION;\n            }\n        }\n\n        /**\n        * Returns the build date.\n        * @method getBuildDate\n        * @access public\n        * @memberof AdsPlayer#\n        * @return {string} the build date\n        */\n\n    }, {\n        key: 'getBuildDate',\n        value: function getBuildDate() {\n            if (BUILD_DATE.indexOf(\"@@\") === -1) {\n                return BUILD_DATE;\n            } else {\n                return 'Not a builded version';\n            }\n        }\n\n        /**\n        * Plays/resumes the playback of the current ad.\n        * @method play\n        * @access public\n        * @memberof AdsPlayer#\n        */\n\n    }, {\n        key: 'play',\n        value: function play() {\n            this._adsPlayerController.play();\n        }\n\n        /**\n        * Pauses the playback of the current ad.\n        * @method pause\n        * @access public\n        * @memberof AdsPlayer#\n        */\n\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._adsPlayerController.pause();\n        }\n\n        /**\n        * Registers a listener on the specified event.\n        * The possible event types are:\n        * <li>'error' (see [error]{@link AdsPlayer#event:error} event specification)\n        * <li>'warning' (see [warning]{@link AdsPlayer#event:warning} event specification)\n        * <li>'start' (see [start]{@link AdsPlayer#event:start} event specification)\n        * <li>'end' (see [end]{@link AdsPlayer#event:end} event specification)\n        * <li>'click' (see [click]{@link AdsPlayer#event:click} event specification)\n        * @method addEventListener\n        * @access public\n        * @memberof AdsPlayer#\n        * @param {string} type - the event type for listen to\n        * @param {callback} listener - the callback which is called when an event of the specified type occurs\n        * @param {boolean} useCapture - see HTML DOM addEventListener() method specification\n        */\n\n    }, {\n        key: 'addEventListener',\n        value: function addEventListener(type, listener, useCapture) {\n            this._eventBus.addEventListener(type, listener, useCapture);\n        }\n\n        /**\n        * Unregisters the listener previously registered with the addEventListener() method.\n        * @method removeEventListener\n        * @access public\n        * @memberof AdsPlayer#\n        * @see [addEventListener]{@link AdsPlayer#addEventListener}\n        * @param {string} type - the event type on which the listener was registered\n        * @param {callback} listener - the callback which was registered to the event type\n        */\n\n    }, {\n        key: 'removeEventListener',\n        value: function removeEventListener(type, listener) {\n            this._eventBus.removeEventListener(type, listener);\n        }\n\n        /**\n        * Returns the Error object for the most recent error.\n        * @access public\n        * @memberof AdsPlayer#\n        * @return {object} the Error object for the most recent error, or null if there has not been an error\n        */\n\n    }, {\n        key: 'getError',\n        value: function getError() {\n            return this._error;\n        }\n\n        /**\n        * Returns the Warning object for the most recent warning.\n        * @access public\n        * @memberof AdsPlayer#\n        * @return {object} the Warning object for the most recent warning, or null if there has not been a warning\n        */\n\n    }, {\n        key: 'getWarning',\n        value: function getWarning() {\n            return this._warning;\n        }\n    }]);\n\n    return AdsPlayer;\n}();\n\n// /**\n//  * @class\n//  * @classdesc AdsPlayer\n//  */\n// AdsPlayer.prototype = {\n//     constructor: AdsPlayer\n// };\n\n// AdsPlayer.mast = {};\n// AdsPlayer.mast.model = {};\n// AdsPlayer.mast.model.Trigger = {};\n// AdsPlayer.mast.model.Trigger.Condition = {};\n// AdsPlayer.vast = {};\n// AdsPlayer.vast.model = {};\n// AdsPlayer.vast.model.Vast = {};\n// AdsPlayer.media = {};\n// AdsPlayer.utils = {};\n\n\n/////////// EVENTS\n\n/**\n* The 'start' event is fired when the playback of ad(s) is starting.\n* When the 'start' event is fired, the application shall hide the main player component and\n* display the ads player container in which the ad media player component(s) will be created\n* and displayed.\n*\n* @event AdsPlayer#start\n* @param {object} event - the event\n* @param {object} event.type - the event type ('start')\n*/\n\n/**\n* The 'end' event is fired when the playback of ad(s) has ended.\n* When the 'end' event is fired, the application shall display the main player component and\n* hide the ads player container.\n*\n* @event AdsPlayer#end\n* @param {object} event - the event\n* @param {object} event.type - the event type ('end')\n*/\n\n/**\n* The 'addElement' event is fired when a DOM element for playing an ad has been created\n* and will be appended in the ads player container.\n* The element can be either a &lt;video&gt; or an &lt;img&gt; element.\n*\n* @event AdsPlayer#addElement\n* @param {object} event - the event\n* @param {object} event.type - the event type ('addElement')\n* @param {object} event.data - the event data\n* @param {string} event.data.element - the created element\n* @param {string} event.data.type - the type of the element, 'video' for &lt;video&gt; or 'image' for &lt;img&gt;\n*/\n\n/**\n* The 'removeElement' event is fired when the DOM element for playing an ad is being removed\n* from the ads player container and deleted.\n*\n* @event AdsPlayer#removeElement\n* @param {object} event - the event\n* @param {object} event.type - the event type ('removeElement')\n* @param {object} event.data - the event data\n* @param {string} event.data.element - the created element\n* @param {string} event.data.type - the type of the element, 'video' for &lt;video&gt; or 'image' for &lt;img&gt;\n*/\n\n/**\n* The 'play' event is fired when the playback of media ad is starting.\n*\n* @event AdsPlayer#play\n* @param {object} event - the event\n* @param {object} event.type - the event type ('play')\n*/\n\n/**\n* The 'pause' event is fired when the playback of an ad is paused.\n*\n* @event AdsPlayer#pause\n* @param {object} event - the event\n* @param {object} event.type - the event type ('pause')\n*/\n\n/**\n* The 'click' event is fired when a click has been performed on the ad component.\n* When the 'click' event is fired, the application shall open the web page with the provided URI.\n*\n* @event AdsPlayer#click\n* @param {object} event - the event\n* @param {object} event.type - the event type ('click')\n* @param {object} event.data - the event data\n* @param {string} event.data.uri - the web page uri\n*/\n\n/**\n* The error event is fired when an error occurs.\n* When the error event is fired, the application shall stop the player.\n*\n* @event AdsPlayer#error\n* @param {object} event - the event\n* @param {object} event.type - the event type ('error')\n* @param {object} event.data - the event data\n* @param {string} event.data.code - error code\n* @param {string} event.data.message - error message\n* @param {object} event.data.data - error additionnal data\n*/\n\n/**\n* The warning event is fired when a warning occurs.\n*\n* @event AdsPlayer#warning\n* @param {object} event - the event\n* @param {object} event.type - the event type ('warning')\n* @param {object} event.data - the event data\n* @param {string} event.data.code - warning code\n* @param {string} event.data.message - warning message\n* @param {object} event.data.data - warning additionnal data\n*/\n\nexports.default = AdsPlayer;\n\n},{\"./AdsPlayerController\":3,\"./EventBus\":6}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* AdsPlayerController is th main controller class for AdsPlayer module.\n* It is in charge of downloading the MAST/VAST files and orchestrates the\n* detection of triggers and playing of ad(s).\n*/\n\nvar _Debug = require('./Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _FileLoader = require('./FileLoader');\n\nvar _FileLoader2 = _interopRequireDefault(_FileLoader);\n\nvar _ErrorHandler = require('./ErrorHandler');\n\nvar _ErrorHandler2 = _interopRequireDefault(_ErrorHandler);\n\nvar _EventBus = require('./EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nvar _MastParser = require('./mast/MastParser');\n\nvar _MastParser2 = _interopRequireDefault(_MastParser);\n\nvar _TriggerManager = require('./mast/TriggerManager');\n\nvar _TriggerManager2 = _interopRequireDefault(_TriggerManager);\n\nvar _VastParser = require('./vast/VastParser');\n\nvar _VastParser2 = _interopRequireDefault(_VastParser);\n\nvar _VastPlayerManager = require('./vast/VastPlayerManager');\n\nvar _VastPlayerManager2 = _interopRequireDefault(_VastPlayerManager);\n\nvar _utils = require('./utils/utils');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar AdsPlayerController = function () {\n    _createClass(AdsPlayerController, [{\n        key: '_loadVast',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _loadVast(url) {\n            var _this = this;\n\n            var fileLoader = new _FileLoader2.default(),\n                vast = null;\n\n            return new Promise(function (resolve /*, reject*/) {\n                _this._debug.log(\"Download VAST file: \" + url);\n                fileLoader.load(url).then(function (result) {\n                    _this._debug.log(\"Parse VAST file\");\n                    vast = _this._vastParser.parse(result.response);\n                    vast.baseUrl = result.baseUrl;\n                    resolve(vast);\n                }).catch(function (error) {\n                    if (error) {\n                        _this._errorHandler.sendWarning(_ErrorHandler2.default.LOAD_VAST_FAILED, \"Failed to load VAST file\", error);\n                    }\n                    resolve(null);\n                });\n                _this._fileLoaders.push(fileLoader);\n            });\n        }\n    }, {\n        key: '_loadTriggerVasts',\n        value: function _loadTriggerVasts(trigger) {\n            var loadVastPromises = [],\n                i,\n                uri;\n\n            for (i = 0; i < trigger.sources.length; i++) {\n                uri = trigger.sources[i].uri;\n                // Check for relative uri path and add base url if needed\n                uri = _utils2.default.isAbsoluteURI(uri) ? uri : this._mast.baseUrl + uri;\n                loadVastPromises.push(this._loadVast(uri));\n            }\n\n            return new Promise(function (resolve, reject) {\n                Promise.all(loadVastPromises).then(function (vasts) {\n                    // Push vast objects in the trigger in the original order\n                    // (this = promises returned objects)\n                    for (var i = 0; i < vasts.length; i++) {\n                        if (vasts[i] && vasts[i].ads && vasts[i].ads.length > 0) {\n                            trigger.vasts.push(vasts[i]);\n                        }\n                    }\n                    resolve();\n                }).catch(function () {\n                    reject();\n                });\n            });\n        }\n    }, {\n        key: '_parseMastFile',\n        value: function _parseMastFile(mastContent, mastBaseUrl) {\n            var triggerManager, i;\n\n            // Parse the MAST file\n            this._mast = this._mastParser.parse(mastContent);\n\n            if (!this._mast) {\n                return;\n            }\n\n            // Store base URL for subsequent VATS files download\n            this._mast.baseUrl = mastBaseUrl;\n\n            // Initialize the trigger managers\n            for (i = 0; i < this._mast.triggers.length; i++) {\n                triggerManager = new _TriggerManager2.default();\n                triggerManager.init(this._mast.triggers[i]);\n                this._triggerManagers.push(triggerManager);\n            }\n        }\n    }, {\n        key: '_onVideoPlaying',\n        value: function _onVideoPlaying() {\n            if (this._vastPlayerManager) {\n                this._debug.log(\"Pause main video\");\n                this._mainVideo.pause();\n            }\n        }\n    }, {\n        key: '_onVideoTimeupdate',\n        value: function _onVideoTimeupdate() {\n            // Check for mid-roll triggers\n            var trigger = this._checkTriggersStart();\n            if (trigger !== null) {\n                this._activateTrigger(trigger, true);\n            }\n        }\n    }, {\n        key: '_onVideoEnded',\n        value: function _onVideoEnded() {\n            // Check for end-roll triggers\n            var trigger = this._checkTriggersStart();\n            if (trigger !== null) {\n                this._activateTrigger(trigger, true);\n            }\n\n            this._checkTriggersEnd();\n        }\n    }, {\n        key: '_pauseVideo',\n        value: function _pauseVideo() {\n            if (!this._mainVideo.paused) {\n                this._debug.log(\"Pause main video\");\n                this._mainVideo.pause();\n            }\n        }\n    }, {\n        key: '_resumeVideo',\n        value: function _resumeVideo() {\n            if (this._mainVideo.paused) {\n                this._debug.log(\"Resume main video\");\n                this._mainVideo.play();\n            }\n        }\n    }, {\n        key: '_onTriggerEnd',\n        value: function _onTriggerEnd() {\n            this._debug.log('End playing trigger');\n\n            // Delete VAST player manager\n            if (this._vastPlayerManager) {\n                this._vastPlayerManager = null;\n            }\n\n            // Check if another trigger has to be activated\n            var trigger = this._checkTriggersStart();\n            if (trigger !== null) {\n                this._activateTrigger(trigger, false);\n            } else {\n                // Notifies the application ad(s) playback has ended\n                this._eventBus.dispatchEvent({ type: 'end', data: null });\n\n                if (!this._mainVideo.ended) {\n                    // Resume the main video element\n                    this._resumeVideo();\n                }\n            }\n        }\n    }, {\n        key: '_playTrigger',\n        value: function _playTrigger(trigger) {\n            if (trigger.vasts.length === 0) {\n                return;\n            }\n\n            // Pause the main video element\n            this._pauseVideo();\n\n            // Play the trigger\n            this._debug.log('Start playing trigger ' + trigger.id);\n            this._vastPlayerManager = new _VastPlayerManager2.default();\n            this._vastPlayerManager.init(trigger.vasts, this._adsPlayerContainer, this._mainVideo);\n            this._vastPlayerManager.start();\n        }\n    }, {\n        key: '_activateTrigger',\n        value: function _activateTrigger(trigger, firstTrigger) {\n            var _this2 = this;\n\n            // Check if a trigger is not already activated\n            if (this._vastPlayerManager) {\n                return;\n            }\n\n            if (firstTrigger) {\n                // Notifies the application ad(s) playback starts\n                this._eventBus.dispatchEvent({ type: 'start', data: null });\n            }\n\n            this._debug.log('Activate trigger ' + trigger.id);\n\n            trigger.activated = true;\n\n            if (trigger.vasts.length === 0) {\n                // Download VAST files\n                this._loadTriggerVasts(trigger).then(function () {\n                    _this2._playTrigger(trigger);\n                });\n            } else {\n                this._playTrigger(trigger);\n            }\n        }\n    }, {\n        key: '_checkTriggersStart',\n        value: function _checkTriggersStart() {\n            for (var i = 0; i < this._triggerManagers.length; i++) {\n                if (this._triggerManagers[i].checkStartConditions(this._mainVideo)) {\n                    return this._triggerManagers[i].getTrigger();\n                }\n            }\n            return null;\n        }\n    }, {\n        key: '_checkTriggersEnd',\n        value: function _checkTriggersEnd() {\n            for (var i = 0; i < this._triggerManagers.length; i++) {\n                if (this._triggerManagers[i].checkEndConditions(this._mainVideo)) {\n                    // Remove trigger manager => will not be activated anymore\n                    this._triggerManagers.splice(0, 1);\n                    i--;\n                }\n            }\n        }\n    }, {\n        key: '_start',\n        value: function _start() {\n            if (!this._mast) {\n                return;\n            }\n\n            if (this._mast.triggers.length === 0) {\n                this._debug.warn('No trigger in MAST');\n            }\n\n            // Check for pre-roll trigger\n            var trigger = this._checkTriggersStart();\n            if (trigger !== null) {\n                this._activateTrigger(trigger, true);\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function AdsPlayerController() {\n        _classCallCheck(this, AdsPlayerController);\n\n        this._mainPlayer = null;\n        this._mainVideo = null;\n        this._adsPlayerContainer = null;\n        this._mast = null;\n        this._fileLoaders = [];\n        this._triggerManagers = [];\n        this._vastPlayerManager = null;\n        this._mastParser = new _MastParser2.default();\n        this._vastParser = new _VastParser2.default();\n        this._errorHandler = _ErrorHandler2.default.getInstance();\n        this._debug = _Debug2.default.getInstance();\n        this._eventBus = _EventBus2.default.getInstance();\n\n        this._onVideoPlayingListener = this._onVideoPlaying.bind(this);\n        this._onVideoTimeupdateListener = this._onVideoTimeupdate.bind(this);\n        this._onVideoEndedListener = this._onVideoEnded.bind(this);\n        this._onTriggerEndListener = this._onTriggerEnd.bind(this);\n    }\n\n    /**\n     * Initialize the Ads Player Controller.\n     * @method init\n     * @access public\n     * @memberof AdsPlayerController#\n     * @param {Object} mainVideo - the HTML5 video element used by the main media player\n     * @param {Object} adsPlayerContainer - The container to create the HTML5 video/image elements used to play and render the ads media\n     */\n\n\n    _createClass(AdsPlayerController, [{\n        key: 'init',\n        value: function init(player, adsPlayerContainer) {\n            this._mainPlayer = player;\n            this._mainVideo = player.getVideoModel().getElement();\n            this._adsPlayerContainer = adsPlayerContainer;\n\n            // Add <video> event listener\n            this._mainVideo.addEventListener('playing', this._onVideoPlayingListener);\n            this._mainVideo.addEventListener('timeupdate', this._onVideoTimeupdateListener);\n            this._mainVideo.addEventListener('seeking', this._onVideoTimeupdateListener);\n            this._mainVideo.addEventListener('ended', this._onVideoEndedListener);\n\n            // Add trigger end event listener\n            this._eventBus.addEventListener('triggerEnd', this._onTriggerEndListener);\n\n            this._debug.setLevel(4);\n        }\n\n        /**\n         * Load/open a MAST file.\n         * @method load\n         * @access public\n         * @memberof AdsPlayerController#\n         * @param {string} mastUrl - the MAST file url\n         */\n\n    }, {\n        key: 'load',\n        value: function load(url) {\n            var _this3 = this;\n\n            var fileLoader = new _FileLoader2.default();\n\n            // Reset the MAST and trigger managers\n            this._mast = null;\n            this._triggerManagers = [];\n\n            // Download and parse MAST file\n            this._debug.log(\"Download MAST file: \" + url);\n\n            return new Promise(function (resolve, reject) {\n                fileLoader.load(url).then(function (result) {\n                    _this3._debug.log(\"Parse MAST file\");\n                    _this3._parseMastFile(result.response, result.baseUrl);\n                    // Start managing triggers and ads playing\n                    _this3._debug.log(\"Start\");\n                    _this3._start();\n                    resolve();\n                }).catch(function (error) {\n                    if (error) {\n                        _this3._errorHandler.sendError(error.name, error.message, error.data);\n                        reject(error);\n                    } else {\n                        resolve();\n                    }\n                });\n                _this3._fileLoaders.push(fileLoader);\n            });\n        }\n\n        /**\n         * Stops and resets the Ads player.\n         * @method reset\n         * @access public\n         * @memberof AdsPlayerController#\n         */\n\n    }, {\n        key: 'stop',\n        value: function stop() {\n\n            this._debug.log(\"Stop\");\n\n            // Stop/abort the file loaders\n            for (var i = 0; i < this._fileLoaders.length; i++) {\n                this._fileLoaders[i].abort();\n            }\n            this._fileLoaders = [];\n\n            // Stop the VAST player manager\n            if (this._vastPlayerManager) {\n                this._vastPlayerManager.stop();\n                this._vastPlayerManager = null;\n\n                // Notifies the application ad(s) playback has ended\n                this._eventBus.dispatchEvent({ type: 'end', data: null });\n            }\n        }\n    }, {\n        key: 'reset',\n        value: function reset() {\n\n            this._debug.log(\"Reset\");\n\n            this.stop();\n\n            // Reset the trigger managers\n            this._triggerManagers = [];\n\n            // Reset the MAST\n            this._mast = null;\n        }\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n\n            this._debug.log(\"Destroy\");\n\n            this.reset();\n\n            // Remove <video> event listener\n            this._mainVideo.removeEventListener('playing', this._onVideoPlayingListener);\n            this._mainVideo.removeEventListener('timeupdate', this._onVideoTimeupdateListener);\n            this._mainVideo.removeEventListener('seeking', this._onVideoTimeupdateListener);\n            this._mainVideo.removeEventListener('ended', this._onVideoEndedListener);\n\n            // Remove trigger end event listener\n            this._eventBus.removeEventListener('triggerEnd', this._onTriggerEndListener);\n        }\n\n        /**\n         * Plays/resumes the playback of the current ad.\n         * @method reset\n         * @access public\n         * @memberof AdsPlayerController#\n         */\n\n    }, {\n        key: 'play',\n        value: function play() {\n\n            this._debug.log(\"Play\");\n            // Start the VAST player manager\n            if (this._vastPlayerManager) {\n                this._vastPlayerManager.play();\n            }\n        }\n\n        /**\n         * Pauses the playback of the current ad.\n         * @method reset\n         * @access public\n         * @memberof AdsPlayerController#\n         */\n\n    }, {\n        key: 'pause',\n        value: function pause() {\n\n            this._debug.log(\"Pause\");\n            // Pause the VAST player manager\n            if (this._vastPlayerManager) {\n                this._vastPlayerManager.pause();\n            }\n        }\n    }]);\n\n    return AdsPlayerController;\n}();\n\nexports.default = AdsPlayerController;\n\n},{\"./Debug\":4,\"./ErrorHandler\":5,\"./EventBus\":6,\"./FileLoader\":7,\"./mast/MastParser\":8,\"./mast/TriggerManager\":9,\"./utils/utils\":13,\"./vast/VastParser\":18,\"./vast/VastPlayerManager\":19}],4:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* Debug utility class.\n*/\nDate.prototype.HHMMSSmmm = function () {\n\n    var h = this.getHours().toString(),\n        m = this.getMinutes().toString(),\n        s = this.getSeconds().toString(),\n        ms = this.getMilliseconds().toString(),\n        HH = h[1] ? h : \"0\" + h[0],\n        MM = m[1] ? m : \"0\" + m[0],\n        SS = s[1] ? s : \"0\" + s[0],\n        mmm = ms[2] ? ms : \"0\" + (ms[1] ? ms : \"0\" + ms[0]);\n\n    return HH + \":\" + MM + \":\" + SS + \".\" + mmm;\n};\n\nDate.prototype.MMSSmmm = function () {\n\n    var m = this.getMinutes().toString(),\n        s = this.getSeconds().toString(),\n        ms = this.getMilliseconds().toString(),\n        MM = m[1] ? m : \"0\" + m[0],\n        SS = s[1] ? s : \"0\" + s[0],\n        mmm = ms[2] ? ms : \"0\" + (ms[1] ? ms : \"0\" + ms[0]);\n\n    return MM + \":\" + SS + \".\" + mmm;\n};\n\n// MemoryLogger definition\n\nvar MemoryLogger = function MemoryLogger() {\n    // array to store logs\n    this.logArray = [];\n    // boolean to set leve in message\n    this.showLevel = true;\n};\n\nMemoryLogger.prototype.error = MemoryLogger.prototype.warn = MemoryLogger.prototype.info = MemoryLogger.prototype.debug = function (message) {\n    this.logArray.push(message);\n};\n\nMemoryLogger.prototype.getLogs = function () {\n    return this.logArray;\n};\n\nvar NONE = 0;\nvar ERROR = 1;\nvar WARN = 2;\nvar INFO = 3;\nvar DEBUG = 4;\nvar ALL = 4;\n\nvar _instance = null;\n\nvar Debug = function () {\n    _createClass(Debug, [{\n        key: \"_getStringLevel\",\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _getStringLevel(level) {\n            switch (level) {\n                case NONE:\n                    return \"\";\n                case ERROR:\n                    return \"ERROR\";\n                case WARN:\n                    return \"WARN\";\n                case INFO:\n                    return \"INFO\";\n                case DEBUG:\n                case ALL:\n                    return \"DEBUG\";\n                default:\n                    return \"\";\n            }\n        }\n    }, {\n        key: \"_prepareLog\",\n        value: function _prepareLog(logLevel, args) {\n            var message = \"\",\n                logTime = null;\n\n            if (this._showTimestamp) {\n                logTime = new Date();\n                message += \"[\" + logTime.HHMMSSmmm() + \"]\";\n            }\n\n            if (this._logger && this._logger.showLevel) {\n                message += \"[\" + this._getStringLevel(logLevel) + \"]\";\n            }\n\n            if (this._showElapsedTime) {\n                message += \"[\" + new Date(logTime - this._startTime).MMSSmmm() + \"]\";\n            }\n\n            message += \"[AdsPlayer] \";\n\n            Array.apply(null, args).forEach(function (item) {\n                message += item + \" \";\n            });\n\n            return message;\n        }\n    }, {\n        key: \"_log\",\n        value: function _log(logLevel, args) {\n            if (logLevel <= this.getLevel()) {\n\n                var message = this._prepareLog(logLevel, args);\n\n                switch (logLevel) {\n                    case ERROR:\n                        this._logger.error(message);\n                        break;\n                    case WARN:\n                        this._logger.warn(message);\n                        break;\n                    case INFO:\n                        this._logger.info(message);\n                        break;\n                    case DEBUG:\n                        this._logger.debug(message);\n                        break;\n                }\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }], [{\n        key: \"getInstance\",\n        value: function getInstance() {\n            if (_instance === null) {\n                _instance = new Debug();\n            }\n\n            return _instance;\n        }\n    }]);\n\n    function Debug() {\n        _classCallCheck(this, Debug);\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._level = 4;\n        this._showTimestamp = true;\n        this._showElapsedTime = false;\n        this._startTime = new Date();\n        this._logger = console;\n\n        _instance = this;\n        return _instance;\n    }\n\n    _createClass(Debug, [{\n        key: \"getLevel\",\n        value: function getLevel() {\n            return this._level;\n        }\n    }, {\n        key: \"setLevel\",\n        value: function setLevel(value) {\n            this._level = value;\n        }\n    }, {\n        key: \"getLogger\",\n        value: function getLogger() {\n            return this._logger;\n        }\n    }, {\n        key: \"setLogger\",\n        value: function setLogger(type) {\n            switch (type) {\n                case 'memory':\n                    this._logger = new MemoryLogger();\n                    break;\n\n                case 'console':\n                    this._logger = console;\n                    break;\n\n                default:\n                    this._logger = null;\n            }\n        }\n    }, {\n        key: \"error\",\n        value: function error() {\n            this._log(ERROR, arguments);\n        }\n    }, {\n        key: \"warn\",\n        value: function warn() {\n            this._log(WARN, arguments);\n        }\n    }, {\n        key: \"info\",\n        value: function info() {\n            this._log(INFO, arguments);\n        }\n\n        // Keep this function for compatibility\n\n    }, {\n        key: \"log\",\n        value: function log() {\n            this._log(DEBUG, arguments);\n        }\n    }]);\n\n    return Debug;\n}();\n\nexports.default = Debug;\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* Errors and warning notifications handler.\n*/\n\nvar _Debug = require('./Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _EventBus = require('./EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _instance = null;\n\nvar ErrorHandler = function () {\n    _createClass(ErrorHandler, null, [{\n        key: 'getInstance',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n        value: function getInstance() {\n            if (_instance === null) {\n                _instance = new ErrorHandler();\n            }\n\n            return _instance;\n        }\n    }]);\n\n    function ErrorHandler() {\n        _classCallCheck(this, ErrorHandler);\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._eventBus = _EventBus2.default.getInstance();\n        this._debug = _Debug2.default.getInstance();\n\n        _instance = this;\n        return _instance;\n    }\n\n    /**\n     * [sendWarning description]\n     * @param  {[type]} code    [description]\n     * @param  {[type]} message [description]\n     * @param  {[type]} data    [description]\n     * @return {[type]}         [description]\n     */\n\n\n    _createClass(ErrorHandler, [{\n        key: 'sendWarning',\n        value: function sendWarning(code, message, data) {\n            this._eventBus.dispatchEvent({\n                type: 'warning',\n                data: {\n                    code: code,\n                    message: message,\n                    data: data\n                }\n            });\n            this._debug.warn(\"[Warn] Code: \" + code + \", Message: \" + message + \", Data: \" + JSON.stringify(data, null, '\\t'));\n        }\n\n        /**\n         * [sendError description]\n         * @param  {[type]} code    [description]\n         * @param  {[type]} message [description]\n         * @param  {[type]} data    [description]\n         * @return {[type]}         [description]\n         */\n\n    }, {\n        key: 'sendError',\n        value: function sendError(code, message, data) {\n            this._eventBus.dispatchEvent({\n                type: 'error',\n                data: {\n                    code: code,\n                    message: message,\n                    data: data\n                }\n            });\n            this._debug.error(\"[Error] Code: \" + code + \", Message: \" + message + \", Data: \" + JSON.stringify(data, null, '\\t'));\n        }\n    }]);\n\n    return ErrorHandler;\n}();\n\n// File Loader errors\n\n\nErrorHandler.DOWNLOAD_ERR_FILES = \"DOWNLOAD_ERR_FILES\";\nErrorHandler.DOWNLOAD_ERR_NOT_XML = \"DOWNLOAD_ERR_NOT_XML\";\n\nErrorHandler.LOAD_VAST_FAILED = \"LOAD_VAST_FAILED\";\n\n// Media Player errors\nErrorHandler.NO_VALID_MEDIA_FOUND = \"NO_VALID_MEDIA_FOUND\";\nErrorHandler.LOAD_MEDIA_FAILED = \"LOAD_MEDIA_FAILED\";\nErrorHandler.UNSUPPORTED_MEDIA_FILE = \"UNSUPPORTED_MEDIA_FILE\";\nErrorHandler.UNAVAILABLE_LINK = \"UNAVAILABLE_LINK\";\n\nexports.default = ErrorHandler;\n\n},{\"./Debug\":4,\"./EventBus\":6}],6:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* Event bus utility class for events listening and notifying.\n*/\n\nvar _Debug = require('./Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _instance = null;\n\nvar EventBus = function () {\n    _createClass(EventBus, [{\n        key: '_getListeners',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n\n        value: function _getListeners(type, useCapture) {\n            if (useCapture === undefined) {\n                // to provide a default parameter that works !!\n                useCapture = false;\n            }\n            var captype = (useCapture ? '1' : '0') + type;\n\n            if (!(captype in this._registrations)) {\n                this._registrations[captype] = [];\n            }\n\n            return this._registrations[captype];\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }], [{\n        key: 'getInstance',\n        value: function getInstance() {\n            if (_instance === null) {\n                _instance = new EventBus();\n            }\n\n            return _instance;\n        }\n    }]);\n\n    function EventBus() {\n        _classCallCheck(this, EventBus);\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._registrations = {};\n        this._debug = _Debug2.default.getInstance();\n\n        _instance = this;\n        return _instance;\n    }\n\n    /**\n     * [addEventListener description]\n     * @param {[type]} type       [description]\n     * @param {[type]} listener   [description]\n     * @param {[type]} useCapture [description]\n     */\n\n\n    _createClass(EventBus, [{\n        key: 'addEventListener',\n        value: function addEventListener(type, listener, useCapture) {\n            var listeners = this._getListeners(type, useCapture),\n                idx = listeners.indexOf(listener);\n\n            if (idx === -1) {\n                listeners.push(listener);\n            }\n        }\n\n        /**\n         * [removeEventListener description]\n         * @param  {[type]} type       [description]\n         * @param  {[type]} listener   [description]\n         * @param  {[type]} useCapture [description]\n         * @return {[type]}            [description]\n         */\n\n    }, {\n        key: 'removeEventListener',\n        value: function removeEventListener(type, listener, useCapture) {\n            var listeners = this._getListeners(type, useCapture),\n                idx = listeners.indexOf(listener);\n\n            if (idx !== -1) {\n                listeners.splice(idx, 1);\n            }\n        }\n\n        /**\n         * [dispatchEvent description]\n         * @param  {[type]} evt [description]\n         * @return {[type]}     [description]\n         */\n\n    }, {\n        key: 'dispatchEvent',\n        value: function dispatchEvent(evt) {\n            var listeners = this._getListeners(evt.type, false).slice(),\n                i = 0;\n\n            for (i = 0; i < listeners.length; i += 1) {\n                listeners[i].call(this, evt);\n            }\n            return !evt.defaultPrevented;\n        }\n    }]);\n\n    return EventBus;\n}();\n\nexports.default = EventBus;\n\n},{\"./Debug\":4}],7:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* File downloader utility class.\n*/\n\nvar _ErrorHandler = require(\"./ErrorHandler\");\n\nvar _ErrorHandler2 = _interopRequireDefault(_ErrorHandler);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FileLoader = function () {\n    _createClass(FileLoader, [{\n        key: \"_parseBaseUrl\",\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _parseBaseUrl(url) {\n            var base = null;\n\n            if (url.indexOf(\"/\") !== -1) {\n                if (url.indexOf(\"?\") !== -1) {\n                    url = url.substring(0, url.indexOf(\"?\"));\n                }\n                base = url.substring(0, url.lastIndexOf(\"/\") + 1);\n            }\n\n            return base;\n        }\n    }, {\n        key: \"_parseXml\",\n        value: function _parseXml(data) {\n\n            if (!window.DOMParser) {\n                return null;\n            }\n\n            try {\n                var parser = new window.DOMParser();\n\n                var xmlDoc = parser.parseFromString(data, \"text/xml\");\n                if (xmlDoc.getElementsByTagName('parsererror').length > 0) {\n                    throw new Error('Error parsing XML');\n                }\n                return xmlDoc;\n            } catch (e) {\n                return null;\n            }\n        }\n    }, {\n        key: \"_abort\",\n        value: function _abort() {\n            if (this._request !== null && this._request.readyState > 0 && this._request.readyState < 4) {\n                this._request.abort();\n            }\n        }\n    }, {\n        key: \"_load\",\n        value: function _load(url, resolve, reject) {\n            var baseUrl = this._parseBaseUrl(url),\n                needFailureReport = true,\n                onload = null,\n                report = null,\n                onabort = null,\n                self = this;\n\n            onabort = function onabort() {\n                this.aborted = true;\n            };\n\n            onload = function onload() {\n                if (this.status < 200 || this.status > 299) {\n                    return;\n                }\n\n                if (this.status === 200 && this.readyState === 4) {\n\n                    // Parse responseText in case of wrong response Content-Type\n                    var xmlDoc = this.responseXML || self._parseXml(this.responseText);\n\n                    // Check if response is in XML format.\n                    if (xmlDoc === null) {\n                        needFailureReport = true;\n                        return;\n                    }\n\n                    // Get the redirection URL and use it as base URL\n                    if (this.responseURL) {\n                        baseUrl = self._parseBaseUrl(this.responseURL);\n                    }\n\n                    needFailureReport = false;\n\n                    // Return XML DOM (as input to parsers)\n                    resolve({\n                        response: xmlDoc,\n                        baseUrl: baseUrl\n                    });\n                }\n            };\n\n            report = function report() {\n                if (!needFailureReport) {\n                    return;\n                }\n                needFailureReport = false;\n\n                if (this.aborted) {\n                    // Request has been aborted => reject without error\n                    reject();\n                } else if (this.status < 200 || this.status > 299) {\n                    // Request has failed => reject with error\n                    reject({\n                        name: _ErrorHandler2.default.DOWNLOAD_ERR_FILES,\n                        message: \"Failed to download file\",\n                        data: {\n                            url: url,\n                            status: this.status\n                        }\n                    });\n                } else if (this.responseXML === null) {\n                    // Response was not in XML format => reject with error\n                    reject({\n                        name: _ErrorHandler2.default.DOWNLOAD_ERR_NOT_XML,\n                        message: \"The downloaded file format is not in xml format\",\n                        data: {\n                            url: url\n                        }\n                    });\n                }\n            };\n\n            try {\n                this._request = new XMLHttpRequest();\n                this._request.onload = onload;\n                this._request.onloadend = report;\n                this._request.onerror = report;\n                this._request.onabort = onabort;\n                this._request.open(\"GET\", url, true);\n                this._request.timeout = 10000;\n                this._request.send();\n            } catch (e) {\n                this._request.onerror();\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function FileLoader() {\n        _classCallCheck(this, FileLoader);\n\n        this._request = null;\n    }\n\n    _createClass(FileLoader, [{\n        key: \"load\",\n        value: function load(url) {\n            var _this = this;\n\n            return new Promise(function (resolve, reject) {\n                _this._load(url, resolve, reject);\n            });\n        }\n    }, {\n        key: \"abort\",\n        value: function abort() {\n            if (this._request !== null && this._request.readyState > 0 && this._request.readyState < 4) {\n                this._request.abort();\n            }\n        }\n    }]);\n\n    return FileLoader;\n}();\n\nexports.default = FileLoader;\n\n},{\"./ErrorHandler\":5}],8:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* MAST parser. This class parses MAST file in XML format\n* and construct the corresponding MAST object according to MAST data model.\n*/\n\nvar _Mast = require('./model/Mast');\n\nvar _Mast2 = _interopRequireDefault(_Mast);\n\nvar _xmldom = require('../utils/xmldom');\n\nvar _xmldom2 = _interopRequireDefault(_xmldom);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar MastParser = function () {\n    _createClass(MastParser, [{\n        key: '_getCondition',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _getCondition(conditionNode) {\n            var condition = new _Mast2.default.Condition(),\n                conditionNodes = void 0;\n\n            condition.type = conditionNode.getAttribute('type');\n            condition.name = conditionNode.getAttribute('name');\n            condition.value = conditionNode.getAttribute('value');\n            condition.operator = conditionNode.getAttribute('operator');\n            conditionNodes = conditionNode.getElementsByTagName('condition');\n            for (var i = 0; i < conditionNodes.length; i++) {\n                condition.conditions.push(this._getCondition(conditionNodes[i]));\n            }\n\n            return condition;\n        }\n    }, {\n        key: '_getSource',\n        value: function _getSource(sourceNode) {\n            var source = new _Mast2.default.Source(),\n                sourceNodes = void 0;\n\n            source.uri = sourceNode.getAttribute('uri');\n            source.altReference = sourceNode.getAttribute('altReference');\n            source.format = sourceNode.getAttribute('format');\n            sourceNodes = sourceNode.getElementsByTagName('source');\n            for (var i = 0; i < sourceNodes.length; i++) {\n                source.sources.push(this._getSource(sourceNodes[i]));\n            }\n\n            return source;\n        }\n    }, {\n        key: '_getTrigger',\n        value: function _getTrigger(triggerNode) {\n            var trigger = new _Mast2.default.Trigger(),\n                startConditionNodes = _xmldom2.default.getSubElements(triggerNode, 'startConditions', 'condition'),\n                endConditionNodes = _xmldom2.default.getSubElements(triggerNode, 'endConditions', 'condition'),\n                sourceNodes = _xmldom2.default.getSubElements(triggerNode, 'sources', 'source'),\n                i = void 0;\n\n            trigger.id = triggerNode.getAttribute('id');\n            trigger.description = triggerNode.getAttribute('description');\n\n            for (i = 0; i < startConditionNodes.length; i++) {\n                trigger.startConditions.push(this._getCondition(startConditionNodes[i]));\n            }\n\n            for (i = 0; i < endConditionNodes.length; i++) {\n                trigger.endConditions.push(this._getCondition(endConditionNodes[i]));\n            }\n\n            for (i = 0; i < sourceNodes.length; i++) {\n                trigger.sources.push(this._getSource(sourceNodes[i]));\n            }\n\n            return trigger;\n        }\n    }, {\n        key: '_getTriggers',\n        value: function _getTriggers(mastNode, mast) {\n            var triggerNodes = _xmldom2.default.getSubElements(mastNode, 'triggers', 'trigger');\n\n            for (var i = 0; i < triggerNodes.length; i++) {\n                mast.triggers.push(this._getTrigger(triggerNodes[i]));\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function MastParser() {\n        _classCallCheck(this, MastParser);\n    }\n\n    /**\n    * Parses the MAST xml file and get the triggers.\n    * @param {object} xmlDom - the XML DOM to parse\n    */\n\n\n    _createClass(MastParser, [{\n        key: 'parse',\n        value: function parse(xmlDom) {\n            var mast_ = new _Mast2.default.Mast(),\n                mastNode = _xmldom2.default.getElement(xmlDom, 'MAST');\n\n            if (mastNode === null) {\n                return mast_;\n            }\n\n            this._getTriggers(mastNode, mast_);\n\n            return mast_;\n        }\n    }]);\n\n    return MastParser;\n}();\n\nexports.default = MastParser;\n\n},{\"../utils/xmldom\":14,\"./model/Mast\":10}],9:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The TriggerManager manages the detection of the start and end of a trigger.\n* It takes as input a trigger object (as parsed from a MAST file) and tests the start and end conditions\n* to detect the activation and revocation of a trigger.\n*/\n\nvar _Mast = require('./model/Mast');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TriggerManager = function () {\n    _createClass(TriggerManager, [{\n        key: '_parseTime',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _parseTime(str) {\n            var timeParts,\n                SECONDS_IN_HOUR = 60 * 60,\n                SECONDS_IN_MIN = 60;\n\n            if (!str) {\n                return -1;\n            }\n\n            timeParts = str.split(':');\n\n            // Check time format, must be HH:MM:SS(.mmm)\n            if (timeParts.length !== 3) {\n                return -1;\n            }\n\n            return parseInt(timeParts[0]) * SECONDS_IN_HOUR + parseInt(timeParts[1]) * SECONDS_IN_MIN + parseFloat(timeParts[2]);\n        }\n    }, {\n        key: '_compareValues',\n        value: function _compareValues(value1, value2, operator) {\n            var res = false;\n\n            if (value1 < 0 || value2 < 0) {\n                return false;\n            }\n\n            switch (operator) {\n                case _Mast.Condition.OPERATOR.EQ:\n                    res = value1 === value2;\n                    break;\n                case _Mast.Condition.OPERATOR.NEQ:\n                    res = value1 !== value2;\n                    break;\n                case _Mast.Condition.OPERATOR.GTR:\n                    res = value1 > value2;\n                    break;\n                case _Mast.Condition.OPERATOR.GEQ:\n                    res = value1 >= value2;\n                    break;\n                case _Mast.Condition.OPERATOR.LT:\n                    res = value1 < value2;\n                    break;\n                case _Mast.Condition.OPERATOR.LEQ:\n                    res = value1 <= value2;\n                    break;\n                case _Mast.Condition.OPERATOR.MOD:\n                    res = value1 % value2 === 0;\n                    break;\n                default:\n                    break;\n            }\n            return res;\n        }\n    }, {\n        key: '_evaluateCondition',\n        value: function _evaluateCondition(condition, video) {\n            var res = false,\n                i;\n\n            // Check pre-roll condition for activation\n            if (video.currentTime === 0 && condition.type === _Mast.Condition.TYPE.EVENT && condition.name === _Mast.Condition.NAME.ON_ITEM_START) {\n                res = true;\n            }\n\n            // Check mid-roll condition for activation\n            if (condition.type === _Mast.Condition.TYPE.PROPERTY) {\n                switch (condition.name) {\n                    case _Mast.Condition.NAME.POSITION:\n                        res = this._compareValues(video.currentTime, this._parseTime(condition.value), condition.operator);\n                        break;\n                    case _Mast.Condition.NAME.DURATION:\n                        res = this._compareValues(video.duration, this._parseTime(condition.value), condition.operator);\n                        break;\n                    default:\n                        break;\n                }\n            }\n\n            // Check condition for revocation\n            if (video.ended && condition.type === _Mast.Condition.TYPE.EVENT && condition.name === _Mast.Condition.NAME.ON_ITEM_END) {\n                res = true;\n            }\n\n            // AND with sub-conditions\n            // MAST spec. : \"Child conditions are treated as an implicit AND, all children of a condition must evaluate true before a trigger will fire (or be revoked) from that condition.\"\n            for (i = 0; i < condition.conditions.length; i++) {\n                res &= this._evaluateCondition(condition.conditions[i], video);\n            }\n\n            return res;\n        }\n    }, {\n        key: '_evaluateConditions',\n        value: function _evaluateConditions(conditions, video) {\n            var res = false,\n                i;\n\n            // Evaluate each condition\n            // MAST spec. : \"Multiple condition elements are treated as an implicit OR, any one of them evaluating true will fire the trigger.\"\n            for (i = 0; i < conditions.length; i++) {\n                res |= this._evaluateCondition(conditions[i], video);\n            }\n\n            return res;\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function TriggerManager() {\n        _classCallCheck(this, TriggerManager);\n\n        this._trigger = null;\n    }\n\n    /**\n     * Initializes the TriggerManager.\n     * @method init\n     * @access public\n     * @memberof TriggerManager#\n     * @param {Object} trigger - the trigger to handle by this manager\n     */\n\n\n    _createClass(TriggerManager, [{\n        key: 'init',\n        value: function init(trigger) {\n            this._trigger = trigger;\n        }\n\n        /**\n         * Returns the trigger object managed by this TriggerManager.\n         * @method init\n         * @access public\n         * @memberof TriggerManager#\n         * @return {Object} the managed trigger object\n         */\n\n    }, {\n        key: 'getTrigger',\n        value: function getTrigger() {\n            return this._trigger;\n        }\n\n        /**\n         * Evaluates the trigger start conditions.\n         * @method checkStartConditions\n         * @access public\n         * @memberof TriggerManager#\n         * @param {Number} video - the main video element\n         */\n\n    }, {\n        key: 'checkStartConditions',\n        value: function checkStartConditions(video) {\n            if (this._trigger.activated) {\n                return false;\n            }\n            return this._evaluateConditions(this._trigger.startConditions, video);\n        }\n\n        /**\n         * Evaluates the trigger end conditions.\n         * @method checkEndConditions\n         * @access public\n         * @memberof TriggerManager#\n         * @param {Number} video - the main video element\n         */\n\n    }, {\n        key: 'checkEndConditions',\n        value: function checkEndConditions(video) {\n            return this._evaluateConditions(this._trigger.endConditions, video);\n        }\n    }]);\n\n    return TriggerManager;\n}();\n\nexports.default = TriggerManager;\n\n},{\"./model/Mast\":10}],10:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* @class Mast\n* @ignore\n*/\nvar Mast = function Mast() {\n    _classCallCheck(this, Mast);\n\n    this.baseUrl = '';\n    this.triggers = []; // pointer to any number of Ad objects\n};\n\n/**\n* @class Trigger\n* @ignore\n*/\n\n\nvar Trigger = function Trigger() {\n    _classCallCheck(this, Trigger);\n\n    this.id = '';\n    this.description = 0;\n    this.startConditions = []; // pointer to a list of start conditions to  : AdsPlayer.mast.model.Trigger.Condition\n    this.endConditions = []; // pointer to a list of end conditions : AdsPlayer.mast.model.Trigger.Condition\n    this.sources = []; // pointer to a list of sources : AdsPlayer.mast.model.Trigger.Source\n    this.alreadyProcessed = false; // mainly in the seeked case : do not replay trigger already played\n    this.vasts = [];\n    this.activated = false;\n};\n\n/**\n* @class Condition\n* @ignore\n*/\n\n\nvar Condition = function Condition() {\n    _classCallCheck(this, Condition);\n\n    this.type = '';\n    this.name = '';\n    this.value = '';\n    this.operator = '';\n    this.conditions = [];\n};\n\n// ConditionType\n\n\nCondition.TYPE = {\n    EVENT: 'event',\n    PROPERTY: 'property'\n\n};\n\n// ConditionName\nCondition.NAME = {\n    ON_ITEM_START: 'OnItemStart',\n    ON_ITEM_END: 'OnItemEnd',\n    POSITION: 'Position',\n    DURATION: 'Duration'\n};\n\n// ConditionOperator\nCondition.OPERATOR = {\n    EQ: 'EQ', // equal\n    NEQ: 'NEQ', // not equal\n    GTR: 'GTR', // greater\n    GEQ: 'GEQ', // greater or equal\n    LT: 'LT', // lower\n    LEQ: 'LEQ', // lower or equal\n    MOD: 'MOD' // modulo\n};\n\n/**\n* @class Source\n* @ignore\n*/\n\nvar Source = function Source() {\n    _classCallCheck(this, Source);\n\n    this.uri = '';\n    this.altReference = '';\n    this.format = '';\n    this.sources = [];\n    // this.targets = [];\n};\n\n// SourceFormat\n\n\nSource.FORMAT = {\n    VAST: 'vast',\n    UIF: 'uif'\n};\n\nvar mast = {};\n\nmast.Mast = Mast;\nmast.Trigger = Trigger;\nmast.Condition = Condition;\nmast.Source = Source;\n\nexports.default = mast;\nexports.Mast = Mast;\nexports.Trigger = Trigger;\nexports.Condition = Condition;\nexports.Source = Source;\n\n},{}],11:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The ImagePlayer is a MediaPlayer implementation for playing still images.\n*/\n\nvar _Debug = require('../Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _utils = require('../utils/utils');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ImagePlayer = function () {\n    _createClass(ImagePlayer, [{\n        key: '_getListeners',\n        value: function _getListeners(type) {\n            if (!(type in this._listeners)) {\n                this._listeners[type] = [];\n            }\n            return this._listeners[type];\n        }\n    }, {\n        key: '_addEventListener',\n        value: function _addEventListener(type, listener) {\n            var listeners = this._getListeners(type),\n                idx = listeners.indexOf(listener);\n\n            if (idx === -1) {\n                listeners.push(listener);\n            }\n        }\n    }, {\n        key: '_removeEventListener',\n        value: function _removeEventListener(type, listener) {\n            var listeners = this._getListeners(type),\n                idx = listeners.indexOf(listener);\n\n            if (idx !== -1) {\n                listeners.splice(idx, 1);\n            }\n        }\n    }, {\n        key: '_notifyEvent',\n        value: function _notifyEvent(type) {\n            var listeners = this._getListeners(type),\n                i = 0;\n\n            for (i = 0; i < listeners.length; i++) {\n                listeners[i].call(this);\n            }\n        }\n    }, {\n        key: '_updateCurrentTime',\n        value: function _updateCurrentTime() {\n            var time = new Date().getTime();\n\n            this._currentTime += (time - this._timerTime) / 1000;\n            //this._debug.log(\"Image timeupdate, time = \" + this._currentTime);\n            this._notifyEvent('timeupdate');\n\n            if (this._currentTime >= this._duration) {\n                this._stopTimer();\n                this._ended = true;\n                this._notifyEvent('ended');\n            }\n\n            this._timerTime = time;\n        }\n    }, {\n        key: '_startTimer',\n        value: function _startTimer() {\n            if (this._timerInterval !== null) {\n                return;\n            }\n            this._notifyEvent('play');\n            this._timerTime = new Date().getTime();\n            this._timerInterval = setInterval(this._updateCurrentTime.bind(this), 200);\n        }\n    }, {\n        key: '_stopTimer',\n        value: function _stopTimer() {\n            if (this._timerInterval === null) {\n                return;\n            }\n            this._notifyEvent('pause');\n            clearInterval(this._timerInterval);\n            this._timerInterval = null;\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function ImagePlayer() {\n        _classCallCheck(this, ImagePlayer);\n\n        this._uri = '';\n        this._image = null;\n        this._duration = 0;\n        this._currentTime = 0;\n        this._ended = false;\n        this._listeners = {};\n        this._timerInterval = null;\n        this._timerTime = -1;\n        this._events = ['play', 'pause', 'timeupdate', 'ended'];\n        this._debug = _Debug2.default.getInstance();\n    }\n\n    _createClass(ImagePlayer, [{\n        key: 'load',\n        value: function load(baseUrl, mediaFiles) {\n\n            var mediaFile = null,\n                type,\n                i;\n\n            // Load the first supported image format\n            // Support only jpeg, png and gif image formats\n            for (i = 0; i < mediaFiles.length; i++) {\n                type = mediaFiles[i].type;\n                if (type === \"image/jpeg\" || type === \"image/jpg\" || type === \"image/png\" || type === \"image/gif\") {\n                    mediaFile = mediaFiles[i];\n                    break;\n                }\n            }\n\n            if (mediaFile === null) {\n                return false;\n            }\n\n            // Get adsplayer-image element if already declared in DOM\n            this._image = document.getElementById('adsplayer-image');\n\n            if (!this._image) {\n                // Create the image element\n                this._image = document.createElement('img');\n                this._image.autoplay = false;\n                this._image.id = 'adsplayer-image';\n            }\n\n            // Add base URL\n            this._uri = mediaFile.uri;\n            this._uri = _utils2.default.isAbsoluteURI(this._uri) ? this._uri : baseUrl + this._uri;\n\n            this._debug.log(\"Load image media, uri = \" + this._uri);\n            this._image.src = this._uri;\n\n            // Reset current time\n            this._currentTime = 0;\n            this._ended = false;\n\n            return true;\n        }\n    }, {\n        key: 'getType',\n        value: function getType() {\n            return \"image\";\n        }\n    }, {\n        key: 'getElement',\n        value: function getElement() {\n            return this._image;\n        }\n    }, {\n        key: 'addEventListener',\n        value: function addEventListener(type, listener) {\n            if (!this._image) {\n                return;\n            }\n            if (this._events.indexOf(type) !== -1) {\n                this._addEventListener(type, listener);\n            } else {\n                this._image.addEventListener(type, listener);\n            }\n        }\n    }, {\n        key: 'removeEventListener',\n        value: function removeEventListener(type, listener) {\n            if (!this._image) {\n                return;\n            }\n            if (this._events.indexOf(type) !== -1) {\n                this._removeEventListener(type, listener);\n            } else {\n                this._image.removeEventListener(type, listener);\n            }\n        }\n    }, {\n        key: 'setDuration',\n        value: function setDuration(duration) {\n            this._duration = duration;\n        }\n    }, {\n        key: 'getDuration',\n        value: function getDuration() {\n            return this._duration;\n        }\n    }, {\n        key: 'getCurrentTime',\n        value: function getCurrentTime() {\n            return this._currentTime;\n        }\n    }, {\n        key: 'setVolume',\n        value: function setVolume() /*volume*/{\n            // NA\n        }\n    }, {\n        key: 'getVolume',\n        value: function getVolume() {\n            return 0;\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            if (!this._image) {\n                return;\n            }\n            this._startTimer();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            if (!this._image) {\n                return;\n            }\n            this._stopTimer();\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            if (!this._image) {\n                return;\n            }\n            this._stopTimer();\n        }\n    }, {\n        key: 'reset',\n        value: function reset() {\n            if (!this._image) {\n                return;\n            }\n            this._image = null;\n            this._listeners = {};\n        }\n    }, {\n        key: 'isEnded',\n        value: function isEnded() {\n            return this._ended;\n        }\n    }]);\n\n    return ImagePlayer;\n}();\n\nexports.default = ImagePlayer;\n\n},{\"../Debug\":4,\"../utils/utils\":13}],12:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The VideoPlayer is a MediaPlayer implementation for playing video files.\n*/\n\nvar _Debug = require('../Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _utils = require('../utils/utils');\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar VideoPlayer = function () {\n    _createClass(VideoPlayer, [{\n        key: 'isMediaSupported',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function isMediaSupported(mimeType) {\n            if (!this._video) {\n                throw \"isMediaSupported(): element not created\";\n            }\n            if (!(this._video instanceof HTMLMediaElement)) {\n                throw \"isMediaSupported(): element must be of type HTMLMediaElement\";\n            }\n\n            var canPlay = this._video.canPlayType(mimeType);\n            return canPlay === \"probably\" || canPlay === \"maybe\";\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function VideoPlayer() {\n        _classCallCheck(this, VideoPlayer);\n\n        this._uri = '';\n        this._video = null;\n        this._debug = _Debug2.default.getInstance();\n    }\n\n    _createClass(VideoPlayer, [{\n        key: 'load',\n        value: function load(baseUrl, mediaFiles) {\n\n            // Get 'adsplayer-video' element if already declared in DOM\n            this._video = document.getElementById('adsplayer-video');\n\n            if (!this._video) {\n                // Create the video element\n                this._video = document.createElement('video');\n                this._video.autoplay = false;\n                this._video.id = 'adsplayer-video';\n            }\n\n            // Check if input format is supported\n            if (!this.isMediaSupported(mediaFiles[0].type)) {\n                return false;\n            }\n\n            // Sort the mediafiles in bitrate ascending order\n            mediaFiles.sort(function (a, b) {\n                if (a.bitrate && b.bitrate) {\n                    return a.bitrate - b.bitrate;\n                }\n                return -1;\n            });\n\n            // Play the media file with lowest bitrate\n            this._uri = mediaFiles[0].uri;\n\n            // Add base URL\n            this._uri = _utils2.default.isAbsoluteURI(this._uri) ? this._uri : baseUrl + this._uri;\n\n            this._debug.log(\"Load video media, uri = \" + this._uri);\n\n            this._video.addEventListener('error', function (e) {\n                console.log(e);\n            });\n\n            this._video.src = this._uri;\n\n            return true;\n        }\n    }, {\n        key: 'getType',\n        value: function getType() {\n            return \"video\";\n        }\n    }, {\n        key: 'getElement',\n        value: function getElement() {\n            return this._video;\n        }\n    }, {\n        key: 'addEventListener',\n        value: function addEventListener(type, listener) {\n            if (!this._video) {\n                return;\n            }\n            this._video.addEventListener(type, listener);\n        }\n    }, {\n        key: 'removeEventListener',\n        value: function removeEventListener(type, listener) {\n            if (!this._video) {\n                return;\n            }\n            this._video.removeEventListener(type, listener);\n        }\n    }, {\n        key: 'setDuration',\n        value: function setDuration() /*duration*/{\n            // duration is handled by the video element\n        }\n    }, {\n        key: 'getDuration',\n        value: function getDuration() {\n            if (!this._video) {\n                return 0;\n            }\n            return this._video.duration;\n        }\n    }, {\n        key: 'getCurrentTime',\n        value: function getCurrentTime() {\n            if (!this._video) {\n                return 0;\n            }\n            return this._video.currentTime;\n        }\n    }, {\n        key: 'getVolume',\n        value: function getVolume() {\n            if (!this._video) {\n                return 0;\n            }\n            return this._video.muted ? 0 : this._video.volume;\n        }\n    }, {\n        key: 'setVolume',\n        value: function setVolume(volume) {\n            if (!this._video) {\n                return;\n            }\n            this._video.volume = volume;\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            if (!this._video) {\n                return;\n            }\n            this._video.play();\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            if (!this._video) {\n                return;\n            }\n            this._video.pause();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            if (!this._video) {\n                return;\n            }\n            this._video.pause();\n        }\n    }, {\n        key: 'reset',\n        value: function reset() {\n            if (!this._video) {\n                return;\n            }\n            this._video = null;\n        }\n    }, {\n        key: 'isEnded',\n        value: function isEnded() {\n            return this._video.ended;\n        }\n    }]);\n\n    return VideoPlayer;\n}();\n\nexports.default = VideoPlayer;\n\n},{\"../Debug\":4,\"../utils/utils\":13}],13:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nvar utils = {};\n\nutils.isAbsoluteURI = function (uri) {\n    return uri.toLowerCase().indexOf('http://') >= 0 || uri.toLowerCase().indexOf('https://') >= 0;\n};\n\nexports.default = utils;\n\n},{}],14:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nvar xmldom = {};\n\nxmldom.getElementsByTagName = function (node, name) {\n    var elements = node.getElementsByTagName(name);\n    if (elements.length < 1) {\n        var child = node.firstElementChild || node.firstChild;\n        if (child) {\n            var namespaceURI = child.namespaceURI;\n            elements = node.getElementsByTagNameNS(namespaceURI, name);\n        }\n    }\n    return elements;\n};\n\nxmldom.getElement = function (node, name) {\n    var elements = this.getElementsByTagName(node, name);\n    if (elements.length < 1) {\n        return null;\n    }\n    return elements[0];\n};\n\nxmldom.getElements = function (node, name) {\n    return this.getElementsByTagName(node, name);\n};\n\nxmldom.getSubElements = function (node, name, subName) {\n    var element = this.getElement(node, name);\n    if (element === null) {\n        return [];\n    }\n    return this.getElements(element, subName);\n};\n\nxmldom.getChildNode = function (node, name) {\n    if (!node || !node.childNodes) {\n        return null;\n    }\n    for (var i = 0; i < node.childNodes.length; i++) {\n        if (node.childNodes[i].nodeName === name) {\n            return node.childNodes[i];\n        }\n    }\n    return null;\n};\n\nxmldom.getNodeTextValue = function (node) {\n    var cdataSection = this.getChildNode(node, '#cdata-section'),\n        textSection = this.getChildNode(node, '#text');\n    if (cdataSection) {\n        return cdataSection.nodeValue;\n    } else if (textSection) {\n        return textSection.nodeValue;\n    }\n    return '';\n};\n\nxmldom.getChildNodeTextValue = function (node, name) {\n    var element = this.getElement(node, name);\n    if (element === null) {\n        return '';\n    }\n    return this.getNodeTextValue(element);\n};\n\nexports.default = xmldom;\n\n},{}],15:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The AdPlayer manages the sequencing of playing creatives of a single Ad.\n* It takes as input the Ad object as returned by the VAST parser.\n* The AdPlayer plays sequentially all contained Creatives,\n* with the help of a CreativePlayer.\n*\n* Dispatch events:\n*  - 'adStart' when when the playback of the ad (first creative) is starting.\n*  - 'adEnd' when the playback of the (all creatives) has ended\n*/\n\nvar _CreativePlayer = require('./CreativePlayer');\n\nvar _CreativePlayer2 = _interopRequireDefault(_CreativePlayer);\n\nvar _Debug = require('../Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _EventBus = require('../EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar AdPlayer = function () {\n    _createClass(AdPlayer, [{\n        key: '_sendImpressions',\n        value: function _sendImpressions(impressions) {\n            var impression = void 0;\n\n            if (impressions.length === 0) {\n                return;\n            }\n\n            for (var i = 0; i < impressions.length; i++) {\n                impression = impressions[i];\n                if (impression.uri && impression.uri.length > 0) {\n                    this._debug.log(\"Send Impression, uri = \" + impression.uri);\n                    var http = new XMLHttpRequest();\n                    http.open(\"GET\", impression.uri, true);\n                    http.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n                    http.send();\n                }\n            }\n        }\n    }, {\n        key: '_onCreativeEnd',\n        value: function _onCreativeEnd() {\n\n            this._debug.log(\"Creative ended\");\n\n            // Stop the current creative media\n            this._stopCreative();\n\n            // Play next creative\n            this._playNextCreative();\n        }\n    }, {\n        key: '_pauseCreative',\n        value: function _pauseCreative() {\n            if (!this._creativePlayer) {\n                return;\n            }\n            this._creativePlayer.pause();\n        }\n    }, {\n        key: '_resumeCreative',\n        value: function _resumeCreative() {\n            if (!this._creativePlayer) {\n                return;\n            }\n            this._creativePlayer.play();\n        }\n    }, {\n        key: '_stopCreative',\n        value: function _stopCreative() {\n            if (!this._creativePlayer) {\n                return;\n            }\n            this._eventBus.removeEventListener('creativeEnd', this._onCreativeEndListener);\n            this._creativePlayer.stop();\n            this._creativePlayer = null;\n        }\n    }, {\n        key: '_playCreative',\n        value: function _playCreative(index) {\n            var creative = this._ad.inLine.creatives[index],\n                linear;\n\n            this._creativeIndex = index;\n            this._debug.log(\"Play Creative - index = \" + this._creativeIndex);\n\n            // Play Linear element\n            linear = creative.linear;\n\n            if (linear) {\n                this._debug.log(\"Play Linear Ad, duration = \" + linear.duration);\n                this._eventBus.addEventListener('creativeEnd', this._onCreativeEndListener);\n                this._creativePlayer = new _CreativePlayer2.default();\n                if (!this._creativePlayer.init(creative.linear, this._adPlayerContainer, this._mainVideo, this._baseUrl)) {\n                    this._playNextCreative();\n                }\n            } else {\n                this._playNextCreative();\n            }\n        }\n    }, {\n        key: '_playNextCreative',\n        value: function _playNextCreative() {\n\n            this._creativeIndex++;\n\n            if (this._creativeIndex < this._ad.inLine.creatives.length) {\n                this._playCreative(this._creativeIndex);\n            } else {\n                // Notify end of Ad\n                this._eventBus.dispatchEvent({\n                    type: \"adEnd\",\n                    data: {}\n                });\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n        /**\n         * Initializes the AdPlayer\n         * @method constructor\n         * @access public\n         * @memberof AdPlayer#\n         */\n\n    }]);\n\n    function AdPlayer() {\n        _classCallCheck(this, AdPlayer);\n\n        this._ad = null;\n        this._adPlayerContainer = null;\n        this._mainVideo = null;\n        this._baseUrl = '';\n        this._creativeIndex = -1;\n        this._creativePlayer = null;\n        this._debug = _Debug2.default.getInstance();\n        this._eventBus = _EventBus2.default.getInstance();\n\n        this._onCreativeEndListener = this._onCreativeEnd.bind(this);\n    }\n\n    /**\n     * Initializes the AdManager.\n     * @method init\n     * @access public\n     * @memberof VastPlayerManager#\n     * @param {Object} ad - the Ad to play\n     * @param {Array} adPlayerContainer - the HTML DOM container for ads player components\n     * @param {Object} mainVideo - the HTML5 video element used by the main media player\n     * @param {string} baseUrl - the base URL for media files\n     */\n\n\n    _createClass(AdPlayer, [{\n        key: 'init',\n        value: function init(ad, adPlayerContainer, mainVideo, baseUrl) {\n            this._ad = ad;\n            this._adPlayerContainer = adPlayerContainer;\n            this._mainVideo = mainVideo;\n            this._baseUrl = baseUrl;\n        }\n    }, {\n        key: 'start',\n        value: function start() {\n            // Notify an Ad is starting to play\n            this._eventBus.dispatchEvent({\n                type: 'adStart',\n                data: {}\n            });\n\n            // Send Impressions tracking\n            this._sendImpressions(this._ad.inLine.impressions);\n\n            // Play first Creative\n            this._playCreative(0);\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            this._resumeCreative();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._pauseCreative();\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._stopCreative();\n        }\n    }]);\n\n    return AdPlayer;\n}();\n\nexports.default = AdPlayer;\n\n},{\"../Debug\":4,\"../EventBus\":6,\"./CreativePlayer\":16}],16:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The CreativePlayer manages:\n* - the playing of media files within a Creative (with the help of a Image/VideoPlayer)\n* - the tracking events (with the help of a TrackingEventsManager)\n* - the display of the ad skipping component\n* - the user clicks\n*/\n\nvar _TrackingEventsManager = require('./TrackingEventsManager');\n\nvar _TrackingEventsManager2 = _interopRequireDefault(_TrackingEventsManager);\n\nvar _VideoPlayer = require('../media/VideoPlayer');\n\nvar _VideoPlayer2 = _interopRequireDefault(_VideoPlayer);\n\nvar _ImagePlayer = require('../media/ImagePlayer');\n\nvar _ImagePlayer2 = _interopRequireDefault(_ImagePlayer);\n\nvar _Debug = require('../Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _EventBus = require('../EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar CreativePlayer = function () {\n    _createClass(CreativePlayer, [{\n        key: '_parseTime',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _parseTime(str) {\n            var timeParts,\n                SECONDS_IN_HOUR = 60 * 60,\n                SECONDS_IN_MIN = 60;\n\n            if (!str) {\n                return -1;\n            }\n\n            timeParts = str.split(':');\n\n            // Check time format, must be HH:MM:SS(.mmm)\n            if (timeParts.length !== 3) {\n                return -1;\n            }\n\n            return parseInt(timeParts[0]) * SECONDS_IN_HOUR + parseInt(timeParts[1]) * SECONDS_IN_MIN + parseFloat(timeParts[2]);\n        }\n    }, {\n        key: '_onMediaPlay',\n        value: function _onMediaPlay() {\n\n            this._debug.log(\"Creative media play\");\n\n            // Notify the creative has ended\n            this._eventBus.dispatchEvent({\n                type: 'play',\n                data: {}\n            });\n        }\n    }, {\n        key: '_onMediaPause',\n        value: function _onMediaPause() {\n\n            this._debug.log(\"Creative media pause\");\n\n            // Notify the creative has ended\n            this._eventBus.dispatchEvent({\n                type: 'pause',\n                data: {}\n            });\n        }\n    }, {\n        key: '_onMediaError',\n        value: function _onMediaError() {\n\n            this._debug.log(\"Creative media error\");\n\n            // Notify the creative has ended\n            this._eventBus.dispatchEvent({\n                type: 'creativeEnd',\n                data: {}\n            });\n        }\n    }, {\n        key: '_onMediaEnded',\n        value: function _onMediaEnded() {\n\n            this._debug.log(\"creative media ended\");\n\n            // Notify the creative has ended\n            this._eventBus.dispatchEvent({\n                type: 'creativeEnd',\n                data: {}\n            });\n        }\n    }, {\n        key: '_onMediaTimeupdate',\n        value: function _onMediaTimeupdate() {\n\n            //this._debug.log(\"Media timeupdate: \" + this._mediaPlayer.getCurrentTime());\n        }\n    }, {\n        key: '_onMainVideoVolumeChange',\n        value: function _onMainVideoVolumeChange() {\n            if (!this._mediaPlayer) {\n                return;\n            }\n            this._mediaPlayer.setVolume(this._mainVideo.muted ? 0 : this._mainVideo.volume);\n        }\n    }, {\n        key: '_onAdClick',\n        value: function _onAdClick(creative) {\n            // this = creative player\n            if (!creative.videoClicks) {\n                return;\n            }\n            this._debug.log(\"Creative Click\");\n            // ClickThrough : send an event for the application to open the web page\n            if (creative.videoClicks.clickThrough) {\n                this._debug.log(\"Ad click, uri = \" + creative.videoClicks.clickThrough);\n                this._eventBus.dispatchEvent({\n                    type: 'click',\n                    data: {\n                        uri: creative.videoClicks.clickThrough\n                    }\n                });\n            }\n\n            // TODO\n            // ClickTracking\n            // if (this.videoClicks.clickTracking) {\n            // }\n        }\n    }, {\n        key: '_load',\n        value: function _load(creative, baseUrl) {\n            var mediaFile, isVideo, isImage;\n\n            if (!creative) {\n                return false;\n            }\n\n            if (creative.mediaFiles.length === 0) {\n                return false;\n            }\n\n            mediaFile = creative.mediaFiles[0];\n\n            // Video or image media ?\n            isVideo = mediaFile.type.indexOf('video') !== -1;\n            isImage = mediaFile.type.indexOf('image') !== -1;\n\n            if (isVideo) {\n                this._mediaPlayer = new _VideoPlayer2.default();\n            } else if (isImage) {\n                this._mediaPlayer = new _ImagePlayer2.default();\n            } else {\n                // Unknown/unsupported media type\n                return false;\n            }\n\n            // Load the media files\n            this._debug.log(\"Creative load\");\n            if (!this._mediaPlayer.load(baseUrl, creative.mediaFiles)) {\n                this._mediaPlayer = null;\n                return false;\n            }\n\n            this._mediaPlayer.setDuration(this._parseTime(creative.duration));\n            this._mediaPlayer.addEventListener('play', this._onMediaPlayListener);\n            this._mediaPlayer.addEventListener('pause', this._onMediaPauseListener);\n            this._mediaPlayer.addEventListener('error', this._onMediaErrorListener);\n            this._mediaPlayer.addEventListener('timeupdate', this._onMediaTimeupdateListener);\n            this._mediaPlayer.addEventListener('ended', this._onMediaEndedListener);\n\n            // Add tracking events\n            if (creative.trackingEvents) {\n                this._trackingEventsManager = new _TrackingEventsManager2.default();\n                this._trackingEventsManager.init(creative.trackingEvents, this._mediaPlayer);\n                this._trackingEventsManager.start();\n            }\n\n            // Notify a creative is starting to play\n            this._eventBus.dispatchEvent({\n                type: 'creativeStart',\n                data: {}\n            });\n\n            // Notify a media element has been created and appended into document\n            this._eventBus.dispatchEvent({\n                type: 'addElement',\n                data: {\n                    element: this._mediaPlayer.getElement(),\n                    type: this._mediaPlayer.getType()\n                }\n            });\n\n            // Add the media player DOM element\n            this._adPlayerContainer.appendChild(this._mediaPlayer.getElement());\n\n            // Listener for click\n            if (creative.videoClicks) {\n                if (creative.videoClicks.clickThrough) {\n                    this._mediaPlayer.getElement().style.cursor = 'pointer';\n                }\n                this._mediaPlayer.getElement().addEventListener('click', this._onAdClick.bind(this, creative));\n            }\n\n            // Align media volume to main video volume, add 'volumechange' listener\n            this._onMainVideoVolumeChange();\n            this._mainVideo.addEventListener('volumechange', this._onMainVideoVolumeChange.bind(this));\n\n            // Start playing the media\n            this._play();\n\n            return true;\n        }\n    }, {\n        key: '_play',\n        value: function _play() {\n\n            if (!this._mediaPlayer) {\n                return;\n            }\n\n            this._debug.log(\"Creative play\");\n\n            // Play the media player\n            this._mediaPlayer.play();\n        }\n    }, {\n        key: '_pause',\n        value: function _pause() {\n\n            if (!this._mediaPlayer) {\n                return;\n            }\n\n            this._debug.log(\"Creative pause\");\n\n            // Pause the media player\n            this._mediaPlayer.pause();\n        }\n    }, {\n        key: '_stop',\n        value: function _stop() {\n\n            if (!this._mediaPlayer) {\n                return;\n            }\n\n            this._debug.log(\"Creative stop\");\n\n            // Stop listening for 'volumechange' event\n            this._mainVideo.removeEventListener('volumechange', this._onMainVideoVolumeChange);\n            this._mainVideo = null;\n\n            // Stop the media player\n            this._mediaPlayer.removeEventListener('play', this._onMediaPlayListener);\n            this._mediaPlayer.removeEventListener('pause', this._onMediaPauseListener);\n            this._mediaPlayer.removeEventListener('error', this._onMediaErrorListener);\n            this._mediaPlayer.removeEventListener('timeupdate', this._onMediaTimeupdateListener);\n            this._mediaPlayer.removeEventListener('ended', this._onMediaEndedListener);\n            this._mediaPlayer.stop();\n\n            // Notify a media element has been removed from DOM\n            this._eventBus.dispatchEvent({\n                type: 'removeElement',\n                data: {\n                    element: this._mediaPlayer.getElement(),\n                    type: this._mediaPlayer.getType()\n                }\n            });\n\n            // Remove the element from the DOM\n            this._adPlayerContainer.removeChild(this._mediaPlayer.getElement());\n\n            // Reset the media player\n            this._mediaPlayer.reset();\n            this._mediaPlayer = null;\n\n            // Stop the TrackingEvents manager\n            if (this._trackingEventsManager) {\n                this._trackingEventsManager.stop();\n                this._trackingEventsManager = null;\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function CreativePlayer() {\n        _classCallCheck(this, CreativePlayer);\n\n        this._adPlayerContainer = null;\n        this._mediaPlayer = null;\n        this._trackingEventsManager = null;\n        this._mainVideo = null;\n        this._debug = _Debug2.default.getInstance();\n        this._eventBus = _EventBus2.default.getInstance();\n\n        this._onMediaPlayListener = this._onMediaPlay.bind(this);\n        this._onMediaPauseListener = this._onMediaPause.bind(this);\n        this._onMediaErrorListener = this._onMediaError.bind(this);\n        this._onMediaTimeupdateListener = this._onMediaTimeupdate.bind(this);\n        this._onMediaEndedListener = this._onMediaEnded.bind(this);\n    }\n\n    /**\n     * Initializes the creative player.\n     * @method init\n     * @access public\n     * @memberof CreativePlayer#\n     * @param {Object} creative - the creative element to play\n     * @param {Object} adPlayerContainer - the HTML DOM container for ads player components\n     * @param {Object} mainVideo - the HTML5 video element used by the main media player\n     * @param {string} baseUrl - the base URL for media files\n     */\n\n\n    _createClass(CreativePlayer, [{\n        key: 'init',\n        value: function init(creative, adPlayerContainer, mainVideo, baseUrl) {\n            this._adPlayerContainer = adPlayerContainer;\n            this._mainVideo = mainVideo;\n            return this._load(creative, baseUrl);\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            this._play();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._pause();\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._stop();\n        }\n    }]);\n\n    return CreativePlayer;\n}();\n\nexports.default = CreativePlayer;\n\n},{\"../Debug\":4,\"../EventBus\":6,\"../media/ImagePlayer\":11,\"../media/VideoPlayer\":12,\"./TrackingEventsManager\":17}],17:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The TrackingEventsManager manages the sending of the tracking events while a creative's media is playing.\n* It takes as input the list of tracking events to send.\n*/\n\nvar _Debug = require('../Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TrackingEventsManager = function () {\n    _createClass(TrackingEventsManager, [{\n        key: '_postEvent',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _postEvent(uri) {\n            var xhr = new XMLHttpRequest();\n            xhr.open('GET', uri, true);\n            xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n            xhr.send();\n        }\n    }, {\n        key: '_addEventListener',\n        value: function _addEventListener(element, eventType, trackingEvent) {\n\n            var self = this,\n                _listener = function _listener() /*event*/{\n                if (this.completed === true) {\n                    return;\n                }\n                if (this.uri === undefined || this.uri.length === 0) {\n                    return;\n                }\n                if (this.condition && !this.condition()) {\n                    return;\n                }\n                self._debug.log(\"Send tracking event \" + this.event + \", uri = \" + this.uri);\n                self._postEvent(this.uri);\n                if (this.oneShot === true) {\n                    this.completed = true;\n                }\n            },\n                _eventListener = {\n                type: eventType,\n                element: element,\n                listener: _listener.bind(trackingEvent)\n            };\n\n            element.addEventListener(eventType, _eventListener.listener);\n            this._eventListeners.push(_eventListener);\n        }\n    }, {\n        key: '_addPlayerEventListeners',\n        value: function _addPlayerEventListeners() {\n            var _this = this;\n\n            var _loop = function _loop(i) {\n                var trackingEvent = _this._trackingEvents[i];\n                if (trackingEvent.uri && trackingEvent.uri.length > 0) {\n                    switch (trackingEvent.event) {\n                        case 'creativeView':\n                            trackingEvent.oneShot = true;\n                            _this._addEventListener(_this._adMediaPlayer, 'loadeddata', trackingEvent);\n                            break;\n                        case 'start':\n                            trackingEvent.oneShot = true;\n                            _this._addEventListener(_this._adMediaPlayer, 'playing', trackingEvent);\n                            break;\n                        case 'pause':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                // To ignore pause event that may be raised at end of stream\n                                return _this._adMediaPlayer.isEnded() === false;\n                            };\n                            _this._addEventListener(_this._adMediaPlayer, 'pause', trackingEvent);\n                            break;\n                        case 'resume':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                return _this._adMediaPlayer.getCurrentTime() > 0;\n                            };\n                            _this._addEventListener(_this._adMediaPlayer, 'play', trackingEvent);\n                            break;\n                        case 'firstQuartile':\n                            trackingEvent.oneShot = true;\n                            trackingEvent.condition = function () {\n                                //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                                return _this._adMediaPlayer.getCurrentTime() / _this._adMediaPlayer.getDuration() >= 0.25;\n                            };\n                            _this._addEventListener(_this._adMediaPlayer, 'timeupdate', trackingEvent);\n                            break;\n                        case 'midpoint':\n                            trackingEvent.oneShot = true;\n                            trackingEvent.condition = function () {\n                                //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                                return _this._adMediaPlayer.getCurrentTime() / _this._adMediaPlayer.getDuration() >= 0.50;\n                            };\n                            _this._addEventListener(_this._adMediaPlayer, 'timeupdate', trackingEvent);\n                            break;\n                        case 'thirdQuartile':\n                            trackingEvent.oneShot = true;\n                            trackingEvent.condition = function () {\n                                //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                                return _this._adMediaPlayer.getCurrentTime() / _this._adMediaPlayer.getDuration() >= 0.75;\n                            };\n                            _this._addEventListener(_this._adMediaPlayer, 'timeupdate', trackingEvent);\n                            break;\n                        case 'rewind':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                var res = _this._adMediaPlayer.getCurrentTime() < _this._currentTime && _this._adMediaPlayer.isEnded() === false;\n                                _this._currentTime = _this._adMediaPlayer.getCurrentTime();\n                                return res;\n                            };\n                            _this._addEventListener(_this._adMediaPlayer, 'timeupdate', trackingEvent);\n                            break;\n                        case 'complete':\n                            _this._addEventListener(_this._adMediaPlayer, 'ended', trackingEvent);\n                            break;\n                        case 'mute':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                var res = !_this._mute && _this._adMediaPlayer.getVolume() === 0;\n                                _this._mute = _this._adMediaPlayer.getVolume() === 0;\n                                return res;\n                            };\n                            _this._addEventListener(_this._adMediaPlayer, 'volumechange', trackingEvent);\n                            break;\n                        case 'unmute':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                var res = !_this._unmute && _this._adMediaPlayer.getVolume() > 0;\n                                _this._unmute = _this._adMediaPlayer.getVolume() > 0;\n                                return res;\n                            };\n                            _this._addEventListener(_this._adMediaPlayer, 'volumechange', trackingEvent);\n                            break;\n                        case 'fullscreen':\n                        case 'exitFullscreen':\n                            trackingEvent.oneShot = false;\n                            trackingEvent.condition = function () {\n                                var event = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : trackingEvent.event;\n\n                                var state = event === 'fullscreen';\n                                return document.fullScreen === state || document.mozFullScreen === state || document.webkitIsFullScreen === state;\n                            };\n                            _this._addEventListener(document, 'webkitfullscreenchange', trackingEvent);\n                            _this._addEventListener(document, 'mozfullscreenchange', trackingEvent);\n                            _this._addEventListener(document, 'MSFullscreenChange', trackingEvent);\n                            _this._addEventListener(document, 'fullscreenChange', trackingEvent);\n                            break;\n                        case 'progress':\n                            trackingEvent.oneShot = true;\n                            trackingEvent.condition = function () {\n                                if (trackingEvent.offsetPercent) {\n                                    //this._debug.log(\"progress:\" + this._adMediaPlayer.getCurrentTime()+\" vs offsetPercent = \" + trackingEvent.offsetPercent * this._adMediaPlayer.getDuration());\n                                    return _this._adMediaPlayer.getCurrentTime() >= trackingEvent.offsetPercent * _this._adMediaPlayer.getDuration();\n                                } else {\n                                    //this._debug.log(\"progress:\" + this._adMediaPlayer.getCurrentTime()+\" vs offsetInSeconds \" + trackingEvent.offsetInSeconds);\n                                    return _this._adMediaPlayer.getCurrentTime() >= trackingEvent.offsetInSeconds;\n                                }\n                            };\n                            _this._addEventListener(_this._adMediaPlayer, 'timeupdate', trackingEvent);\n                            break;\n                        case 'acceptInvitationLinear':\n                            trackingEvent.oneShot = false;\n                            _this._addEventListener(_this._adMediaPlayer, 'click', trackingEvent);\n                            break;\n                        case 'closeLinear':\n                            trackingEvent.oneShot = false;\n                            _this._addEventListener(window, 'beforeunload', trackingEvent);\n                            break;\n                        default:\n                            break;\n                    }\n                }\n            };\n\n            for (var i = 0; i < this._trackingEvents.length; i++) {\n                _loop(i);\n            }\n        }\n    }, {\n        key: '_removePlayerEventListeners',\n        value: function _removePlayerEventListeners() {\n            for (var i = 0; i < this._eventListeners.length; i++) {\n                this._eventListeners[i].element.removeEventListener(this._eventListeners[i].type, this._eventListeners[i].listener);\n            }\n            this._eventListeners = [];\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function TrackingEventsManager() {\n        _classCallCheck(this, TrackingEventsManager);\n\n        this._trackingEvents = null;\n        this._adMediaPlayer = null;\n        this._currentTime = -1;\n        this._mute = -1;\n        this._unmute = -1;\n        this._debug = _Debug2.default.getInstance();\n        this._eventListeners = [];\n    }\n\n    /**\n     * Initializes the TrackingEventsManager.\n     * @method init\n     * @access public\n     * @memberof TrackingEventsManager#\n     * @param {Array} trackingEvents - the array of tracking events to manage\n     * @param {Object} adMediaPlayer - the ad media player\n     */\n\n\n    _createClass(TrackingEventsManager, [{\n        key: 'init',\n        value: function init(trackingEvents, adMediaPlayer) {\n            this._trackingEvents = trackingEvents;\n            this._adMediaPlayer = adMediaPlayer;\n            this._mute = this._adMediaPlayer.getVolume() === 0;\n            this._unmute = this._adMediaPlayer.getVolume() > 0;\n        }\n    }, {\n        key: 'start',\n        value: function start() {\n            if (this._trackingEvents.length === 0) {\n                return;\n            }\n            this._addPlayerEventListeners();\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._removePlayerEventListeners();\n        }\n    }]);\n\n    return TrackingEventsManager;\n}();\n\nexports.default = TrackingEventsManager;\n\n},{\"../Debug\":4}],18:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* VAST parser. This class parses VAST file in XML format\n* and construct the corresponding VAST object according to VAST data model.\n*/\n\nvar _Vast = require('./model/Vast');\n\nvar _Vast2 = _interopRequireDefault(_Vast);\n\nvar _xmldom = require('../utils/xmldom');\n\nvar _xmldom2 = _interopRequireDefault(_xmldom);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar VastParser = function () {\n    _createClass(VastParser, [{\n        key: '_getTrackingEvent',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _getTrackingEvent(trackingNode) {\n            var trackingEvent = new _Vast2.default.TrackingEvent();\n\n            trackingEvent.event = trackingNode.getAttribute('event');\n            trackingEvent.uri = _xmldom2.default.getNodeTextValue(trackingNode);\n            if (trackingEvent.event == \"progress\") {\n                var offsetValue = trackingNode.getAttribute('offset');\n                if (offsetValue.indexOf(\"%\") == -1) {\n                    /* convert HH:MM:SS ( or HH:MM:SS.mmm) in seconds */\n                    trackingEvent.offsetInSeconds = new Date('1970-01-01T' + offsetValue + 'Z').getTime() / 1000;\n                } else {\n                    trackingEvent.offsetPercent = offsetValue.substring(0, offsetValue.indexOf(\"%\")) / 100;\n                }\n            }\n            return trackingEvent;\n        }\n    }, {\n        key: '_getVideoClicks',\n        value: function _getVideoClicks(videoClicksNode) {\n            var videoClicks = new _Vast2.default.VideoClicks(),\n                nodeName = void 0,\n                nodeValue = void 0;\n\n            for (var i = 0; i < videoClicksNode.childNodes.length; i++) {\n                nodeName = videoClicksNode.childNodes[i].nodeName;\n                nodeValue = _xmldom2.default.getNodeTextValue(videoClicksNode.childNodes[i]);\n\n                switch (nodeName) {\n                    case \"ClickThrough\":\n                        videoClicks.clickThrough = nodeValue;\n                        break;\n                    case \"ClickTracking\":\n                        videoClicks.clickTracking = nodeValue;\n                        break;\n                    case \"CustomClick\":\n                        videoClicks.customClick = nodeValue;\n                        break;\n                }\n            }\n\n            return videoClicks;\n        }\n    }, {\n        key: '_getMediaFile',\n        value: function _getMediaFile(mediaFileNode) {\n            var mediaFile = new _Vast2.default.MediaFile();\n\n            mediaFile.id = mediaFileNode.getAttribute('id');\n            mediaFile.delivery = mediaFileNode.getAttribute('delivery');\n            mediaFile.type = mediaFileNode.getAttribute('type');\n            mediaFile.bitrate = mediaFileNode.getAttribute('bitrate');\n            mediaFile.width = mediaFileNode.getAttribute('width');\n            mediaFile.height = mediaFileNode.getAttribute('height');\n            mediaFile.scalable = mediaFileNode.getAttribute('scalable');\n            mediaFile.maintainAspectRatio = mediaFileNode.getAttribute('maintainAspectRatio');\n            mediaFile.apiFramework = mediaFileNode.getAttribute('apiFramework');\n            mediaFile.uri = _xmldom2.default.getNodeTextValue(mediaFileNode);\n\n            return mediaFile;\n        }\n    }, {\n        key: '_getLinear',\n        value: function _getLinear(linearNode) {\n            var linear = new _Vast2.default.Linear(),\n                trackingNodes = void 0,\n                videoClicksNode = void 0,\n                mediaFileNodes = void 0,\n                i = void 0;\n\n            linear.duration = _xmldom2.default.getChildNodeTextValue(linearNode, 'Duration');\n            linear.adParameters = _xmldom2.default.getChildNodeTextValue(linearNode, 'AdParameters');\n\n            trackingNodes = _xmldom2.default.getSubElements(linearNode, 'TrackingEvents', 'Tracking');\n            for (i = 0; i < trackingNodes.length; i++) {\n                linear.trackingEvents.push(this._getTrackingEvent(trackingNodes[i]));\n            }\n\n            videoClicksNode = _xmldom2.default.getElement(linearNode, 'VideoClicks');\n            if (videoClicksNode) {\n                linear.videoClicks = this._getVideoClicks(videoClicksNode);\n            }\n\n            mediaFileNodes = _xmldom2.default.getSubElements(linearNode, 'MediaFiles', 'MediaFile');\n            for (i = 0; i < mediaFileNodes.length; i++) {\n                linear.mediaFiles.push(this._getMediaFile(mediaFileNodes[i]));\n            }\n\n            return linear;\n        }\n    }, {\n        key: '_getCreative',\n        value: function _getCreative(creativeNode) {\n            var creative = new _Vast2.default.Creative(),\n                linearNode = void 0;\n\n            creative.id = creativeNode.getAttribute('id');\n            creative.adId = creativeNode.getAttribute('AdID');\n            creative.sequence = creativeNode.getAttribute('sequence');\n\n            linearNode = _xmldom2.default.getElement(creativeNode, 'Linear');\n            if (linearNode) {\n                creative.linear = this._getLinear(linearNode);\n            }\n\n            // TODO: get Companion and non-Linear elements\n\n            return creative;\n        }\n    }, {\n        key: '_getInLine',\n        value: function _getInLine(adNode) {\n            var inLine = new _Vast2.default.InLine(),\n                inLineNode = _xmldom2.default.getElement(adNode, 'InLine'),\n                impressionNodes = void 0,\n                creativeNodes = void 0,\n                i = void 0;\n\n            if (inLineNode === null) {\n                return null;\n            }\n\n            inLine.adSystem = _xmldom2.default.getChildNodeTextValue(inLineNode, 'AdSystem');\n            inLine.adTitle = _xmldom2.default.getChildNodeTextValue(inLineNode, 'AdTitle');\n            inLine.description = _xmldom2.default.getChildNodeTextValue(inLineNode, 'Description');\n            inLine.survey = _xmldom2.default.getChildNodeTextValue(inLineNode, 'Survey');\n            inLine.error = _xmldom2.default.getChildNodeTextValue(inLineNode, 'Error');\n\n            impressionNodes = _xmldom2.default.getElements(inLineNode, 'Impression');\n            for (i = 0; i < impressionNodes.length; i++) {\n                var impression = new _Vast2.default.Impression();\n                impression.id = impressionNodes[i].getAttribute('id');\n                impression.uri = _xmldom2.default.getNodeTextValue(impressionNodes[i]);\n                inLine.impressions.push(impression);\n            }\n\n            creativeNodes = _xmldom2.default.getSubElements(inLineNode, 'Creatives', 'Creative');\n            for (i = 0; i < creativeNodes.length; i++) {\n                inLine.creatives.push(this._getCreative(creativeNodes[i]));\n            }\n\n            return inLine;\n        }\n    }, {\n        key: '_getAd',\n        value: function _getAd(adNode) {\n            var ad = new _Vast2.default.Ad();\n            ad.id = adNode.getAttribute('id');\n            ad.sequence = adNode.getAttribute('sequence');\n            ad.inLine = this._getInLine(adNode);\n            return ad;\n        }\n    }, {\n        key: '_getAds',\n        value: function _getAds(vastNode, vast_) {\n            var adNodes = _xmldom2.default.getElements(vastNode, 'Ad');\n            for (var i = 0; i < adNodes.length; i++) {\n                vast_.ads.push(this._getAd(adNodes[i]));\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function VastParser() {\n        _classCallCheck(this, VastParser);\n    }\n\n    /**\n    * Parses the VAST XML DOM and get the triggers.\n    * @param {object} xmlDom - the XML DOM to parse\n    */\n\n\n    _createClass(VastParser, [{\n        key: 'parse',\n        value: function parse(xmlDom) {\n            var vast_ = new _Vast2.default.Vast(),\n                vastNode = _xmldom2.default.getElement(xmlDom, 'VAST');\n\n            if (vastNode === null) {\n                return vast_;\n            }\n\n            vast_.version = vastNode.getAttribute('version');\n\n            this._getAds(vastNode, vast_);\n\n            return vast_;\n        }\n    }]);\n\n    return VastParser;\n}();\n\nexports.default = VastParser;\n\n},{\"../utils/xmldom\":14,\"./model/Vast\":20}],19:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * The copyright in this software module is being made available under the BSD License, included\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * below. This software module may be subject to other third party and/or contributor rights,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * including patent rights, and no such rights are granted under this license.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Copyright (c) 2016, Orange\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * All rights reserved.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * Redistribution and use in source and binary forms, with or without modification, are permitted\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * provided that the following conditions are met:\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions of source code must retain the above copyright notice, this list of conditions\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   and the following disclaimer.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Redistributions in binary form must reproduce the above copyright notice, this list of\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   conditions and the following disclaimer in the documentation and/or other materials provided\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   with the distribution.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *   products derived from this software module without specific prior written permission.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     */\n\n/**\n* The VastPlayerManager manages the sequencing of playing ads of a single VAST.\n* It takes as input the list of Vast objects as returned by the VAST parser.\n* For each Vast, the VastPlayerManager plays sequentially all contained Ads,\n* with the help of an AdPlayer.\n*/\n\nvar _AdPlayer = require('./AdPlayer');\n\nvar _AdPlayer2 = _interopRequireDefault(_AdPlayer);\n\nvar _Debug = require('../Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nvar _EventBus = require('../EventBus');\n\nvar _EventBus2 = _interopRequireDefault(_EventBus);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar VastPlayerManager = function () {\n    _createClass(VastPlayerManager, [{\n        key: '_onAdEnd',\n\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n        value: function _onAdEnd() {\n\n            this._debug.log(\"Ad ended\");\n\n            // Stop the current Ad\n            this._stopAd();\n\n            // Play next Ad\n            this._playNextAd();\n        }\n    }, {\n        key: '_pauseAd',\n        value: function _pauseAd() {\n            if (!this._adPlayer) {\n                return;\n            }\n            this._adPlayer.pause();\n        }\n    }, {\n        key: '_resumeAd',\n        value: function _resumeAd() {\n            if (!this._adPlayer) {\n                return;\n            }\n            this._adPlayer.play();\n        }\n    }, {\n        key: '_stopAd',\n        value: function _stopAd() {\n            if (!this._adPlayer) {\n                return;\n            }\n            this._eventBus.removeEventListener('adEnd', this._onAdEndListener);\n            this._adPlayer.stop();\n            this._adPlayer = null;\n        }\n    }, {\n        key: '_playAd',\n        value: function _playAd(index) {\n            var vast = this._vasts[this._vastIndex],\n                ad = vast.ads[index];\n\n            this._adIndex = index;\n            this._debug.log(\"Play Ad - index = \" + this._adIndex);\n\n            this._eventBus.addEventListener('adEnd', this._onAdEndListener);\n            this._adPlayer = new _AdPlayer2.default();\n            this._adPlayer.init(ad, this._adPlayerContainer, this._mainVideo, vast.baseUrl);\n            this._adPlayer.start();\n        }\n    }, {\n        key: '_playNextAd',\n        value: function _playNextAd() {\n            var vast = this._vasts[this._vastIndex];\n\n            this._adIndex++;\n\n            if (this._adIndex < vast.ads.length) {\n                this._playAd(this._adIndex);\n            } else {\n                this._playNextVast();\n            }\n        }\n    }, {\n        key: '_playVast',\n        value: function _playVast(index) {\n            var vast = this._vasts[index];\n\n            if (vast.ads.length === 0) {\n                // Empty VAST\n                return;\n            }\n\n            this._vastIndex = index;\n            this._debug.log(\"Play Vast - index = \" + this._vastIndex);\n\n            // Play first Ad\n            this._playAd(0);\n        }\n    }, {\n        key: '_playNextVast',\n        value: function _playNextVast() {\n\n            this._vastIndex++;\n\n            if (this._vastIndex < this._vasts.length) {\n                this._playVast(this._vastIndex);\n            } else {\n                // Notify end of trigger\n                this._eventBus.dispatchEvent({\n                    type: 'triggerEnd',\n                    data: {}\n                });\n            }\n        }\n\n        ///////////////////////////////////////////////////////////////////////////////////////////////\n        ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    }]);\n\n    function VastPlayerManager() {\n        _classCallCheck(this, VastPlayerManager);\n\n        this._vasts = [];\n        this._adPlayerContainer = null;\n        this._adIndex = -1;\n        this._adPlayer = null;\n        this._debug = _Debug2.default.getInstance();\n        this._eventBus = _EventBus2.default.getInstance();\n        this._onAdEndListener = this._onAdEnd.bind(this);\n    }\n\n    /**\n     * Initializes the VastPlayerManager.\n     * @method init\n     * @access public\n     * @memberof VastPlayerManager#\n     * @param {Array} vasts - the array of Vast components to play\n     * @param {Array} adPlayerContainer - the HTML DOM container for ads player components\n     */\n\n\n    _createClass(VastPlayerManager, [{\n        key: 'init',\n        value: function init(vasts, adPlayerContainer, mainVideo) {\n            this._vasts = vasts;\n            this._adPlayerContainer = adPlayerContainer;\n            this._mainVideo = mainVideo;\n        }\n    }, {\n        key: 'start',\n        value: function start() {\n            if (!this._vasts || this._vasts.length === 0) {\n                return;\n            }\n\n            // Notify a trigger is starting to play\n            this._eventBus.dispatchEvent({\n                type: 'triggerStart',\n                data: {}\n            });\n\n            this._playVast(0);\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            this._resumeAd();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._pauseAd();\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._stopAd();\n        }\n    }]);\n\n    return VastPlayerManager;\n}();\n\nexports.default = VastPlayerManager;\n\n},{\"../Debug\":4,\"../EventBus\":6,\"./AdPlayer\":15}],20:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* @class Vast\n* @ignore\n*/\nvar Vast = function Vast() {\n    _classCallCheck(this, Vast);\n\n    this.version = '';\n    this.ads = [];\n};\n\n/**\n* @class Ad\n* @ignore\n*/\n\n\nvar Ad = function Ad() {\n    _classCallCheck(this, Ad);\n\n    this.id = ''; // [Optional] an ad server-defined string for the ad\n    this.sequence = 0; // [Optional] the sequence in which an ad should play\n    this.inLine = null;\n    this.wrapper = null;\n};\n\n/**\n* @class InLine\n* @ignore\n*/\n\n\nvar InLine = function InLine() {\n    _classCallCheck(this, InLine);\n\n    this.adSystem = ''; // [Required] Source ad server\n    this.adTitle = ''; // [Required] Title\n    this.description = ''; // [Optional] Description\n    this.survey = ''; // [Optional] URI of request to survey vendor\n    this.error = ''; // [Optional] URI to request if ad does not play due to error\n    this.impressions = []; // [Required] URIs to track impressions.\n    this.creatives = []; // [Required] Creative elements\n    this.extensions = []; // [Optional] Any valid XML may be included in the Extensions node\n};\n\n/**\n* @class Impression\n* @ignore\n*/\n\n\nvar Impression = function Impression() {\n    _classCallCheck(this, Impression);\n\n    this.uri = ''; // [Required] URI to track Impression\n    this.id = ''; // [Optional] Identifier\n};\n\n/**\n* @class Extensions\n* @ignore\n*/\n\n\nvar Extensions = function Extensions() {\n    _classCallCheck(this, Extensions);\n\n    this.uri = ''; //\n    this.other = ''; //\n};\n\n/**\n* @class Creative\n* @ignore\n*/\n\n\nvar Creative = function Creative() {\n    _classCallCheck(this, Creative);\n\n    this.id = ''; // [Optional] Identifier\n    this.adId = ''; // [Optional] Ad-ID for the creative (formerly ISCI)\n    this.sequence = 0; // [Optional] The preferred order in which multiple Creatives should be displayed\n    this.linear = null; // [Optional] Linear ad\n    this.CompanionAds = []; // [Optional] Companion ads\n    this.nonLinearAds = []; // [Optional] Non-linear ads\n};\n\n// Creative types\n\n\nCreative.TYPE = {\n    LINEAR: 'linear',\n    NON_LINEAR_ADS: 'NonLinearAds',\n    COMPANION_ADS: 'CompanionAds'\n};\n\n/**\n* @class Linear\n* @ignore\n*/\n\nvar Linear = function Linear() {\n    _classCallCheck(this, Linear);\n\n    this.duration = 0; // [Required] Duration in standard time format, hh:mm:ss\n    this.trackingEvents = []; // [Optional] Tracking events elements\n    this.adParameters = ''; // [Optional] Data to be passed into the video ad\n    this.videoClicks = null; // [Optional] Video clicks\n    this.mediaFiles = []; // [Required] Media file elements\n};\n\n/**\n* @class Companion\n* @ignore\n*/\n\n\nvar Companion = function Companion() {\n    _classCallCheck(this, Companion);\n\n    this.id = ''; // optional : identifier\n    this.width = 0; // width pixel dimension of companion\n    this.height = 0; // height pixel dimension of companion\n    this.staticResource = null; // optional : pointer to the static resource : AdsPlayer.vast.model.Ad.StaticResource\n    this.iFrameResource = ''; // optional : URI source for an IFrame to display the companion element\n    this.hTMLResource = ''; // optional : HTML to display the companion element : shall be CDATA value\n    this.trackingEvents = []; // optional : pointer to any number of tracking objects : AdsPlayer.vast.model.Ad.CompanionTracking\n    this.clickThrough = ''; // optional : URI to open as destination page when user clicks on the companion\n    this.altText = ''; // optional : alt text to be displayed when companion is rendered in HTML environment.\n    this.adParameters = ''; // optional : data to be passed into the companion ads\n};\n\n//\n//      Non Linear Ads\n//\n\n/**\n* @class Companion\n* @ignore\n*/\n\n\nvar NonLinear = function NonLinear() {\n    _classCallCheck(this, NonLinear);\n\n    this.id = ''; // optional : identifier\n    this.width = 0; // width pixel dimension of non linear\n    this.height = 0; // height pixel dimension of non linear\n    this.expandedWidth = 0; // optional : pixel dimensions of expanding nonlinear ad when in expanded state\n    this.expandedHeight = 0; // optional : pixel dimensions of expanding nonlinear ad when in expanded state\n    this.scalable = true; // optional : whether it is acceptable to scale the image\n    this.maintainAspectRatio = true; // optional : whether the ad must have its aspect ratio maintained when scaled\n    this.apiFramework = ''; // optional : defines the method to use for communication with the nonlinear element\n    this.staticResource = null; // optional : pointer to the static resource : AdsPlayer.vast.model.Ad.StaticResource\n    this.hTMLResource = ''; // optional : HTML to display the companion element : shall be CDATA value\n    this.trackingEvents = []; // optional : pointer to any number of tracking objects : AdsPlayer.vast.model.Ad.Tracking\n    this.clickThrough = ''; // optional : URI to open as destination page when user clicks on the non-linear ad unit\n    this.adParameters = ''; // optional : data to be passed into the video ad\n};\n\n/**\n* @class TrackingEvent\n* @ignore\n*/\n\n\nvar TrackingEvent = function TrackingEvent() {\n    _classCallCheck(this, TrackingEvent);\n\n    this.uri = ''; // [Optional] URI to track various events during playback\n    this.event = ''; // [Required] The name of the event to track for the Linear element\n    this.offsetInSeconds = ''; // [Optional] Required in \"Progess\" event, not use with other events\n    this.offsetPercent = ''; // [Optional] Required in \"Progess\" event, not use with other events\n};\n\n/**\n* [TrackingEvent description]\n* @type {Object}\n*/\n\n\nTrackingEvent.TYPE = {\n    CREATIVEVIEW: 'creativeView',\n    START: 'start',\n    MIDPOINT: 'midpoint',\n    FIRSTQUARTILE: 'firstQuartile',\n    THIRDQUARTILE: 'thirdQuartile',\n    COMPLETE: 'complete',\n    MUTE: 'mute',\n    UNMUTE: 'unmute',\n    PAUSE: 'pause',\n    REWIND: 'rewind',\n    RESUME: 'resume',\n    FULLSCREEN: 'fullscreen',\n    EXPAND: 'expand',\n    COLLAPSE: 'collapse',\n    ACCEPTINVITATION: 'acceptInvitation',\n    CLOSE: 'close'\n};\n\n/**\n* @class VideoClicks\n* @ignore\n*/\n\nvar VideoClicks = function VideoClicks() {\n    _classCallCheck(this, VideoClicks);\n\n    this.clickThrough = ''; // [Optional] URI to open as destination page when user clicks on the video\n    this.clickTracking = ''; // [Optional] URI to request for tracking purposes when user clicks on the video\n    this.customClick = ''; // [Optional] URI to request on custom events such as hotspotted video\n};\n\n/**\n* @class MediaFile\n* @ignore\n*/\n\n\nvar MediaFile = function MediaFile() {\n    _classCallCheck(this, MediaFile);\n\n    this.id = ''; // [Optional] Identifier\n    this.delivery = ''; // [Required] Method of delivery of ad ('streaming' or 'progressive')\n    this.type = ''; // [Required] MIME type\n    this.bitrate = 0; // [Optional] Bitrate of encoded video in Kbps\n    this.width = 0; // [Required] Pixel dimensions of video\n    this.height = 0; // [Required] Pixel dimensions of video\n    this.scalable = true; // [Optional] Whether it is acceptable to scale the image.\n    this.maintainAspectRatio = true; // [Optional] Whether the ad must have its aspect ratio maintained when scaled\n    this.apiFramework = ''; // [Optional] Defines the method to use for communication if the MediaFile is interactive.\n    this.uri = '';\n};\n\n// MediaFile delivery types\n\n\nMediaFile.DELIVERY = {\n    STREAMING: 'streaming',\n    PROGRESSIVE: 'progressive '\n};\n\n/**\n* @class StaticResource\n* @ignore\n*/\n\nvar StaticResource = function StaticResource() {\n    _classCallCheck(this, StaticResource);\n\n    this.uRI = ''; // optional : URI to a static file, such as an image or SWF file\n    this.creativeType = ''; // mime type of static resource\n};\n\nvar vast = {};\n\nvast.Vast = Vast;\nvast.Ad = Ad;\nvast.InLine = InLine;\nvast.Impression = Impression;\nvast.Extensions = Extensions;\nvast.Creative = Creative;\nvast.Linear = Linear;\nvast.Companion = Companion;\nvast.NonLinear = NonLinear;\nvast.TrackingEvent = TrackingEvent;\nvast.VideoClicks = VideoClicks;\nvast.MediaFile = MediaFile;\nvast.StaticResource = StaticResource;\n\nexports.default = vast;\nexports.Vast = Vast;\nexports.Ad = Ad;\nexports.InLine = InLine;\nexports.Impression = Impression;\nexports.Extensions = Extensions;\nexports.Creative = Creative;\nexports.Linear = Linear;\nexports.Companion = Companion;\nexports.NonLinear = NonLinear;\nexports.TrackingEvent = TrackingEvent;\nexports.VideoClicks = VideoClicks;\nexports.MediaFile = MediaFile;\nexports.StaticResource = StaticResource;\n\n},{}]},{},[1])(1)\n});\n\n","\nimport AdsPlayer from './src/AdsPlayer';\n\n// Shove both of these into the global scope\nvar context = (typeof window !== 'undefined' && window) || global;\n\nvar adsplayer = context.adsplayer;\nif (!adsplayer) {\n    adsplayer = context.adsplayer = {};\n}\n\nadsplayer.AdsPlayer = AdsPlayer;\n\nexport default adsplayer;\nexport { AdsPlayer };\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* AdsPlayer.\n* @constructor AdsPlayer\n* @param {Object} adsPlayerContainer - the DOM container in which &lt;video&gt; and &lt;img&gt; HTML components will be appended\n*/\n\nimport AdsPlayerController from './AdsPlayerController';\nimport EventBus from './EventBus';\n\nconst NAME = 'AdsPlayer';\nconst VERSION = '';\nconst GIT_TAG = '@@REVISION';\nconst BUILD_DATE = '@@TIMESTAMP';\n\n///////////////////////////////////////////////////////////////////////////////////////////////\n////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\nfunction _onError (e) {\n    this._error = e.data;\n}\n\nfunction _onWarning (e) {\n    this._warning = e.data;\n}\n\nclass AdsPlayer {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor (adsPlayerContainer) {\n\n        this._adsPlayerContainer = adsPlayerContainer;\n        this._error = null;\n        this._warning = null;\n        this._eventBus = EventBus.getInstance();\n        this._adsPlayerController = null;\n\n        this.onErrorListener = _onError.bind(this);\n        this.onWarningListener = _onWarning.bind(this);\n    }\n\n    // Plugin API\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * Returns the plugin name.\n    * @method getName\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {string} the plugin name\n    */\n    getName () {\n        return NAME;\n    }\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * Initializes the plugin.\n    * @method init\n    * @access public\n    * @memberof AdsPlayer#\n    * @param {Object} player - the MediaPlayer\n    * @param {function} callback - the callback function to invoke when initialization is done\n    */\n    init (player, callback) {\n        this._adsPlayerController = new AdsPlayerController();\n        this._adsPlayerController.init(player, this._adsPlayerContainer);\n        this._eventBus.addEventListener('error', this.onErrorListener);\n        this._eventBus.addEventListener('warning', this.onWarningListener);\n\n        callback();\n    }\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * This method is invoked when a new stream is to be loaded/opened.\n    * @method load\n    * @access public\n    * @memberof AdsPlayer#\n    * @param {object} stream - the stream contaning all stream informations (url, protData, adsUrl)\n    */\n    load (stream, callback) {\n        if (stream.adsUrl) {\n            this._adsPlayerController.load(stream.adsUrl).then(function () {\n                callback();\n            }).catch(function () {\n                callback();\n            });\n        } else {\n            callback();\n        }\n    }\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * This method is invoked when the current stream is to be stopped.\n    * @method stop\n    * @access public\n    * @memberof AdsPlayer#\n    */\n    stop () {\n        this._adsPlayerController.stop();\n    }\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * This method is invoked when the player is to be reset.\n    * @method reset\n    * @access public\n    * @memberof AdsPlayer#\n    */\n    reset () {\n        this._adsPlayerController.reset();\n    }\n\n    /**\n    * [Plugin API, invoked by hasplayer.js]\n    * This method is invoked when this plugin is being removed/destroyed.\n    * @method destroy\n    * @access public\n    * @memberof AdsPlayer#\n    */\n    destroy () {\n        this._adsPlayerController.destroy();\n        this._eventBus.removeEventListener('error', this.onErrorListener);\n        this._eventBus.removeEventListener('warning', this.onWarningListener);\n    }\n\n    // AdsPlayer additionnal API\n\n    /**\n    * Returns the plugin version.\n    * @method getVersion\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {string} the plugin version\n    */\n    getVersion () {\n        return VERSION;\n    }\n\n    /**\n    * Returns the full plugin version, including git revision\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {string} the full plugin version, including git revision\n    */\n    getVersionFull  () {\n        if (GIT_TAG.indexOf(\"@@\") === -1) {\n            return VERSION + '_' + GIT_TAG;\n        } else {\n            return VERSION;\n        }\n    }\n\n    /**\n    * Returns the build date.\n    * @method getBuildDate\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {string} the build date\n    */\n    getBuildDate () {\n        if (BUILD_DATE.indexOf(\"@@\") === -1) {\n            return BUILD_DATE;\n        } else {\n            return 'Not a builded version';\n        }\n    }\n\n    /**\n    * Plays/resumes the playback of the current ad.\n    * @method play\n    * @access public\n    * @memberof AdsPlayer#\n    */\n    play () {\n        this._adsPlayerController.play();\n    }\n\n    /**\n    * Pauses the playback of the current ad.\n    * @method pause\n    * @access public\n    * @memberof AdsPlayer#\n    */\n    pause () {\n        this._adsPlayerController.pause();\n    }\n\n    /**\n    * Registers a listener on the specified event.\n    * The possible event types are:\n    * <li>'error' (see [error]{@link AdsPlayer#event:error} event specification)\n    * <li>'warning' (see [warning]{@link AdsPlayer#event:warning} event specification)\n    * <li>'start' (see [start]{@link AdsPlayer#event:start} event specification)\n    * <li>'end' (see [end]{@link AdsPlayer#event:end} event specification)\n    * <li>'click' (see [click]{@link AdsPlayer#event:click} event specification)\n    * @method addEventListener\n    * @access public\n    * @memberof AdsPlayer#\n    * @param {string} type - the event type for listen to\n    * @param {callback} listener - the callback which is called when an event of the specified type occurs\n    * @param {boolean} useCapture - see HTML DOM addEventListener() method specification\n    */\n    addEventListener (type, listener, useCapture) {\n        this._eventBus.addEventListener(type, listener, useCapture);\n    }\n\n    /**\n    * Unregisters the listener previously registered with the addEventListener() method.\n    * @method removeEventListener\n    * @access public\n    * @memberof AdsPlayer#\n    * @see [addEventListener]{@link AdsPlayer#addEventListener}\n    * @param {string} type - the event type on which the listener was registered\n    * @param {callback} listener - the callback which was registered to the event type\n    */\n    removeEventListener (type, listener) {\n        this._eventBus.removeEventListener(type, listener);\n    }\n\n    /**\n    * Returns the Error object for the most recent error.\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {object} the Error object for the most recent error, or null if there has not been an error\n    */\n    getError () {\n        return this._error;\n    }\n\n    /**\n    * Returns the Warning object for the most recent warning.\n    * @access public\n    * @memberof AdsPlayer#\n    * @return {object} the Warning object for the most recent warning, or null if there has not been a warning\n    */\n    getWarning () {\n        return this._warning;\n    }\n}\n\n// /**\n//  * @class\n//  * @classdesc AdsPlayer\n//  */\n// AdsPlayer.prototype = {\n//     constructor: AdsPlayer\n// };\n\n// AdsPlayer.mast = {};\n// AdsPlayer.mast.model = {};\n// AdsPlayer.mast.model.Trigger = {};\n// AdsPlayer.mast.model.Trigger.Condition = {};\n// AdsPlayer.vast = {};\n// AdsPlayer.vast.model = {};\n// AdsPlayer.vast.model.Vast = {};\n// AdsPlayer.media = {};\n// AdsPlayer.utils = {};\n\n\n\n/////////// EVENTS\n\n/**\n* The 'start' event is fired when the playback of ad(s) is starting.\n* When the 'start' event is fired, the application shall hide the main player component and\n* display the ads player container in which the ad media player component(s) will be created\n* and displayed.\n*\n* @event AdsPlayer#start\n* @param {object} event - the event\n* @param {object} event.type - the event type ('start')\n*/\n\n/**\n* The 'end' event is fired when the playback of ad(s) has ended.\n* When the 'end' event is fired, the application shall display the main player component and\n* hide the ads player container.\n*\n* @event AdsPlayer#end\n* @param {object} event - the event\n* @param {object} event.type - the event type ('end')\n*/\n\n/**\n* The 'addElement' event is fired when a DOM element for playing an ad has been created\n* and will be appended in the ads player container.\n* The element can be either a &lt;video&gt; or an &lt;img&gt; element.\n*\n* @event AdsPlayer#addElement\n* @param {object} event - the event\n* @param {object} event.type - the event type ('addElement')\n* @param {object} event.data - the event data\n* @param {string} event.data.element - the created element\n* @param {string} event.data.type - the type of the element, 'video' for &lt;video&gt; or 'image' for &lt;img&gt;\n*/\n\n/**\n* The 'removeElement' event is fired when the DOM element for playing an ad is being removed\n* from the ads player container and deleted.\n*\n* @event AdsPlayer#removeElement\n* @param {object} event - the event\n* @param {object} event.type - the event type ('removeElement')\n* @param {object} event.data - the event data\n* @param {string} event.data.element - the created element\n* @param {string} event.data.type - the type of the element, 'video' for &lt;video&gt; or 'image' for &lt;img&gt;\n*/\n\n/**\n* The 'play' event is fired when the playback of media ad is starting.\n*\n* @event AdsPlayer#play\n* @param {object} event - the event\n* @param {object} event.type - the event type ('play')\n*/\n\n/**\n* The 'pause' event is fired when the playback of an ad is paused.\n*\n* @event AdsPlayer#pause\n* @param {object} event - the event\n* @param {object} event.type - the event type ('pause')\n*/\n\n/**\n* The 'click' event is fired when a click has been performed on the ad component.\n* When the 'click' event is fired, the application shall open the web page with the provided URI.\n*\n* @event AdsPlayer#click\n* @param {object} event - the event\n* @param {object} event.type - the event type ('click')\n* @param {object} event.data - the event data\n* @param {string} event.data.uri - the web page uri\n*/\n\n/**\n* The error event is fired when an error occurs.\n* When the error event is fired, the application shall stop the player.\n*\n* @event AdsPlayer#error\n* @param {object} event - the event\n* @param {object} event.type - the event type ('error')\n* @param {object} event.data - the event data\n* @param {string} event.data.code - error code\n* @param {string} event.data.message - error message\n* @param {object} event.data.data - error additionnal data\n*/\n\n/**\n* The warning event is fired when a warning occurs.\n*\n* @event AdsPlayer#warning\n* @param {object} event - the event\n* @param {object} event.type - the event type ('warning')\n* @param {object} event.data - the event data\n* @param {string} event.data.code - warning code\n* @param {string} event.data.message - warning message\n* @param {object} event.data.data - warning additionnal data\n*/\n\nexport default AdsPlayer;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* AdsPlayerController is th main controller class for AdsPlayer module.\n* It is in charge of downloading the MAST/VAST files and orchestrates the\n* detection of triggers and playing of ad(s).\n*/\n\nimport Debug from './Debug';\nimport FileLoader from './FileLoader';\nimport ErrorHandler from './ErrorHandler';\nimport EventBus from './EventBus';\nimport MastParser from './mast/MastParser';\nimport TriggerManager from './mast/TriggerManager';\nimport VastParser from './vast/VastParser';\nimport VastPlayerManager from './vast/VastPlayerManager';\nimport utils from './utils/utils';\n\n\nclass AdsPlayerController {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _loadVast (url) {\n        var fileLoader = new FileLoader(),\n            vast = null;\n\n        return new Promise((resolve/*, reject*/) => {\n            this._debug.log(\"Download VAST file: \" + url);\n            fileLoader.load(url).then(result => {\n                    this._debug.log(\"Parse VAST file\");\n                    vast = this._vastParser.parse(result.response);\n                    vast.baseUrl = result.baseUrl;\n                    resolve(vast);\n                }).catch(error => {\n                    if (error) {\n                        this._errorHandler.sendWarning(ErrorHandler.LOAD_VAST_FAILED, \"Failed to load VAST file\", error);\n                    }\n                    resolve(null);\n                }\n            );\n            this._fileLoaders.push(fileLoader);\n        });\n    }\n\n    _loadTriggerVasts (trigger) {\n        var loadVastPromises = [],\n            i,\n            uri;\n\n        for (i = 0; i < trigger.sources.length; i++) {\n            uri = trigger.sources[i].uri;\n            // Check for relative uri path and add base url if needed\n            uri = utils.isAbsoluteURI(uri) ? uri : (this._mast.baseUrl + uri);\n            loadVastPromises.push(this._loadVast(uri));\n        }\n\n        return new Promise((resolve, reject) => {\n            Promise.all(loadVastPromises).then(vasts => {\n                // Push vast objects in the trigger in the original order\n                // (this = promises returned objects)\n                for (var i = 0; i < vasts.length; i++) {\n                    if (vasts[i] && vasts[i].ads && vasts[i].ads.length > 0) {\n                        trigger.vasts.push(vasts[i]);\n                    }\n                }\n                resolve();\n            }).catch(() => {\n                reject();\n            });\n        });\n    }\n\n    _parseMastFile (mastContent, mastBaseUrl) {\n        var triggerManager,\n            i;\n\n        // Parse the MAST file\n        this._mast = this._mastParser.parse(mastContent);\n\n        if (!this._mast) {\n            return;\n        }\n\n        // Store base URL for subsequent VATS files download\n        this._mast.baseUrl = mastBaseUrl;\n\n        // Initialize the trigger managers\n        for (i = 0; i < this._mast.triggers.length; i++) {\n            triggerManager = new TriggerManager();\n            triggerManager.init(this._mast.triggers[i]);\n            this._triggerManagers.push(triggerManager);\n        }\n    }\n\n    _onVideoPlaying () {\n        if (this._vastPlayerManager) {\n            this._debug.log(\"Pause main video\");\n            this._mainVideo.pause();\n        }\n    }\n\n    _onVideoTimeupdate () {\n        // Check for mid-roll triggers\n        var trigger = this._checkTriggersStart();\n        if (trigger !== null) {\n            this._activateTrigger(trigger, true);\n        }\n    }\n\n    _onVideoEnded () {\n        // Check for end-roll triggers\n        var trigger = this._checkTriggersStart();\n        if (trigger !== null) {\n            this._activateTrigger(trigger, true);\n        }\n\n        this._checkTriggersEnd();\n    }\n\n    _pauseVideo () {\n        if (!this._mainVideo.paused) {\n            this._debug.log(\"Pause main video\");\n            this._mainVideo.pause();\n        }\n    }\n\n    _resumeVideo () {\n        if (this._mainVideo.paused) {\n            this._debug.log(\"Resume main video\");\n            this._mainVideo.play();\n        }\n    }\n\n    _onTriggerEnd () {\n        this._debug.log('End playing trigger');\n\n        // Delete VAST player manager\n        if (this._vastPlayerManager) {\n            this._vastPlayerManager = null;\n        }\n\n        // Check if another trigger has to be activated\n        var trigger = this._checkTriggersStart();\n        if (trigger !== null) {\n            this._activateTrigger(trigger, false);\n        } else {\n            // Notifies the application ad(s) playback has ended\n            this._eventBus.dispatchEvent({type: 'end', data: null});\n\n            if (!this._mainVideo.ended) {\n                // Resume the main video element\n                this._resumeVideo();\n            }\n        }\n    }\n\n    _playTrigger (trigger) {\n        if (trigger.vasts.length === 0) {\n            return;\n        }\n\n        // Pause the main video element\n        this._pauseVideo();\n\n        // Play the trigger\n        this._debug.log('Start playing trigger ' + trigger.id);\n        this._vastPlayerManager = new VastPlayerManager();\n        this._vastPlayerManager.init(trigger.vasts, this._adsPlayerContainer, this._mainVideo);\n        this._vastPlayerManager.start();\n    }\n\n    _activateTrigger (trigger, firstTrigger) {\n\n        // Check if a trigger is not already activated\n        if (this._vastPlayerManager) {\n            return;\n        }\n\n        if (firstTrigger) {\n            // Notifies the application ad(s) playback starts\n            this._eventBus.dispatchEvent({type: 'start', data: null});\n        }\n\n        this._debug.log('Activate trigger ' + trigger.id);\n\n        trigger.activated = true;\n\n        if (trigger.vasts.length === 0) {\n            // Download VAST files\n            this._loadTriggerVasts(trigger).then(() => {\n                this._playTrigger(trigger);\n            });\n        } else {\n            this._playTrigger(trigger);\n        }\n    }\n\n    _checkTriggersStart () {\n        for (var i = 0; i < this._triggerManagers.length; i++) {\n            if (this._triggerManagers[i].checkStartConditions(this._mainVideo)) {\n                return this._triggerManagers[i].getTrigger();\n            }\n        }\n        return null;\n    }\n\n    _checkTriggersEnd () {\n        for (var i = 0; i < this._triggerManagers.length; i++) {\n            if (this._triggerManagers[i].checkEndConditions(this._mainVideo)) {\n                // Remove trigger manager => will not be activated anymore\n                this._triggerManagers.splice(0, 1);\n                i--;\n            }\n        }\n    }\n\n    _start () {\n        if (!this._mast) {\n            return;\n        }\n\n        if (this._mast.triggers.length === 0) {\n            this._debug.warn('No trigger in MAST');\n        }\n\n        // Check for pre-roll trigger\n        var trigger = this._checkTriggersStart();\n        if (trigger !== null) {\n            this._activateTrigger(trigger, true);\n        }\n\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor () {\n\n        this._mainPlayer = null;\n        this._mainVideo = null;\n        this._adsPlayerContainer = null;\n        this._mast = null;\n        this._fileLoaders = [];\n        this._triggerManagers = [];\n        this._vastPlayerManager = null;\n        this._mastParser = new MastParser();\n        this._vastParser = new VastParser();\n        this._errorHandler = ErrorHandler.getInstance();\n        this._debug = Debug.getInstance();\n        this._eventBus = EventBus.getInstance();\n\n        this._onVideoPlayingListener = this._onVideoPlaying.bind(this);\n        this._onVideoTimeupdateListener = this._onVideoTimeupdate.bind(this);\n        this._onVideoEndedListener = this._onVideoEnded.bind(this);\n        this._onTriggerEndListener = this._onTriggerEnd.bind(this);\n    }\n\n    /**\n     * Initialize the Ads Player Controller.\n     * @method init\n     * @access public\n     * @memberof AdsPlayerController#\n     * @param {Object} mainVideo - the HTML5 video element used by the main media player\n     * @param {Object} adsPlayerContainer - The container to create the HTML5 video/image elements used to play and render the ads media\n     */\n    init (player, adsPlayerContainer) {\n        this._mainPlayer = player;\n        this._mainVideo = player.getVideoModel().getElement();\n        this._adsPlayerContainer = adsPlayerContainer;\n\n        // Add <video> event listener\n        this._mainVideo.addEventListener('playing', this._onVideoPlayingListener);\n        this._mainVideo.addEventListener('timeupdate', this._onVideoTimeupdateListener);\n        this._mainVideo.addEventListener('seeking', this._onVideoTimeupdateListener);\n        this._mainVideo.addEventListener('ended', this._onVideoEndedListener);\n\n        // Add trigger end event listener\n        this._eventBus.addEventListener('triggerEnd', this._onTriggerEndListener);\n\n        this._debug.setLevel(4);\n    }\n\n\n    /**\n     * Load/open a MAST file.\n     * @method load\n     * @access public\n     * @memberof AdsPlayerController#\n     * @param {string} mastUrl - the MAST file url\n     */\n    load (url) {\n        let fileLoader = new FileLoader();\n\n        // Reset the MAST and trigger managers\n        this._mast = null;\n        this._triggerManagers = [];\n\n        // Download and parse MAST file\n        this._debug.log(\"Download MAST file: \" + url);\n\n        return new Promise((resolve, reject) => {\n            fileLoader.load(url).then(result => {\n                this._debug.log(\"Parse MAST file\");\n                this._parseMastFile(result.response, result.baseUrl);\n                // Start managing triggers and ads playing\n                this._debug.log(\"Start\");\n                this._start();\n                resolve();\n            }).catch(error => {\n                if (error) {\n                    this._errorHandler.sendError(error.name, error.message, error.data);\n                    reject(error);\n                } else {\n                    resolve();\n                }\n            });\n            this._fileLoaders.push(fileLoader);\n        });\n    }\n\n    /**\n     * Stops and resets the Ads player.\n     * @method reset\n     * @access public\n     * @memberof AdsPlayerController#\n     */\n    stop () {\n\n        this._debug.log(\"Stop\");\n\n        // Stop/abort the file loaders\n        for (var i = 0; i < this._fileLoaders.length; i++) {\n            this._fileLoaders[i].abort();\n        }\n        this._fileLoaders = [];\n\n        // Stop the VAST player manager\n        if (this._vastPlayerManager) {\n            this._vastPlayerManager.stop();\n            this._vastPlayerManager = null;\n\n            // Notifies the application ad(s) playback has ended\n            this._eventBus.dispatchEvent({type: 'end', data: null});\n        }\n    }\n\n    reset () {\n\n        this._debug.log(\"Reset\");\n\n        this.stop();\n\n        // Reset the trigger managers\n        this._triggerManagers = [];\n\n        // Reset the MAST\n        this._mast = null;\n    }\n\n    destroy () {\n\n        this._debug.log(\"Destroy\");\n\n        this.reset();\n\n        // Remove <video> event listener\n        this._mainVideo.removeEventListener('playing', this._onVideoPlayingListener);\n        this._mainVideo.removeEventListener('timeupdate', this._onVideoTimeupdateListener);\n        this._mainVideo.removeEventListener('seeking', this._onVideoTimeupdateListener);\n        this._mainVideo.removeEventListener('ended', this._onVideoEndedListener);\n\n        // Remove trigger end event listener\n        this._eventBus.removeEventListener('triggerEnd', this._onTriggerEndListener);\n    }\n\n    /**\n     * Plays/resumes the playback of the current ad.\n     * @method reset\n     * @access public\n     * @memberof AdsPlayerController#\n     */\n    play () {\n\n        this._debug.log(\"Play\");\n        // Start the VAST player manager\n        if (this._vastPlayerManager) {\n            this._vastPlayerManager.play();\n        }\n    }\n\n    /**\n     * Pauses the playback of the current ad.\n     * @method reset\n     * @access public\n     * @memberof AdsPlayerController#\n     */\n    pause () {\n\n        this._debug.log(\"Pause\");\n        // Pause the VAST player manager\n        if (this._vastPlayerManager) {\n            this._vastPlayerManager.pause();\n        }\n    }\n}\n\nexport default AdsPlayerController;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* Debug utility class.\n*/\nDate.prototype.HHMMSSmmm = function() {\n\n    var h = this.getHours().toString(),\n        m = this.getMinutes().toString(),\n        s = this.getSeconds().toString(),\n        ms = this.getMilliseconds().toString(),\n        HH = h[1] ? h : \"0\" + h[0],\n        MM = m[1] ? m : \"0\" + m[0],\n        SS = s[1] ? s : \"0\" + s[0],\n        mmm = ms[2] ? ms : \"0\" + (ms[1] ? ms : \"0\" + ms[0]);\n\n    return HH + \":\" + MM + \":\" + SS + \".\" + mmm;\n};\n\nDate.prototype.MMSSmmm = function() {\n\n    var m = this.getMinutes().toString(),\n        s = this.getSeconds().toString(),\n        ms = this.getMilliseconds().toString(),\n        MM = m[1] ? m : \"0\" + m[0],\n        SS = s[1] ? s : \"0\" + s[0],\n        mmm = ms[2] ? ms : \"0\" + (ms[1] ? ms : \"0\" + ms[0]);\n\n    return MM + \":\" + SS + \".\" + mmm;\n};\n\n// MemoryLogger definition\n\nvar MemoryLogger = function() {\n    // array to store logs\n    this.logArray = [];\n    // boolean to set leve in message\n    this.showLevel = true;\n};\n\nMemoryLogger.prototype.error =\n    MemoryLogger.prototype.warn =\n    MemoryLogger.prototype.info =\n    MemoryLogger.prototype.debug = function(message) {\n        this.logArray.push(message);\n};\n\nMemoryLogger.prototype.getLogs = function() {\n    return this.logArray;\n};\n\n\nconst NONE = 0;\nconst ERROR = 1;\nconst WARN = 2;\nconst INFO = 3;\nconst DEBUG = 4;\nconst ALL = 4;\n\n\nlet _instance = null;\n\nclass Debug {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _getStringLevel(level) {\n        switch (level) {\n            case NONE:\n                return \"\";\n            case ERROR:\n                return \"ERROR\";\n            case WARN:\n                return \"WARN\";\n            case INFO:\n                return \"INFO\";\n            case DEBUG:\n            case ALL:\n                return \"DEBUG\";\n            default:\n                return \"\";\n        }\n    }\n\n    _prepareLog(logLevel, args) {\n        let message = \"\",\n            logTime = null;\n\n        if (this._showTimestamp) {\n            logTime = new Date();\n            message += \"[\" + logTime.HHMMSSmmm() + \"]\";\n        }\n\n        if (this._logger && this._logger.showLevel) {\n            message += \"[\" + this._getStringLevel(logLevel) + \"]\";\n        }\n\n        if (this._showElapsedTime) {\n            message += \"[\" + new Date(logTime - this._startTime).MMSSmmm() + \"]\";\n        }\n\n        message += \"[AdsPlayer] \";\n\n        Array.apply(null, args).forEach(function(item) {\n            message += item + \" \";\n        });\n\n        return message;\n    }\n\n    _log (logLevel, args) {\n        if (logLevel <= this.getLevel()) {\n\n            let message = this._prepareLog(logLevel, args);\n\n            switch (logLevel) {\n                case ERROR:\n                    this._logger.error(message);\n                    break;\n                case WARN:\n                    this._logger.warn(message);\n                    break;\n                case INFO:\n                    this._logger.info(message);\n                    break;\n                case DEBUG:\n                    this._logger.debug(message);\n                    break;\n            }\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    static getInstance() {\n        if (_instance === null) {\n            _instance = new Debug();\n        }\n\n        return _instance;\n    }\n\n    constructor() {\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._level = 4;\n        this._showTimestamp = true;\n        this._showElapsedTime = false;\n        this._startTime = new Date();\n        this._logger = console;\n\n        _instance = this;\n        return _instance;\n    }\n\n    getLevel () {\n        return this._level;\n    }\n\n    setLevel (value) {\n        this._level = value;\n    }\n\n    getLogger () {\n        return this._logger;\n    }\n\n    setLogger (type) {\n        switch (type) {\n            case 'memory':\n                this._logger = new MemoryLogger();\n                break;\n\n            case 'console':\n                this._logger = console;\n                break;\n\n            default:\n                this._logger = null;\n        }\n    }\n\n    error() {\n        this._log(ERROR, arguments);\n    }\n\n    warn () {\n        this._log(WARN, arguments);\n    }\n\n    info () {\n        this._log(INFO, arguments);\n    }\n\n    // Keep this function for compatibility\n    log () {\n        this._log(DEBUG, arguments);\n    }\n}\n\nexport default Debug;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* Errors and warning notifications handler.\n*/\n\nimport Debug from './Debug';\nimport EventBus from './EventBus';\n\nlet _instance = null;\n\n\nclass ErrorHandler {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    static getInstance() {\n        if (_instance === null) {\n            _instance = new ErrorHandler();\n        }\n\n        return _instance;\n    }\n\n    constructor() {\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._eventBus = EventBus.getInstance();\n        this._debug = Debug.getInstance();\n\n        _instance = this;\n        return _instance;\n    }\n\n    /**\n     * [sendWarning description]\n     * @param  {[type]} code    [description]\n     * @param  {[type]} message [description]\n     * @param  {[type]} data    [description]\n     * @return {[type]}         [description]\n     */\n    sendWarning (code, message, data) {\n        this._eventBus.dispatchEvent({\n            type: 'warning',\n            data: {\n                code: code,\n                message: message,\n                data: data\n            }\n        });\n        this._debug.warn(\"[Warn] Code: \" + code + \", Message: \" + message + \", Data: \" + JSON.stringify(data, null, '\\t'));\n    }\n\n    /**\n     * [sendError description]\n     * @param  {[type]} code    [description]\n     * @param  {[type]} message [description]\n     * @param  {[type]} data    [description]\n     * @return {[type]}         [description]\n     */\n    sendError (code, message, data) {\n        this._eventBus.dispatchEvent({\n            type: 'error',\n            data: {\n                code: code,\n                message: message,\n                data: data\n            }\n        });\n        this._debug.error(\"[Error] Code: \" + code + \", Message: \" + message + \", Data: \" + JSON.stringify(data, null, '\\t'));\n    }\n}\n\n// File Loader errors\nErrorHandler.DOWNLOAD_ERR_FILES = \"DOWNLOAD_ERR_FILES\";\nErrorHandler.DOWNLOAD_ERR_NOT_XML = \"DOWNLOAD_ERR_NOT_XML\";\n\nErrorHandler.LOAD_VAST_FAILED = \"LOAD_VAST_FAILED\";\n\n// Media Player errors\nErrorHandler.NO_VALID_MEDIA_FOUND = \"NO_VALID_MEDIA_FOUND\";\nErrorHandler.LOAD_MEDIA_FAILED = \"LOAD_MEDIA_FAILED\";\nErrorHandler.UNSUPPORTED_MEDIA_FILE = \"UNSUPPORTED_MEDIA_FILE\";\nErrorHandler.UNAVAILABLE_LINK = \"UNAVAILABLE_LINK\";\n\nexport default ErrorHandler;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* Event bus utility class for events listening and notifying.\n*/\n\nimport Debug from './Debug';\n\nlet _instance = null;\n\nclass EventBus {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n\n    _getListeners (type, useCapture) {\n        if (useCapture === undefined) { // to provide a default parameter that works !!\n            useCapture = false;\n        }\n        var captype = (useCapture ? '1' : '0') + type;\n\n        if (!(captype in this._registrations)) {\n            this._registrations[captype] = [];\n        }\n\n        return this._registrations[captype];\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    static getInstance() {\n        if (_instance === null) {\n            _instance = new EventBus();\n        }\n\n        return _instance;\n    }\n\n    constructor() {\n\n        if (_instance !== null) {\n            return _instance;\n        }\n\n        this._registrations = {};\n        this._debug = Debug.getInstance();\n\n        _instance = this;\n        return _instance;\n    }\n\n    /**\n     * [addEventListener description]\n     * @param {[type]} type       [description]\n     * @param {[type]} listener   [description]\n     * @param {[type]} useCapture [description]\n     */\n    addEventListener (type, listener, useCapture) {\n        var listeners = this._getListeners(type, useCapture),\n            idx = listeners.indexOf(listener);\n\n        if (idx === -1) {\n            listeners.push(listener);\n        }\n    }\n\n    /**\n     * [removeEventListener description]\n     * @param  {[type]} type       [description]\n     * @param  {[type]} listener   [description]\n     * @param  {[type]} useCapture [description]\n     * @return {[type]}            [description]\n     */\n    removeEventListener (type, listener, useCapture) {\n        var listeners = this._getListeners(type, useCapture),\n            idx = listeners.indexOf(listener);\n\n        if (idx !== -1) {\n            listeners.splice(idx, 1);\n        }\n    }\n\n    /**\n     * [dispatchEvent description]\n     * @param  {[type]} evt [description]\n     * @return {[type]}     [description]\n     */\n    dispatchEvent (evt) {\n        var listeners = this._getListeners(evt.type, false).slice(),\n            i = 0;\n\n        for (i = 0; i < listeners.length; i += 1) {\n            listeners[i].call(this, evt);\n        }\n        return !evt.defaultPrevented;\n    }\n}\n\nexport default EventBus;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* File downloader utility class.\n*/\n\nimport ErrorHandler from './ErrorHandler';\n\nclass FileLoader {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _parseBaseUrl (url) {\n        var base = null;\n\n        if (url.indexOf(\"/\") !== -1) {\n            if (url.indexOf(\"?\") !== -1) {\n                url = url.substring(0, url.indexOf(\"?\"));\n            }\n            base = url.substring(0, url.lastIndexOf(\"/\") + 1);\n        }\n\n        return base;\n    }\n\n    _parseXml (data) {\n\n        if (!window.DOMParser) {\n            return null;\n        }\n\n        try {\n            let parser = new window.DOMParser();\n\n            let xmlDoc = parser.parseFromString(data, \"text/xml\");\n            if (xmlDoc.getElementsByTagName('parsererror').length > 0) {\n                throw new Error('Error parsing XML');\n            }\n            return xmlDoc;\n        } catch (e) {\n            return null;\n        }\n    }\n\n    _abort () {\n        if (this._request !== null && this._request.readyState > 0 && this._request.readyState < 4) {\n            this._request.abort();\n        }\n    }\n\n    _load (url, resolve, reject) {\n        let baseUrl = this._parseBaseUrl(url),\n            needFailureReport = true,\n            onload = null,\n            report = null,\n            onabort = null,\n            self = this;\n\n        onabort = function() {\n            this.aborted = true;\n        };\n\n        onload = function() {\n            if (this.status < 200 || this.status > 299) {\n                return;\n            }\n\n            if (this.status === 200 && this.readyState === 4) {\n\n                // Parse responseText in case of wrong response Content-Type\n                let xmlDoc = this.responseXML || self._parseXml(this.responseText);\n\n                // Check if response is in XML format.\n                if (xmlDoc === null) {\n                    needFailureReport = true;\n                    return;\n                }\n\n                // Get the redirection URL and use it as base URL\n                if (this.responseURL) {\n                    baseUrl = self._parseBaseUrl(this.responseURL);\n                }\n\n                needFailureReport = false;\n\n                // Return XML DOM (as input to parsers)\n                resolve({\n                    response: xmlDoc,\n                    baseUrl: baseUrl\n                });\n\n            }\n        };\n\n        report = function() {\n            if (!needFailureReport) {\n                return;\n            }\n            needFailureReport = false;\n\n            if (this.aborted) {\n                // Request has been aborted => reject without error\n                reject();\n            } else if (this.status < 200 || this.status > 299) {\n                // Request has failed => reject with error\n                reject({\n                    name: ErrorHandler.DOWNLOAD_ERR_FILES,\n                    message: \"Failed to download file\",\n                    data: {\n                        url: url,\n                        status: this.status\n                    }\n                });\n            } else if (this.responseXML === null) {\n                // Response was not in XML format => reject with error\n                reject({\n                    name: ErrorHandler.DOWNLOAD_ERR_NOT_XML,\n                    message: \"The downloaded file format is not in xml format\",\n                    data: {\n                        url: url\n                    }\n                });\n            }\n        };\n\n        try {\n            this._request = new XMLHttpRequest();\n            this._request.onload = onload;\n            this._request.onloadend = report;\n            this._request.onerror = report;\n            this._request.onabort = onabort;\n            this._request.open(\"GET\", url, true);\n            this._request.timeout = 10000;\n            this._request.send();\n        } catch (e) {\n            this._request.onerror();\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._request = null;\n    }\n\n    load (url) {\n        return new Promise((resolve, reject) => {\n            this._load(url, resolve, reject);\n        });\n    }\n\n    abort () {\n        if (this._request !== null &&\n            this._request.readyState > 0 &&\n            this._request.readyState < 4) {\n            this._request.abort();\n        }\n    }\n}\n\nexport default FileLoader;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* MAST parser. This class parses MAST file in XML format\n* and construct the corresponding MAST object according to MAST data model.\n*/\n\nimport mast from './model/Mast';\nimport xmldom from '../utils/xmldom';\n\nclass MastParser {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _getCondition (conditionNode) {\n        let condition = new mast.Condition(),\n            conditionNodes;\n\n        condition.type = conditionNode.getAttribute('type');\n        condition.name = conditionNode.getAttribute('name');\n        condition.value = conditionNode.getAttribute('value');\n        condition.operator = conditionNode.getAttribute('operator');\n        conditionNodes = conditionNode.getElementsByTagName('condition');\n        for (let i = 0; i < conditionNodes.length; i++) {\n            condition.conditions.push(this._getCondition(conditionNodes[i]));\n        }\n\n        return condition;\n    }\n\n    _getSource (sourceNode) {\n        let source = new mast.Source(),\n            sourceNodes;\n\n        source.uri = sourceNode.getAttribute('uri');\n        source.altReference = sourceNode.getAttribute('altReference');\n        source.format = sourceNode.getAttribute('format');\n        sourceNodes = sourceNode.getElementsByTagName('source');\n        for (let i = 0; i < sourceNodes.length; i++) {\n            source.sources.push(this._getSource(sourceNodes[i]));\n        }\n\n        return source;\n    }\n\n    _getTrigger (triggerNode) {\n        let trigger = new mast.Trigger(),\n            startConditionNodes = xmldom.getSubElements(triggerNode, 'startConditions', 'condition'),\n            endConditionNodes = xmldom.getSubElements(triggerNode, 'endConditions', 'condition'),\n            sourceNodes = xmldom.getSubElements(triggerNode, 'sources', 'source'),\n            i;\n\n        trigger.id = triggerNode.getAttribute('id');\n        trigger.description = triggerNode.getAttribute('description');\n\n        for (i = 0; i < startConditionNodes.length; i++) {\n            trigger.startConditions.push(this._getCondition(startConditionNodes[i]));\n        }\n\n        for (i = 0; i < endConditionNodes.length; i++) {\n            trigger.endConditions.push(this._getCondition(endConditionNodes[i]));\n        }\n\n        for (i = 0; i < sourceNodes.length; i++) {\n            trigger.sources.push(this._getSource(sourceNodes[i]));\n        }\n\n        return trigger;\n    }\n\n    _getTriggers (mastNode, mast) {\n        let triggerNodes = xmldom.getSubElements(mastNode, 'triggers', 'trigger');\n\n        for (let i = 0; i < triggerNodes.length; i++) {\n            mast.triggers.push(this._getTrigger(triggerNodes[i]));\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n    }\n\n    /**\n    * Parses the MAST xml file and get the triggers.\n    * @param {object} xmlDom - the XML DOM to parse\n    */\n    parse (xmlDom) {\n        let mast_ = new mast.Mast(),\n            mastNode = xmldom.getElement(xmlDom, 'MAST');\n\n        if (mastNode === null) {\n            return mast_;\n        }\n\n        this._getTriggers(mastNode, mast_);\n\n        return mast_;\n    }\n}\n\n\nexport default MastParser;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The TriggerManager manages the detection of the start and end of a trigger.\n* It takes as input a trigger object (as parsed from a MAST file) and tests the start and end conditions\n* to detect the activation and revocation of a trigger.\n*/\n\nimport { Condition } from './model/Mast';\n\nclass TriggerManager {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _parseTime (str) {\n        var timeParts,\n            SECONDS_IN_HOUR = 60 * 60,\n            SECONDS_IN_MIN = 60;\n\n        if (!str) {\n            return -1;\n        }\n\n        timeParts = str.split(':');\n\n        // Check time format, must be HH:MM:SS(.mmm)\n        if (timeParts.length !== 3) {\n            return -1;\n        }\n\n        return  (parseInt(timeParts[0]) * SECONDS_IN_HOUR) +\n                (parseInt(timeParts[1]) * SECONDS_IN_MIN) +\n                (parseFloat(timeParts[2]));\n    }\n\n    _compareValues (value1, value2, operator) {\n        var res = false;\n\n        if (value1 < 0 || value2 < 0) {\n            return false;\n        }\n\n        switch (operator) {\n            case Condition.OPERATOR.EQ:\n                res = (value1 === value2);\n                break;\n            case Condition.OPERATOR.NEQ:\n                res = (value1 !== value2);\n                break;\n            case Condition.OPERATOR.GTR:\n                res = (value1 > value2);\n                break;\n            case Condition.OPERATOR.GEQ:\n                res = (value1 >= value2);\n                break;\n            case Condition.OPERATOR.LT:\n                res = (value1 < value2);\n                break;\n            case Condition.OPERATOR.LEQ:\n                res = (value1 <= value2);\n                break;\n            case Condition.OPERATOR.MOD:\n                res = ((value1 % value2) === 0);\n                break;\n            default:\n                break;\n        }\n        return res;\n    }\n\n    _evaluateCondition (condition, video) {\n        var res = false,\n            i;\n\n        // Check pre-roll condition for activation\n        if (video.currentTime === 0 && condition.type === Condition.TYPE.EVENT && condition.name === Condition.NAME.ON_ITEM_START) {\n            res = true;\n        }\n\n        // Check mid-roll condition for activation\n        if (condition.type === Condition.TYPE.PROPERTY) {\n            switch (condition.name) {\n                case Condition.NAME.POSITION:\n                    res = this._compareValues(video.currentTime, this._parseTime(condition.value), condition.operator);\n                    break;\n                case Condition.NAME.DURATION:\n                    res = this._compareValues(video.duration, this._parseTime(condition.value), condition.operator);\n                    break;\n                default:\n                    break;\n            }\n        }\n\n        // Check condition for revocation\n        if (video.ended && condition.type === Condition.TYPE.EVENT && condition.name === Condition.NAME.ON_ITEM_END) {\n            res = true;\n        }\n\n        // AND with sub-conditions\n        // MAST spec. : \"Child conditions are treated as an implicit AND, all children of a condition must evaluate true before a trigger will fire (or be revoked) from that condition.\"\n        for (i = 0; i < condition.conditions.length; i++) {\n            res &= this._evaluateCondition(condition.conditions[i], video);\n        }\n\n        return res;\n    }\n\n    _evaluateConditions (conditions, video) {\n        var res = false,\n            i;\n\n        // Evaluate each condition\n        // MAST spec. : \"Multiple condition elements are treated as an implicit OR, any one of them evaluating true will fire the trigger.\"\n        for (i = 0; i < conditions.length; i++) {\n            res |=  this._evaluateCondition(conditions[i], video);\n        }\n\n        return res;\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._trigger = null;\n    }\n\n    /**\n     * Initializes the TriggerManager.\n     * @method init\n     * @access public\n     * @memberof TriggerManager#\n     * @param {Object} trigger - the trigger to handle by this manager\n     */\n    init (trigger) {\n        this._trigger = trigger;\n    }\n\n    /**\n     * Returns the trigger object managed by this TriggerManager.\n     * @method init\n     * @access public\n     * @memberof TriggerManager#\n     * @return {Object} the managed trigger object\n     */\n    getTrigger () {\n        return this._trigger;\n    }\n\n    /**\n     * Evaluates the trigger start conditions.\n     * @method checkStartConditions\n     * @access public\n     * @memberof TriggerManager#\n     * @param {Number} video - the main video element\n     */\n    checkStartConditions (video) {\n        if (this._trigger.activated) {\n            return false;\n        }\n        return this._evaluateConditions(this._trigger.startConditions, video);\n    }\n\n    /**\n     * Evaluates the trigger end conditions.\n     * @method checkEndConditions\n     * @access public\n     * @memberof TriggerManager#\n     * @param {Number} video - the main video element\n     */\n    checkEndConditions (video) {\n        return this._evaluateConditions(this._trigger.endConditions, video);\n    }\n}\n\nexport default TriggerManager;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* @class Mast\n* @ignore\n*/\nclass Mast {\n    constructor () {\n        this.baseUrl = '';\n        this.triggers = [];     // pointer to any number of Ad objects\n    }\n}\n\n/**\n* @class Trigger\n* @ignore\n*/\nclass Trigger {\n    constructor () {\n        this.id = '';\n        this.description = 0;\n        this.startConditions = [];      // pointer to a list of start conditions to  : AdsPlayer.mast.model.Trigger.Condition\n        this.endConditions = [];        // pointer to a list of end conditions : AdsPlayer.mast.model.Trigger.Condition\n        this.sources = [];              // pointer to a list of sources : AdsPlayer.mast.model.Trigger.Source\n        this.alreadyProcessed = false;  // mainly in the seeked case : do not replay trigger already played\n        this.vasts = [];\n        this.activated = false;\n    }\n}\n\n/**\n* @class Condition\n* @ignore\n*/\nclass Condition {\n    constructor () {\n        this.type = '';\n        this.name = '';\n        this.value = '';\n        this.operator = '';\n        this.conditions = [];\n    }\n}\n\n// ConditionType\nCondition.TYPE = {\n    EVENT: 'event',\n    PROPERTY: 'property'\n\n};\n\n// ConditionName\nCondition.NAME = {\n    ON_ITEM_START: 'OnItemStart',\n    ON_ITEM_END: 'OnItemEnd',\n    POSITION: 'Position',\n    DURATION: 'Duration'\n};\n\n// ConditionOperator\nCondition.OPERATOR = {\n    EQ:  'EQ',  // equal\n    NEQ: 'NEQ', // not equal\n    GTR: 'GTR', // greater\n    GEQ: 'GEQ', // greater or equal\n    LT:  'LT',  // lower\n    LEQ: 'LEQ', // lower or equal\n    MOD: 'MOD'  // modulo\n};\n\n/**\n* @class Source\n* @ignore\n*/\nclass Source {\n    constructor () {\n        this.uri = '';\n        this.altReference = '';\n        this.format = '';\n        this.sources = [];\n        // this.targets = [];\n    }\n}\n\n// SourceFormat\nSource.FORMAT = {\n    VAST: 'vast',\n    UIF: 'uif'\n};\n\n\nvar mast = {};\n\nmast.Mast = Mast;\nmast.Trigger = Trigger;\nmast.Condition = Condition;\nmast.Source = Source;\n\nexport default mast;\nexport { Mast, Trigger, Condition, Source };","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The ImagePlayer is a MediaPlayer implementation for playing still images.\n*/\n\nimport Debug from '../Debug';\nimport utils from '../utils/utils';\n\n\nclass ImagePlayer {\n\n    _getListeners (type) {\n        if (!(type in this._listeners)) {\n            this._listeners[type] = [];\n        }\n        return this._listeners[type];\n    }\n\n    _addEventListener (type, listener) {\n        var listeners = this._getListeners(type),\n            idx = listeners.indexOf(listener);\n\n        if (idx === -1) {\n            listeners.push(listener);\n        }\n    }\n\n    _removeEventListener (type, listener) {\n        var listeners = this._getListeners(type),\n            idx = listeners.indexOf(listener);\n\n        if (idx !== -1) {\n            listeners.splice(idx, 1);\n        }\n    }\n\n    _notifyEvent (type) {\n        var listeners = this._getListeners(type),\n            i = 0;\n\n        for (i = 0; i < listeners.length; i++) {\n            listeners[i].call(this);\n        }\n    }\n\n    _updateCurrentTime () {\n        var time = new Date().getTime();\n\n        this._currentTime += (time - this._timerTime) / 1000;\n        //this._debug.log(\"Image timeupdate, time = \" + this._currentTime);\n        this._notifyEvent('timeupdate');\n\n        if (this._currentTime >= this._duration) {\n            this._stopTimer();\n            this._ended = true;\n            this._notifyEvent('ended');\n        }\n\n        this._timerTime = time;\n    }\n\n    _startTimer () {\n        if (this._timerInterval !== null) {\n            return;\n        }\n        this._notifyEvent('play');\n        this._timerTime = new Date().getTime();\n        this._timerInterval = setInterval(this._updateCurrentTime.bind(this), 200);\n    }\n\n    _stopTimer () {\n        if (this._timerInterval === null) {\n            return;\n        }\n        this._notifyEvent('pause');\n        clearInterval(this._timerInterval);\n        this._timerInterval = null;\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n\n        this._uri = '';\n        this._image = null;\n        this._duration = 0;\n        this._currentTime = 0;\n        this._ended = false;\n        this._listeners = {};\n        this._timerInterval = null;\n        this._timerTime = -1;\n        this._events = ['play', 'pause', 'timeupdate', 'ended'];\n        this._debug = Debug.getInstance();\n    }\n\n    load (baseUrl, mediaFiles) {\n\n        var mediaFile = null,\n            type,\n            i;\n\n        // Load the first supported image format\n        // Support only jpeg, png and gif image formats\n        for (i = 0; i < mediaFiles.length; i++) {\n            type = mediaFiles[i].type;\n            if ((type === \"image/jpeg\") || (type === \"image/jpg\") || (type === \"image/png\") || (type === \"image/gif\")) {\n                mediaFile = mediaFiles[i];\n                break;\n            }\n        }\n\n        if (mediaFile === null) {\n            return false;\n        }\n\n        // Get adsplayer-image element if already declared in DOM\n        this._image = document.getElementById('adsplayer-image');\n\n        if (!this._image) {\n            // Create the image element\n            this._image = document.createElement('img');\n            this._image.autoplay = false;\n            this._image.id = 'adsplayer-image';\n        }\n\n        // Add base URL\n        this._uri = mediaFile.uri;\n        this._uri = utils.isAbsoluteURI(this._uri) ? this._uri : (baseUrl + this._uri);\n\n        this._debug.log(\"Load image media, uri = \" + this._uri);\n        this._image.src = this._uri;\n\n        // Reset current time\n        this._currentTime = 0;\n        this._ended = false;\n\n        return true;\n    }\n\n    getType () {\n        return \"image\";\n    }\n\n    getElement () {\n        return this._image;\n    }\n\n    addEventListener (type, listener) {\n        if (!this._image) {\n            return;\n        }\n        if (this._events.indexOf(type) !== -1) {\n            this._addEventListener(type, listener);\n        } else {\n            this._image.addEventListener(type, listener);\n        }\n    }\n\n    removeEventListener (type, listener) {\n        if (!this._image) {\n            return;\n        }\n        if (this._events.indexOf(type) !== -1) {\n            this._removeEventListener(type, listener);\n        } else {\n            this._image.removeEventListener(type, listener);\n        }\n    }\n\n    setDuration (duration) {\n        this._duration = duration;\n    }\n\n    getDuration () {\n        return this._duration;\n    }\n\n    getCurrentTime () {\n        return this._currentTime;\n    }\n\n    setVolume (/*volume*/) {\n        // NA\n    }\n\n    getVolume () {\n        return 0;\n    }\n\n    play () {\n        if (!this._image) {\n            return;\n        }\n        this._startTimer();\n    }\n\n    pause () {\n        if (!this._image) {\n            return;\n        }\n        this._stopTimer();\n    }\n\n    stop () {\n        if (!this._image) {\n            return;\n        }\n        this._stopTimer();\n    }\n\n    reset () {\n        if (!this._image) {\n            return;\n        }\n        this._image = null;\n        this._listeners = {};\n    }\n\n    isEnded () {\n        return this._ended;\n    }\n}\n\nexport default ImagePlayer;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The VideoPlayer is a MediaPlayer implementation for playing video files.\n*/\n\nimport Debug from '../Debug';\nimport utils from '../utils/utils';\n\n\nclass VideoPlayer {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    isMediaSupported (mimeType) {\n        if (!this._video) {\n            throw \"isMediaSupported(): element not created\";\n        }\n        if (!(this._video instanceof HTMLMediaElement)) {\n            throw \"isMediaSupported(): element must be of type HTMLMediaElement\";\n        }\n\n        var canPlay = this._video.canPlayType(mimeType);\n        return (canPlay === \"probably\" || canPlay === \"maybe\");\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._uri = '';\n        this._video = null;\n        this._debug = Debug.getInstance();\n    }\n\n    load (baseUrl, mediaFiles) {\n\n        // Get 'adsplayer-video' element if already declared in DOM\n        this._video = document.getElementById('adsplayer-video');\n\n        if (!this._video) {\n            // Create the video element\n            this._video = document.createElement('video');\n            this._video.autoplay = false;\n            this._video.id = 'adsplayer-video';\n        }\n\n        // Check if input format is supported\n        if (!this.isMediaSupported(mediaFiles[0].type)) {\n            return false;\n        }\n\n        // Sort the mediafiles in bitrate ascending order\n        mediaFiles.sort(function(a, b) {\n            if (a.bitrate && b.bitrate) {\n                return a.bitrate - b.bitrate;\n            }\n            return -1;\n        });\n\n        // Play the media file with lowest bitrate\n        this._uri = mediaFiles[0].uri;\n\n        // Add base URL\n        this._uri = utils.isAbsoluteURI(this._uri) ? this._uri : (baseUrl + this._uri);\n\n        this._debug.log(\"Load video media, uri = \" + this._uri);\n\n        this._video.addEventListener('error', function(e) {\n            console.log(e);\n        });\n\n        this._video.src = this._uri;\n\n        return true;\n    }\n\n    getType () {\n        return \"video\";\n    }\n\n    getElement () {\n        return this._video;\n    }\n\n    addEventListener (type, listener) {\n        if (!this._video) {\n            return;\n        }\n        this._video.addEventListener(type, listener);\n    }\n\n    removeEventListener (type, listener) {\n        if (!this._video) {\n            return;\n        }\n        this._video.removeEventListener(type, listener);\n    }\n\n    setDuration (/*duration*/) {\n        // duration is handled by the video element\n    }\n\n    getDuration () {\n        if (!this._video) {\n            return 0;\n        }\n        return this._video.duration;\n    }\n\n    getCurrentTime () {\n        if (!this._video) {\n            return 0;\n        }\n        return this._video.currentTime;\n    }\n\n    getVolume () {\n        if (!this._video) {\n            return 0;\n        }\n        return this._video.muted ? 0 : this._video.volume;\n    }\n\n    setVolume (volume) {\n        if (!this._video) {\n            return;\n        }\n        this._video.volume = volume;\n    }\n\n    play () {\n        if (!this._video) {\n            return;\n        }\n        this._video.play();\n    }\n\n    stop () {\n        if (!this._video) {\n            return;\n        }\n        this._video.pause();\n    }\n\n    pause () {\n        if (!this._video) {\n            return;\n        }\n        this._video.pause();\n    }\n\n    reset () {\n        if (!this._video) {\n            return;\n        }\n        this._video = null;\n    }\n\n    isEnded () {\n        return this._video.ended;\n    }\n}\n\nexport default VideoPlayer;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nvar utils = {};\n\nutils.isAbsoluteURI = function(uri) {\n    return ((uri.toLowerCase().indexOf('http://') >= 0) || (uri.toLowerCase().indexOf('https://') >= 0));\n};\n\nexport default utils;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nvar xmldom = {};\n\nxmldom.getElementsByTagName = function(node, name) {\n    var elements = node.getElementsByTagName(name);\n    if (elements.length < 1) {\n        var child = node.firstElementChild || node.firstChild;\n        if (child) {\n            var namespaceURI = child.namespaceURI;\n            elements = node.getElementsByTagNameNS(namespaceURI, name);\n        }\n    }\n    return elements;\n};\n\nxmldom.getElement = function(node, name) {\n    var elements = this.getElementsByTagName(node, name);\n    if (elements.length < 1) {\n        return null;\n    }\n    return elements[0];\n};\n\nxmldom.getElements = function(node, name) {\n    return this.getElementsByTagName(node, name);\n};\n\nxmldom.getSubElements = function(node, name, subName) {\n    var element = this.getElement(node, name);\n    if (element === null) {\n        return [];\n    }\n    return this.getElements(element, subName);\n};\n\nxmldom.getChildNode = function (node, name) {\n    if (!node || !node.childNodes) {\n        return null;\n    }\n    for (var i = 0; i < node.childNodes.length; i++) {\n        if (node.childNodes[i].nodeName === name) {\n            return node.childNodes[i];\n        }\n    }\n    return null;\n};\n\nxmldom.getNodeTextValue = function (node) {\n    var cdataSection = this.getChildNode(node, '#cdata-section'),\n        textSection = this.getChildNode(node, '#text');\n    if (cdataSection) {\n        return cdataSection.nodeValue;\n    } else if (textSection) {\n        return textSection.nodeValue;\n    }\n    return '';\n};\n\nxmldom.getChildNodeTextValue = function (node, name) {\n    var element = this.getElement(node, name);\n    if (element === null) {\n        return '';\n    }\n    return this.getNodeTextValue(element);\n};\n\n\nexport default xmldom;","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The AdPlayer manages the sequencing of playing creatives of a single Ad.\n* It takes as input the Ad object as returned by the VAST parser.\n* The AdPlayer plays sequentially all contained Creatives,\n* with the help of a CreativePlayer.\n*\n* Dispatch events:\n*  - 'adStart' when when the playback of the ad (first creative) is starting.\n*  - 'adEnd' when the playback of the (all creatives) has ended\n*/\n\nimport CreativePlayer from './CreativePlayer';\nimport Debug from '../Debug';\nimport EventBus from '../EventBus';\n\nclass AdPlayer {\n\n    _sendImpressions (impressions) {\n        let impression;\n\n        if (impressions.length === 0) {\n            return;\n        }\n\n        for (let i = 0; i < impressions.length; i++) {\n            impression = impressions[i];\n            if (impression.uri && impression.uri.length > 0) {\n                this._debug.log(\"Send Impression, uri = \" + impression.uri);\n                let http = new XMLHttpRequest();\n                http.open(\"GET\", impression.uri, true);\n                http.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n                http.send();\n            }\n        }\n    }\n\n    _onCreativeEnd () {\n\n        this._debug.log(\"Creative ended\");\n\n        // Stop the current creative media\n        this._stopCreative();\n\n        // Play next creative\n        this._playNextCreative();\n    }\n\n    _pauseCreative () {\n        if (!this._creativePlayer) {\n            return;\n        }\n        this._creativePlayer.pause();\n    }\n\n    _resumeCreative () {\n        if (!this._creativePlayer) {\n            return;\n        }\n        this._creativePlayer.play();\n    }\n\n    _stopCreative () {\n        if (!this._creativePlayer) {\n            return;\n        }\n        this._eventBus.removeEventListener('creativeEnd', this._onCreativeEndListener);\n        this._creativePlayer.stop();\n        this._creativePlayer = null;\n    }\n\n    _playCreative (index) {\n        var creative = this._ad.inLine.creatives[index],\n            linear;\n\n        this._creativeIndex = index;\n        this._debug.log(\"Play Creative - index = \" + this._creativeIndex);\n\n        // Play Linear element\n        linear = creative.linear;\n\n        if (linear) {\n            this._debug.log(\"Play Linear Ad, duration = \" + linear.duration);\n            this._eventBus.addEventListener('creativeEnd', this._onCreativeEndListener);\n            this._creativePlayer = new CreativePlayer();\n            if (!this._creativePlayer.init(creative.linear, this._adPlayerContainer, this._mainVideo, this._baseUrl)) {\n                this._playNextCreative();\n            }\n        } else {\n            this._playNextCreative();\n        }\n    }\n\n    _playNextCreative () {\n\n        this._creativeIndex++;\n\n        if (this._creativeIndex < this._ad.inLine.creatives.length) {\n            this._playCreative(this._creativeIndex);\n        } else {\n            // Notify end of Ad\n            this._eventBus.dispatchEvent({\n                type: \"adEnd\",\n                data: {}\n            });\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    /**\n     * Initializes the AdPlayer\n     * @method constructor\n     * @access public\n     * @memberof AdPlayer#\n     */\n\n    constructor () {\n        this._ad = null;\n        this._adPlayerContainer = null;\n        this._mainVideo = null;\n        this._baseUrl = '';\n        this._creativeIndex = -1;\n        this._creativePlayer = null;\n        this._debug = Debug.getInstance();\n        this._eventBus = EventBus.getInstance();\n\n        this._onCreativeEndListener = this._onCreativeEnd.bind(this);\n    }\n\n    /**\n     * Initializes the AdManager.\n     * @method init\n     * @access public\n     * @memberof VastPlayerManager#\n     * @param {Object} ad - the Ad to play\n     * @param {Array} adPlayerContainer - the HTML DOM container for ads player components\n     * @param {Object} mainVideo - the HTML5 video element used by the main media player\n     * @param {string} baseUrl - the base URL for media files\n     */\n    init (ad, adPlayerContainer, mainVideo, baseUrl) {\n        this._ad = ad;\n        this._adPlayerContainer = adPlayerContainer;\n        this._mainVideo = mainVideo;\n        this._baseUrl = baseUrl;\n    }\n\n    start () {\n        // Notify an Ad is starting to play\n        this._eventBus.dispatchEvent({\n            type: 'adStart',\n            data: {}\n        });\n\n        // Send Impressions tracking\n        this._sendImpressions(this._ad.inLine.impressions);\n\n        // Play first Creative\n        this._playCreative(0);\n    }\n\n    play () {\n        this._resumeCreative();\n    }\n\n    pause () {\n        this._pauseCreative();\n    }\n\n    stop () {\n        this._stopCreative();\n    }\n}\n\nexport default AdPlayer;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The CreativePlayer manages:\n* - the playing of media files within a Creative (with the help of a Image/VideoPlayer)\n* - the tracking events (with the help of a TrackingEventsManager)\n* - the display of the ad skipping component\n* - the user clicks\n*/\n\nimport TrackingEventsManager from './TrackingEventsManager';\nimport VideoPlayer from '../media/VideoPlayer';\nimport ImagePlayer from '../media/ImagePlayer';\nimport Debug from '../Debug';\nimport EventBus from '../EventBus';\n\nclass CreativePlayer {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _parseTime (str) {\n        var timeParts,\n            SECONDS_IN_HOUR = 60 * 60,\n            SECONDS_IN_MIN = 60;\n\n        if (!str) {\n            return -1;\n        }\n\n        timeParts = str.split(':');\n\n        // Check time format, must be HH:MM:SS(.mmm)\n        if (timeParts.length !== 3) {\n            return -1;\n        }\n\n        return  (parseInt(timeParts[0]) * SECONDS_IN_HOUR) +\n                (parseInt(timeParts[1]) * SECONDS_IN_MIN) +\n                (parseFloat(timeParts[2]));\n    }\n\n    _onMediaPlay () {\n\n        this._debug.log(\"Creative media play\");\n\n        // Notify the creative has ended\n        this._eventBus.dispatchEvent({\n            type: 'play',\n            data: {}\n        });\n    }\n\n    _onMediaPause () {\n\n        this._debug.log(\"Creative media pause\");\n\n        // Notify the creative has ended\n        this._eventBus.dispatchEvent({\n            type: 'pause',\n            data: {}\n        });\n    }\n\n    _onMediaError () {\n\n        this._debug.log(\"Creative media error\");\n\n        // Notify the creative has ended\n        this._eventBus.dispatchEvent({\n            type: 'creativeEnd',\n            data: {}\n        });\n    }\n\n    _onMediaEnded () {\n\n        this._debug.log(\"creative media ended\");\n\n        // Notify the creative has ended\n        this._eventBus.dispatchEvent({\n            type: 'creativeEnd',\n            data: {}\n        });\n    }\n\n    _onMediaTimeupdate () {\n\n        //this._debug.log(\"Media timeupdate: \" + this._mediaPlayer.getCurrentTime());\n    }\n\n    _onMainVideoVolumeChange () {\n        if (!this._mediaPlayer) {\n            return;\n        }\n        this._mediaPlayer.setVolume(this._mainVideo.muted ? 0 : this._mainVideo.volume);\n    }\n\n    _onAdClick (creative) {\n        // this = creative player\n        if (!creative.videoClicks) {\n            return;\n        }\n        this._debug.log(\"Creative Click\");\n        // ClickThrough : send an event for the application to open the web page\n        if (creative.videoClicks.clickThrough) {\n            this._debug.log(\"Ad click, uri = \" + creative.videoClicks.clickThrough);\n            this._eventBus.dispatchEvent({\n                type: 'click',\n                data: {\n                    uri: creative.videoClicks.clickThrough\n                }\n            });\n        }\n\n        // TODO\n        // ClickTracking\n        // if (this.videoClicks.clickTracking) {\n        // }\n    }\n\n    _load (creative, baseUrl) {\n        var mediaFile,\n            isVideo,\n            isImage;\n\n        if (!creative) {\n            return false;\n        }\n\n        if (creative.mediaFiles.length === 0) {\n            return false;\n        }\n\n        mediaFile = creative.mediaFiles[0];\n\n        // Video or image media ?\n        isVideo = mediaFile.type.indexOf('video') !== -1;\n        isImage = mediaFile.type.indexOf('image') !== -1;\n\n        if (isVideo) {\n            this._mediaPlayer = new VideoPlayer();\n        }\n        else if (isImage) {\n            this._mediaPlayer = new ImagePlayer();\n        } else {\n            // Unknown/unsupported media type\n            return false;\n        }\n\n        // Load the media files\n        this._debug.log(\"Creative load\");\n        if (!this._mediaPlayer.load(baseUrl, creative.mediaFiles)) {\n            this._mediaPlayer = null;\n            return false;\n        }\n\n        this._mediaPlayer.setDuration(this._parseTime(creative.duration));\n        this._mediaPlayer.addEventListener('play', this._onMediaPlayListener);\n        this._mediaPlayer.addEventListener('pause', this._onMediaPauseListener);\n        this._mediaPlayer.addEventListener('error', this._onMediaErrorListener);\n        this._mediaPlayer.addEventListener('timeupdate', this._onMediaTimeupdateListener);\n        this._mediaPlayer.addEventListener('ended', this._onMediaEndedListener);\n\n        // Add tracking events\n        if (creative.trackingEvents) {\n            this._trackingEventsManager = new TrackingEventsManager();\n            this._trackingEventsManager.init(creative.trackingEvents, this._mediaPlayer);\n            this._trackingEventsManager.start();\n        }\n\n        // Notify a creative is starting to play\n        this._eventBus.dispatchEvent({\n            type: 'creativeStart',\n            data: {}\n        });\n\n        // Notify a media element has been created and appended into document\n        this._eventBus.dispatchEvent({\n            type: 'addElement',\n            data: {\n                element: this._mediaPlayer.getElement(),\n                type: this._mediaPlayer.getType()\n            }\n        });\n\n        // Add the media player DOM element\n        this._adPlayerContainer.appendChild(this._mediaPlayer.getElement());\n\n        // Listener for click\n        if (creative.videoClicks) {\n            if (creative.videoClicks.clickThrough) {\n                this._mediaPlayer.getElement().style.cursor = 'pointer';\n            }\n            this._mediaPlayer.getElement().addEventListener('click', this._onAdClick.bind(this, creative));\n        }\n\n        // Align media volume to main video volume, add 'volumechange' listener\n        this._onMainVideoVolumeChange();\n        this._mainVideo.addEventListener('volumechange', this._onMainVideoVolumeChange.bind(this));\n\n        // Start playing the media\n        this._play();\n\n        return true;\n    }\n\n    _play () {\n\n        if (!this._mediaPlayer) {\n            return;\n        }\n\n        this._debug.log(\"Creative play\");\n\n        // Play the media player\n        this._mediaPlayer.play();\n    }\n\n    _pause () {\n\n        if (!this._mediaPlayer) {\n            return;\n        }\n\n        this._debug.log(\"Creative pause\");\n\n        // Pause the media player\n        this._mediaPlayer.pause();\n    }\n\n    _stop () {\n\n        if (!this._mediaPlayer) {\n            return;\n        }\n\n        this._debug.log(\"Creative stop\");\n\n        // Stop listening for 'volumechange' event\n        this._mainVideo.removeEventListener('volumechange', this._onMainVideoVolumeChange);\n        this._mainVideo = null;\n\n        // Stop the media player\n        this._mediaPlayer.removeEventListener('play', this._onMediaPlayListener);\n        this._mediaPlayer.removeEventListener('pause', this._onMediaPauseListener);\n        this._mediaPlayer.removeEventListener('error', this._onMediaErrorListener);\n        this._mediaPlayer.removeEventListener('timeupdate', this._onMediaTimeupdateListener);\n        this._mediaPlayer.removeEventListener('ended', this._onMediaEndedListener);\n        this._mediaPlayer.stop();\n\n        // Notify a media element has been removed from DOM\n        this._eventBus.dispatchEvent({\n            type: 'removeElement',\n            data: {\n                element: this._mediaPlayer.getElement(),\n                type: this._mediaPlayer.getType()\n            }\n        });\n\n        // Remove the element from the DOM\n        this._adPlayerContainer.removeChild(this._mediaPlayer.getElement());\n\n        // Reset the media player\n        this._mediaPlayer.reset();\n        this._mediaPlayer = null;\n\n        // Stop the TrackingEvents manager\n        if (this._trackingEventsManager) {\n            this._trackingEventsManager.stop();\n            this._trackingEventsManager = null;\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._adPlayerContainer = null;\n        this._mediaPlayer = null;\n        this._trackingEventsManager = null;\n        this._mainVideo = null;\n        this._debug = Debug.getInstance();\n        this._eventBus = EventBus.getInstance();\n\n        this._onMediaPlayListener = this._onMediaPlay.bind(this);\n        this._onMediaPauseListener = this._onMediaPause.bind(this);\n        this._onMediaErrorListener = this._onMediaError.bind(this);\n        this._onMediaTimeupdateListener = this._onMediaTimeupdate.bind(this);\n        this._onMediaEndedListener = this._onMediaEnded.bind(this);\n    }\n\n    /**\n     * Initializes the creative player.\n     * @method init\n     * @access public\n     * @memberof CreativePlayer#\n     * @param {Object} creative - the creative element to play\n     * @param {Object} adPlayerContainer - the HTML DOM container for ads player components\n     * @param {Object} mainVideo - the HTML5 video element used by the main media player\n     * @param {string} baseUrl - the base URL for media files\n     */\n    init (creative, adPlayerContainer, mainVideo, baseUrl) {\n        this._adPlayerContainer = adPlayerContainer;\n        this._mainVideo = mainVideo;\n        return this._load(creative, baseUrl);\n    }\n\n    play () {\n        this._play();\n    }\n\n    pause () {\n        this._pause();\n    }\n\n    stop () {\n        this._stop();\n    }\n}\n\nexport default CreativePlayer;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The TrackingEventsManager manages the sending of the tracking events while a creative's media is playing.\n* It takes as input the list of tracking events to send.\n*/\n\nimport Debug from '../Debug';\n\nclass TrackingEventsManager {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _postEvent (uri) {\n        let xhr = new XMLHttpRequest();\n        xhr.open('GET', uri, true);\n        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n        xhr.send();\n    }\n\n    _addEventListener (element, eventType, trackingEvent) {\n\n        let self = this,\n            _listener = function(/*event*/) {\n                if (this.completed === true) {\n                    return;\n                }\n                if (this.uri === undefined || this.uri.length === 0) {\n                    return;\n                }\n                if (this.condition && !this.condition()) {\n                    return;\n                }\n                self._debug.log(\"Send tracking event \" + this.event + \", uri = \" + this.uri);\n                self._postEvent(this.uri);\n                if (this.oneShot === true) {\n                    this.completed = true;\n                }\n            },\n            _eventListener = {\n                type: eventType,\n                element: element,\n                listener: _listener.bind(trackingEvent)\n            };\n\n        element.addEventListener(eventType, _eventListener.listener);\n        this._eventListeners.push(_eventListener);\n    }\n\n    _addPlayerEventListeners () {\n\n        for (let i = 0; i < this._trackingEvents.length; i++) {\n            let trackingEvent = this._trackingEvents[i];\n            if (trackingEvent.uri && trackingEvent.uri.length > 0) {\n                switch (trackingEvent.event) {\n                    case 'creativeView':\n                        trackingEvent.oneShot = true;\n                        this._addEventListener(this._adMediaPlayer, 'loadeddata', trackingEvent);\n                        break;\n                    case 'start':\n                        trackingEvent.oneShot = true;\n                        this._addEventListener(this._adMediaPlayer, 'playing', trackingEvent);\n                        break;\n                    case 'pause':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = () => {\n                            // To ignore pause event that may be raised at end of stream\n                            return (this._adMediaPlayer.isEnded() === false );\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'pause', trackingEvent);\n                        break;\n                    case 'resume':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = () => {\n                            return (this._adMediaPlayer.getCurrentTime() > 0);\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'play', trackingEvent);\n                        break;\n                    case 'firstQuartile':\n                        trackingEvent.oneShot = true;\n                        trackingEvent.condition = () => {\n                            //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                            return ((this._adMediaPlayer.getCurrentTime() / this._adMediaPlayer.getDuration()) >= 0.25);\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                        break;\n                    case 'midpoint':\n                        trackingEvent.oneShot = true;\n                        trackingEvent.condition = () => {\n                            //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                            return ((this._adMediaPlayer.getCurrentTime() / this._adMediaPlayer.getDuration()) >= 0.50);\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                        break;\n                    case 'thirdQuartile':\n                        trackingEvent.oneShot = true;\n                        trackingEvent.condition = () => {\n                            //_debug.log(\"Progress: \" + (this._adMediaPlayer.getCurrentTime() / _adMediaPlayer.getDuration()));\n                            return ((this._adMediaPlayer.getCurrentTime() / this._adMediaPlayer.getDuration()) >= 0.75);\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                        break;\n                    case 'rewind':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = () => {\n                            let res = ((this._adMediaPlayer.getCurrentTime() < this._currentTime) && (this._adMediaPlayer.isEnded() === false));\n                            this._currentTime = this._adMediaPlayer.getCurrentTime();\n                            return res;\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                        break;\n                    case 'complete':\n                        this._addEventListener(this._adMediaPlayer, 'ended', trackingEvent);\n                        break;\n                    case 'mute':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = () => {\n                            let res = !this._mute && (this._adMediaPlayer.getVolume() === 0);\n                            this._mute = (this._adMediaPlayer.getVolume() === 0);\n                            return res;\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'volumechange', trackingEvent);\n                        break;\n                    case 'unmute':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = () => {\n                            let res = !this._unmute && (this._adMediaPlayer.getVolume() > 0);\n                            this._unmute = (this._adMediaPlayer.getVolume() > 0);\n                            return res;\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'volumechange', trackingEvent);\n                        break;\n                    case 'fullscreen':\n                    case 'exitFullscreen':\n                        trackingEvent.oneShot = false;\n                        trackingEvent.condition = (event = trackingEvent.event) => {\n                            let state = (event === 'fullscreen');\n                            return (document.fullScreen === state || document.mozFullScreen === state || document.webkitIsFullScreen === state);\n                        };\n                        this._addEventListener(document, 'webkitfullscreenchange', trackingEvent);\n                        this._addEventListener(document, 'mozfullscreenchange', trackingEvent);\n                        this._addEventListener(document, 'MSFullscreenChange', trackingEvent);\n                        this._addEventListener(document, 'fullscreenChange', trackingEvent);\n                        break;\n                    case 'progress':\n                        trackingEvent.oneShot = true;\n                        trackingEvent.condition = () => {\n                            if (trackingEvent.offsetPercent) {\n                                //this._debug.log(\"progress:\" + this._adMediaPlayer.getCurrentTime()+\" vs offsetPercent = \" + trackingEvent.offsetPercent * this._adMediaPlayer.getDuration());\n                                return (this._adMediaPlayer.getCurrentTime() >= trackingEvent.offsetPercent * this._adMediaPlayer.getDuration());\n                            } else {\n                                //this._debug.log(\"progress:\" + this._adMediaPlayer.getCurrentTime()+\" vs offsetInSeconds \" + trackingEvent.offsetInSeconds);\n                                return (this._adMediaPlayer.getCurrentTime() >= trackingEvent.offsetInSeconds);\n                            }\n                        };\n                        this._addEventListener(this._adMediaPlayer, 'timeupdate', trackingEvent);\n                        break;\n                    case 'acceptInvitationLinear':\n                        trackingEvent.oneShot = false;\n                        this._addEventListener(this._adMediaPlayer, 'click', trackingEvent);\n                        break;\n                    case 'closeLinear':\n                        trackingEvent.oneShot = false;\n                        this._addEventListener(window, 'beforeunload', trackingEvent);\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n    }\n\n    _removePlayerEventListeners () {\n        for (let i = 0; i < this._eventListeners.length; i++) {\n            this._eventListeners[i].element.removeEventListener(this._eventListeners[i].type, this._eventListeners[i].listener);\n        }\n        this._eventListeners = [];\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n        this._trackingEvents = null;\n        this._adMediaPlayer = null;\n        this._currentTime = -1;\n        this._mute = -1;\n        this._unmute = -1;\n        this._debug = Debug.getInstance();\n        this._eventListeners = [];\n    }\n\n    /**\n     * Initializes the TrackingEventsManager.\n     * @method init\n     * @access public\n     * @memberof TrackingEventsManager#\n     * @param {Array} trackingEvents - the array of tracking events to manage\n     * @param {Object} adMediaPlayer - the ad media player\n     */\n    init (trackingEvents, adMediaPlayer) {\n        this._trackingEvents = trackingEvents;\n        this._adMediaPlayer = adMediaPlayer;\n        this._mute = (this._adMediaPlayer.getVolume() === 0);\n        this._unmute = (this._adMediaPlayer.getVolume() > 0);\n    }\n\n    start () {\n        if (this._trackingEvents.length === 0) {\n            return;\n        }\n        this._addPlayerEventListeners();\n    }\n\n    stop () {\n        this._removePlayerEventListeners();\n    }\n}\n\nexport default TrackingEventsManager;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* VAST parser. This class parses VAST file in XML format\n* and construct the corresponding VAST object according to VAST data model.\n*/\n\nimport vast from './model/Vast';\nimport xmldom from '../utils/xmldom';\n\nclass VastParser {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _getTrackingEvent (trackingNode) {\n        let trackingEvent = new vast.TrackingEvent();\n\n        trackingEvent.event = trackingNode.getAttribute('event');\n        trackingEvent.uri = xmldom.getNodeTextValue(trackingNode);\n        if (trackingEvent.event == \"progress\") {\n            var offsetValue = trackingNode.getAttribute('offset');\n            if (offsetValue.indexOf(\"%\") == -1) {\n                /* convert HH:MM:SS ( or HH:MM:SS.mmm) in seconds */\n                trackingEvent.offsetInSeconds = new Date('1970-01-01T' + offsetValue + 'Z').getTime() / 1000;\n            }\n            else {\n                trackingEvent.offsetPercent = offsetValue.substring(0, offsetValue.indexOf(\"%\")) / 100;\n            }\n        }\n        return trackingEvent;\n    }\n\n    _getVideoClicks (videoClicksNode) {\n        let videoClicks = new vast.VideoClicks(),\n            nodeName,\n            nodeValue;\n\n        for (let i = 0; i < videoClicksNode.childNodes.length; i++) {\n            nodeName = videoClicksNode.childNodes[i].nodeName;\n            nodeValue = xmldom.getNodeTextValue(videoClicksNode.childNodes[i]);\n\n            switch (nodeName) {\n                case \"ClickThrough\":\n                    videoClicks.clickThrough = nodeValue;\n                    break;\n                case \"ClickTracking\":\n                    videoClicks.clickTracking = nodeValue;\n                    break;\n                case \"CustomClick\":\n                    videoClicks.customClick = nodeValue;\n                    break;\n            }\n        }\n\n        return videoClicks;\n    }\n\n    _getMediaFile (mediaFileNode) {\n        let mediaFile = new vast.MediaFile();\n\n        mediaFile.id = mediaFileNode.getAttribute('id');\n        mediaFile.delivery = mediaFileNode.getAttribute('delivery');\n        mediaFile.type = mediaFileNode.getAttribute('type');\n        mediaFile.bitrate = mediaFileNode.getAttribute('bitrate');\n        mediaFile.width = mediaFileNode.getAttribute('width');\n        mediaFile.height = mediaFileNode.getAttribute('height');\n        mediaFile.scalable = mediaFileNode.getAttribute('scalable');\n        mediaFile.maintainAspectRatio = mediaFileNode.getAttribute('maintainAspectRatio');\n        mediaFile.apiFramework = mediaFileNode.getAttribute('apiFramework');\n        mediaFile.uri = xmldom.getNodeTextValue(mediaFileNode);\n\n        return mediaFile;\n    }\n\n    _getLinear (linearNode) {\n        let linear = new vast.Linear(),\n            trackingNodes,\n            videoClicksNode,\n            mediaFileNodes,\n            i;\n\n        linear.duration = xmldom.getChildNodeTextValue(linearNode, 'Duration');\n        linear.adParameters = xmldom.getChildNodeTextValue(linearNode, 'AdParameters');\n\n        trackingNodes = xmldom.getSubElements(linearNode, 'TrackingEvents', 'Tracking');\n        for (i = 0; i < trackingNodes.length; i++) {\n            linear.trackingEvents.push(this._getTrackingEvent(trackingNodes[i]));\n        }\n\n        videoClicksNode = xmldom.getElement(linearNode, 'VideoClicks');\n        if (videoClicksNode) {\n            linear.videoClicks = this._getVideoClicks(videoClicksNode);\n        }\n\n        mediaFileNodes = xmldom.getSubElements(linearNode, 'MediaFiles', 'MediaFile');\n        for (i = 0; i < mediaFileNodes.length; i++) {\n            linear.mediaFiles.push(this._getMediaFile(mediaFileNodes[i]));\n        }\n\n        return linear;\n    }\n\n    _getCreative (creativeNode) {\n        let creative = new vast.Creative(),\n            linearNode;\n\n        creative.id = creativeNode.getAttribute('id');\n        creative.adId = creativeNode.getAttribute('AdID');\n        creative.sequence = creativeNode.getAttribute('sequence');\n\n        linearNode = xmldom.getElement(creativeNode, 'Linear');\n        if (linearNode) {\n            creative.linear = this._getLinear(linearNode);\n        }\n\n        // TODO: get Companion and non-Linear elements\n\n        return creative;\n    }\n\n    _getInLine (adNode) {\n        let inLine = new vast.InLine(),\n            inLineNode = xmldom.getElement(adNode, 'InLine'),\n            impressionNodes,\n            creativeNodes,\n            i;\n\n        if (inLineNode === null) {\n            return null;\n        }\n\n        inLine.adSystem = xmldom.getChildNodeTextValue(inLineNode, 'AdSystem');\n        inLine.adTitle = xmldom.getChildNodeTextValue(inLineNode, 'AdTitle');\n        inLine.description = xmldom.getChildNodeTextValue(inLineNode, 'Description');\n        inLine.survey = xmldom.getChildNodeTextValue(inLineNode, 'Survey');\n        inLine.error = xmldom.getChildNodeTextValue(inLineNode, 'Error');\n\n        impressionNodes = xmldom.getElements(inLineNode, 'Impression');\n        for (i = 0; i < impressionNodes.length; i++) {\n            var impression = new vast.Impression();\n            impression.id = impressionNodes[i].getAttribute('id');\n            impression.uri = xmldom.getNodeTextValue(impressionNodes[i]);\n            inLine.impressions.push(impression);\n\n        }\n\n        creativeNodes = xmldom.getSubElements(inLineNode, 'Creatives', 'Creative');\n        for (i = 0; i < creativeNodes.length; i++) {\n            inLine.creatives.push(this._getCreative(creativeNodes[i]));\n        }\n\n        return inLine;\n    }\n\n    _getAd (adNode) {\n        let ad = new vast.Ad();\n        ad.id = adNode.getAttribute('id');\n        ad.sequence = adNode.getAttribute('sequence');\n        ad.inLine = this._getInLine(adNode);\n        return ad;\n    }\n\n    _getAds (vastNode, vast_) {\n        let adNodes = xmldom.getElements(vastNode, 'Ad');\n        for (let i = 0; i < adNodes.length; i++) {\n            vast_.ads.push(this._getAd(adNodes[i]));\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor() {\n    }\n\n    /**\n    * Parses the VAST XML DOM and get the triggers.\n    * @param {object} xmlDom - the XML DOM to parse\n    */\n    parse (xmlDom) {\n        let vast_ = new vast.Vast(),\n            vastNode = xmldom.getElement(xmlDom, 'VAST');\n\n        if (vastNode === null) {\n            return vast_;\n        }\n\n        vast_.version = vastNode.getAttribute('version');\n\n        this._getAds(vastNode, vast_);\n\n        return vast_;\n    }\n}\n\nexport default VastParser;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* The VastPlayerManager manages the sequencing of playing ads of a single VAST.\n* It takes as input the list of Vast objects as returned by the VAST parser.\n* For each Vast, the VastPlayerManager plays sequentially all contained Ads,\n* with the help of an AdPlayer.\n*/\n\n\nimport AdPlayer from './AdPlayer';\nimport Debug from '../Debug';\nimport EventBus from '../EventBus';\n\nclass VastPlayerManager {\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PRIVATE ////////////////////////////////////////////\n\n    _onAdEnd () {\n\n        this._debug.log(\"Ad ended\");\n\n        // Stop the current Ad\n        this._stopAd();\n\n        // Play next Ad\n        this._playNextAd();\n    }\n\n    _pauseAd () {\n        if (!this._adPlayer) {\n            return;\n        }\n        this._adPlayer.pause();\n    }\n\n    _resumeAd () {\n        if (!this._adPlayer) {\n            return;\n        }\n        this._adPlayer.play();\n    }\n\n    _stopAd () {\n        if (!this._adPlayer) {\n            return;\n        }\n        this._eventBus.removeEventListener('adEnd', this._onAdEndListener);\n        this._adPlayer.stop();\n        this._adPlayer = null;\n    }\n\n    _playAd (index) {\n        let vast = this._vasts[this._vastIndex],\n            ad = vast.ads[index];\n\n        this._adIndex = index;\n        this._debug.log(\"Play Ad - index = \" + this._adIndex);\n\n        this._eventBus.addEventListener('adEnd', this._onAdEndListener);\n        this._adPlayer = new AdPlayer();\n        this._adPlayer.init(ad, this._adPlayerContainer, this._mainVideo, vast.baseUrl);\n        this._adPlayer.start();\n    }\n\n    _playNextAd () {\n        let vast = this._vasts[this._vastIndex];\n\n        this._adIndex++;\n\n        if (this._adIndex < vast.ads.length) {\n            this._playAd(this._adIndex);\n        } else {\n            this._playNextVast();\n        }\n    }\n\n    _playVast (index) {\n        let vast = this._vasts[index];\n\n        if (vast.ads.length === 0) {\n            // Empty VAST\n            return;\n        }\n\n        this._vastIndex = index;\n        this._debug.log(\"Play Vast - index = \" + this._vastIndex);\n\n        // Play first Ad\n        this._playAd(0);\n    }\n\n    _playNextVast () {\n\n        this._vastIndex++;\n\n        if (this._vastIndex < this._vasts.length) {\n            this._playVast(this._vastIndex);\n        } else {\n            // Notify end of trigger\n            this._eventBus.dispatchEvent({\n                type: 'triggerEnd',\n                data: {}\n            });\n        }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////\n    ////////////////////////////////////////// PUBLIC /////////////////////////////////////////////\n\n    constructor () {\n        this._vasts = [];\n        this._adPlayerContainer = null;\n        this._adIndex = -1;\n        this._adPlayer = null;\n        this._debug = Debug.getInstance();\n        this._eventBus = EventBus.getInstance();\n        this._onAdEndListener = this._onAdEnd.bind(this);\n    }\n\n    /**\n     * Initializes the VastPlayerManager.\n     * @method init\n     * @access public\n     * @memberof VastPlayerManager#\n     * @param {Array} vasts - the array of Vast components to play\n     * @param {Array} adPlayerContainer - the HTML DOM container for ads player components\n     */\n    init (vasts, adPlayerContainer, mainVideo) {\n        this._vasts = vasts;\n        this._adPlayerContainer = adPlayerContainer;\n        this._mainVideo = mainVideo;\n    }\n\n    start () {\n        if (!this._vasts || this._vasts.length === 0) {\n            return;\n        }\n\n        // Notify a trigger is starting to play\n        this._eventBus.dispatchEvent({\n            type: 'triggerStart',\n            data: {}\n        });\n\n        this._playVast(0);\n    }\n\n    play () {\n        this._resumeAd();\n    }\n\n    pause () {\n        this._pauseAd();\n    }\n\n    stop () {\n        this._stopAd();\n    }\n}\n\nexport default VastPlayerManager;\n","/*\n* The copyright in this software module is being made available under the BSD License, included\n* below. This software module may be subject to other third party and/or contributor rights,\n* including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2016, Orange\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification, are permitted\n* provided that the following conditions are met:\n* - Redistributions of source code must retain the above copyright notice, this list of conditions\n*   and the following disclaimer.\n* - Redistributions in binary form must reproduce the above copyright notice, this list of\n*   conditions and the following disclaimer in the documentation and/or other materials provided\n*   with the distribution.\n* - Neither the name of Orange nor the names of its contributors may be used to endorse or promote\n*   products derived from this software module without specific prior written permission.\n*\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND ANY EXPRESS OR\n* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n* FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER O\n* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY\n* WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/**\n* @class Vast\n* @ignore\n*/\nclass Vast {\n    constructor () {\n        this.version = '';\n        this.ads = [];\n    }\n}\n\n/**\n* @class Ad\n* @ignore\n*/\nclass Ad {\n    constructor () {\n        this.id = '';                       // [Optional] an ad server-defined string for the ad\n        this.sequence = 0;                  // [Optional] the sequence in which an ad should play\n        this.inLine = null;\n        this.wrapper = null;\n    }\n}\n\n/**\n* @class InLine\n* @ignore\n*/\nclass InLine {\n    constructor () {\n        this.adSystem = '';                 // [Required] Source ad server\n        this.adTitle = '';                  // [Required] Title\n        this.description = '';              // [Optional] Description\n        this.survey = '';                   // [Optional] URI of request to survey vendor\n        this.error = '';                    // [Optional] URI to request if ad does not play due to error\n        this.impressions = [];              // [Required] URIs to track impressions.\n        this.creatives = [];                // [Required] Creative elements\n        this.extensions = [];               // [Optional] Any valid XML may be included in the Extensions node\n    }\n}\n\n/**\n* @class Impression\n* @ignore\n*/\nclass Impression {\n    constructor () {\n        this.uri = '';                      // [Required] URI to track Impression\n        this.id = '';                       // [Optional] Identifier\n    }\n}\n\n/**\n* @class Extensions\n* @ignore\n*/\nclass Extensions {\n    constructor () {\n        this.uri = '';                      //\n        this.other = '';                    //\n    }\n}\n\n/**\n* @class Creative\n* @ignore\n*/\nclass Creative {\n    constructor () {\n        this.id = '';                       // [Optional] Identifier\n        this.adId = '';                     // [Optional] Ad-ID for the creative (formerly ISCI)\n        this.sequence = 0;                  // [Optional] The preferred order in which multiple Creatives should be displayed\n        this.linear = null;                 // [Optional] Linear ad\n        this.CompanionAds = [];             // [Optional] Companion ads\n        this.nonLinearAds = [];             // [Optional] Non-linear ads\n    }\n}\n\n// Creative types\nCreative.TYPE = {\n    LINEAR: 'linear',\n    NON_LINEAR_ADS: 'NonLinearAds',\n    COMPANION_ADS : 'CompanionAds'\n};\n\n/**\n* @class Linear\n* @ignore\n*/\nclass Linear {\n    constructor () {\n        this.duration = 0;                  // [Required] Duration in standard time format, hh:mm:ss\n        this.trackingEvents = [];           // [Optional] Tracking events elements\n        this.adParameters = '';             // [Optional] Data to be passed into the video ad\n        this.videoClicks = null;            // [Optional] Video clicks\n        this.mediaFiles = [];               // [Required] Media file elements\n    }\n}\n\n/**\n* @class Companion\n* @ignore\n*/\nclass Companion {\n    constructor () {\n        this.id = '';                       // optional : identifier\n        this.width = 0;                     // width pixel dimension of companion\n        this.height = 0;                    // height pixel dimension of companion\n        this.staticResource = null;         // optional : pointer to the static resource : AdsPlayer.vast.model.Ad.StaticResource\n        this.iFrameResource = '';           // optional : URI source for an IFrame to display the companion element\n        this.hTMLResource = '';             // optional : HTML to display the companion element : shall be CDATA value\n        this.trackingEvents = [];           // optional : pointer to any number of tracking objects : AdsPlayer.vast.model.Ad.CompanionTracking\n        this.clickThrough = '';             // optional : URI to open as destination page when user clicks on the companion\n        this.altText = '';                  // optional : alt text to be displayed when companion is rendered in HTML environment.\n        this.adParameters = '';             // optional : data to be passed into the companion ads\n    }\n}\n\n//\n//      Non Linear Ads\n//\n\n/**\n* @class Companion\n* @ignore\n*/\nclass NonLinear {\n    constructor () {\n        this.id = '';                       // optional : identifier\n        this.width = 0;                     // width pixel dimension of non linear\n        this.height = 0;                    // height pixel dimension of non linear\n        this.expandedWidth = 0;             // optional : pixel dimensions of expanding nonlinear ad when in expanded state\n        this.expandedHeight  = 0;           // optional : pixel dimensions of expanding nonlinear ad when in expanded state\n        this.scalable = true;               // optional : whether it is acceptable to scale the image\n        this.maintainAspectRatio = true;    // optional : whether the ad must have its aspect ratio maintained when scaled\n        this.apiFramework = '';             // optional : defines the method to use for communication with the nonlinear element\n        this.staticResource = null;         // optional : pointer to the static resource : AdsPlayer.vast.model.Ad.StaticResource\n        this.hTMLResource = '';             // optional : HTML to display the companion element : shall be CDATA value\n        this.trackingEvents = [];           // optional : pointer to any number of tracking objects : AdsPlayer.vast.model.Ad.Tracking\n        this.clickThrough = '';             // optional : URI to open as destination page when user clicks on the non-linear ad unit\n        this.adParameters = '';             // optional : data to be passed into the video ad\n    }\n}\n\n/**\n* @class TrackingEvent\n* @ignore\n*/\nclass TrackingEvent {\n    constructor () {\n        this.uri = '';                      // [Optional] URI to track various events during playback\n        this.event = '';                    // [Required] The name of the event to track for the Linear element\n        this.offsetInSeconds = '';          // [Optional] Required in \"Progess\" event, not use with other events\n        this.offsetPercent = '';            // [Optional] Required in \"Progess\" event, not use with other events\n    }\n}\n\n\n/**\n* [TrackingEvent description]\n* @type {Object}\n*/\nTrackingEvent.TYPE = {\n    CREATIVEVIEW:'creativeView',\n    START:'start',\n    MIDPOINT: 'midpoint',\n    FIRSTQUARTILE: 'firstQuartile',\n    THIRDQUARTILE: 'thirdQuartile',\n    COMPLETE: 'complete',\n    MUTE: 'mute',\n    UNMUTE: 'unmute',\n    PAUSE: 'pause',\n    REWIND: 'rewind',\n    RESUME: 'resume',\n    FULLSCREEN: 'fullscreen',\n    EXPAND: 'expand',\n    COLLAPSE: 'collapse',\n    ACCEPTINVITATION: 'acceptInvitation',\n    CLOSE: 'close'\n};\n\n/**\n* @class VideoClicks\n* @ignore\n*/\nclass VideoClicks {\n    constructor () {\n        this.clickThrough = '';             // [Optional] URI to open as destination page when user clicks on the video\n        this.clickTracking = '';            // [Optional] URI to request for tracking purposes when user clicks on the video\n        this.customClick = '';              // [Optional] URI to request on custom events such as hotspotted video\n    }\n}\n\n/**\n* @class MediaFile\n* @ignore\n*/\nclass MediaFile {\n    constructor () {\n        this.id = '';                       // [Optional] Identifier\n        this.delivery = '';                 // [Required] Method of delivery of ad ('streaming' or 'progressive')\n        this.type = '';                     // [Required] MIME type\n        this.bitrate = 0;                   // [Optional] Bitrate of encoded video in Kbps\n        this.width = 0;                     // [Required] Pixel dimensions of video\n        this.height = 0;                    // [Required] Pixel dimensions of video\n        this.scalable = true;               // [Optional] Whether it is acceptable to scale the image.\n        this.maintainAspectRatio = true;    // [Optional] Whether the ad must have its aspect ratio maintained when scaled\n        this.apiFramework = '';             // [Optional] Defines the method to use for communication if the MediaFile is interactive.\n        this.uri = '';\n    }\n}\n\n// MediaFile delivery types\nMediaFile.DELIVERY = {\n    STREAMING: 'streaming',\n    PROGRESSIVE: 'progressive '\n};\n\n/**\n* @class StaticResource\n* @ignore\n*/\nclass StaticResource {\n    constructor () {\n        this.uRI = '';              // optional : URI to a static file, such as an image or SWF file\n        this.creativeType  ='';     // mime type of static resource\n    }\n}\n\n\nvar vast = {};\n\nvast.Vast = Vast;\nvast.Ad = Ad;\nvast.InLine = InLine;\nvast.Impression = Impression;\nvast.Extensions = Extensions;\nvast.Creative = Creative;\nvast.Linear = Linear;\nvast.Companion = Companion;\nvast.NonLinear = NonLinear;\nvast.TrackingEvent = TrackingEvent;\nvast.VideoClicks = VideoClicks;\nvast.MediaFile = MediaFile;\nvast.StaticResource = StaticResource;\n\nexport default vast;\n\nexport { Vast, Ad, InLine, Impression, Extensions, Creative, Linear, Companion, NonLinear, TrackingEvent, VideoClicks, MediaFile, StaticResource };\n"]}